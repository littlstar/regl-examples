var $jscomp={scope:{},getGlobal:function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global?global:b}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.initSymbol=function(){$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol);$jscomp.initSymbol=function(){}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(b){return"jscomp_symbol_"+b+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();if(b[$jscomp.global.Symbol.iterator])return b[$jscomp.global.Symbol.iterator]();var d=0;return{next:function(){return d==b.length?{done:!0}:{done:!1,value:b[d++]}}}};
$jscomp.arrayFromIterator=function(b){for(var d,f=[];!(d=b.next()).done;)f.push(d.value);return f};$jscomp.arrayFromIterable=function(b){return b instanceof Array?b:$jscomp.arrayFromIterator($jscomp.makeIterator(b))};
$jscomp.inherits=function(b,d){function f(){}f.prototype=d.prototype;b.prototype=new f;b.prototype.constructor=b;for(var a in d)if($jscomp.global.Object.defineProperties){var c=$jscomp.global.Object.getOwnPropertyDescriptor(d,a);c&&$jscomp.global.Object.defineProperty(b,a,c)}else b[a]=d[a]};$jscomp.array=$jscomp.array||{};$jscomp.array.done_=function(){return{done:!0,value:void 0}};
$jscomp.array.arrayIterator_=function(b,d){b instanceof String&&(b=String(b));var f=0;$jscomp.initSymbol();$jscomp.initSymbolIterator();var a={},c=(a.next=function(){if(f<b.length){var a=f++;return{value:d(a,b[a]),done:!1}}c.next=$jscomp.array.done_;return $jscomp.array.done_()},a[Symbol.iterator]=function(){return c},a);return c};
$jscomp.array.findInternal_=function(b,d,f){b instanceof String&&(b=String(b));for(var a=b.length,c=0;c<a;c++){var h=b[c];if(d.call(f,h,c,b))return{i:c,v:h}}return{i:-1,v:void 0}};
$jscomp.array.from=function(b,d,f){d=void 0===d?function(a){return a}:d;var a=[];$jscomp.initSymbol();$jscomp.initSymbolIterator();if(b[Symbol.iterator]){$jscomp.initSymbol();$jscomp.initSymbolIterator();b=b[Symbol.iterator]();for(var c;!(c=b.next()).done;)a.push(d.call(f,c.value))}else{c=b.length;for(var h=0;h<c;h++)a.push(d.call(f,b[h]))}return a};$jscomp.array.of=function(b){for(var d=[],f=0;f<arguments.length;++f)d[f-0]=arguments[f];return $jscomp.array.from(d)};
$jscomp.array.entries=function(){return $jscomp.array.arrayIterator_(this,function(b,d){return[b,d]})};$jscomp.array.entries$install=function(){Array.prototype.entries||(Array.prototype.entries=$jscomp.array.entries)};$jscomp.array.keys=function(){return $jscomp.array.arrayIterator_(this,function(b){return b})};$jscomp.array.keys$install=function(){Array.prototype.keys||(Array.prototype.keys=$jscomp.array.keys)};$jscomp.array.values=function(){return $jscomp.array.arrayIterator_(this,function(b,d){return d})};
$jscomp.array.values$install=function(){Array.prototype.values||(Array.prototype.values=$jscomp.array.values)};$jscomp.array.copyWithin=function(b,d,f){var a=this.length;b=Number(b);d=Number(d);f=Number(null!=f?f:a);if(b<d)for(f=Math.min(f,a);d<f;)d in this?this[b++]=this[d++]:(delete this[b++],d++);else for(f=Math.min(f,a+d-b),b+=f-d;f>d;)--f in this?this[--b]=this[f]:delete this[b];return this};$jscomp.array.copyWithin$install=function(){Array.prototype.copyWithin||(Array.prototype.copyWithin=$jscomp.array.copyWithin)};
$jscomp.array.fill=function(b,d,f){null!=f&&b.length||(f=this.length||0);f=Number(f);for(d=Number((void 0===d?0:d)||0);d<f;d++)this[d]=b;return this};$jscomp.array.fill$install=function(){Array.prototype.fill||(Array.prototype.fill=$jscomp.array.fill)};$jscomp.array.find=function(b,d){return $jscomp.array.findInternal_(this,b,d).v};$jscomp.array.find$install=function(){Array.prototype.find||(Array.prototype.find=$jscomp.array.find)};
$jscomp.array.findIndex=function(b,d){return $jscomp.array.findInternal_(this,b,d).i};$jscomp.array.findIndex$install=function(){Array.prototype.findIndex||(Array.prototype.findIndex=$jscomp.array.findIndex)};$jscomp.Map=function(b){b=void 0===b?[]:b;this.data_={};this.head_=$jscomp.Map.createHead_();this.size=0;if(b){b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next())d=d.value,this.set(d[0],d[1])}};
$jscomp.Map.checkBrowserConformance_=function(){var b=$jscomp.global.Map;if(!b||!b.prototype.entries||!Object.seal)return!1;try{var d=Object.seal({x:4}),f=new b($jscomp.makeIterator([[d,"s"]]));if("s"!=f.get(d)||1!=f.size||f.get({x:4})||f.set({x:4},"t")!=f||2!=f.size)return!1;var a=f.entries(),c=a.next();if(c.done||c.value[0]!=d||"s"!=c.value[1])return!1;c=a.next();return c.done||4!=c.value[0].x||"t"!=c.value[1]||!a.next().done?!1:!0}catch(h){return!1}};
$jscomp.Map.createHead_=function(){var b={};return b.previous=b.next=b.head=b};$jscomp.Map.getId_=function(b){if(!(b instanceof Object))return String(b);$jscomp.Map.key_ in b||b instanceof Object&&Object.isExtensible&&Object.isExtensible(b)&&$jscomp.Map.defineProperty_(b,$jscomp.Map.key_,++$jscomp.Map.index_);return $jscomp.Map.key_ in b?b[$jscomp.Map.key_]:" "+b};
$jscomp.Map.prototype.set=function(b,d){var f=this.maybeGetEntry_(b),a=f.id,c=f.list,f=f.entry;c||(c=this.data_[a]=[]);f?f.value=d:(f={next:this.head_,previous:this.head_.previous,head:this.head_,key:b,value:d},c.push(f),this.head_.previous.next=f,this.head_.previous=f,this.size++);return this};
$jscomp.Map.prototype["delete"]=function(b){var d=this.maybeGetEntry_(b);b=d.id;var f=d.list,a=d.index;return(d=d.entry)&&f?(f.splice(a,1),f.length||delete this.data_[b],d.previous.next=d.next,d.next.previous=d.previous,d.head=null,this.size--,!0):!1};$jscomp.Map.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=$jscomp.Map.createHead_();this.size=0};$jscomp.Map.prototype.has=function(b){return!!this.maybeGetEntry_(b).entry};
$jscomp.Map.prototype.get=function(b){return(b=this.maybeGetEntry_(b).entry)&&b.value};$jscomp.Map.prototype.maybeGetEntry_=function(b){var d=$jscomp.Map.getId_(b),f=this.data_[d];if(f)for(var a=0;a<f.length;a++){var c=f[a];if(b!==b&&c.key!==c.key||b===c.key)return{id:d,list:f,index:a,entry:c}}return{id:d,list:f,index:-1,entry:void 0}};$jscomp.Map.prototype.entries=function(){return this.iter_(function(b){return[b.key,b.value]})};$jscomp.Map.prototype.keys=function(){return this.iter_(function(b){return b.key})};
$jscomp.Map.prototype.values=function(){return this.iter_(function(b){return b.value})};$jscomp.Map.prototype.forEach=function(b,d){for(var f=$jscomp.makeIterator(this.entries()),a=f.next();!a.done;a=f.next())a=a.value,b.call(d,a[1],a[0],this)};
$jscomp.Map.prototype.iter_=function(b){var d=this,f=this.head_;$jscomp.initSymbol();$jscomp.initSymbolIterator();var a={};return a.next=function(){if(f){for(;f.head!=d.head_;)f=f.previous;for(;f.next!=f.head;)return f=f.next,{done:!1,value:b(f)};f=null}return{done:!0,value:void 0}},a[Symbol.iterator]=function(){return this},a};$jscomp.Map.index_=0;$jscomp.Map.defineProperty_=Object.defineProperty?function(b,d,f){Object.defineProperty(b,d,{value:String(f)})}:function(b,d,f){b[d]=String(f)};
$jscomp.Map.Entry_=function(){};$jscomp.Map.ASSUME_NO_NATIVE=!1;$jscomp.Map$install=function(){$jscomp.initSymbol();$jscomp.initSymbolIterator();!$jscomp.Map.ASSUME_NO_NATIVE&&$jscomp.Map.checkBrowserConformance_()?$jscomp.Map=$jscomp.global.Map:($jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Map.prototype[Symbol.iterator]=$jscomp.Map.prototype.entries,$jscomp.initSymbol(),$jscomp.Map.key_=Symbol("map-id-key"));$jscomp.Map$install=function(){}};$jscomp.math=$jscomp.math||{};
$jscomp.math.clz32=function(b){b=Number(b)>>>0;if(0===b)return 32;var d=0;0===(b&4294901760)&&(b<<=16,d+=16);0===(b&4278190080)&&(b<<=8,d+=8);0===(b&4026531840)&&(b<<=4,d+=4);0===(b&3221225472)&&(b<<=2,d+=2);0===(b&2147483648)&&d++;return d};$jscomp.math.imul=function(b,d){b=Number(b);d=Number(d);var f=b&65535,a=d&65535;return f*a+((b>>>16&65535)*a+f*(d>>>16&65535)<<16>>>0)|0};$jscomp.math.sign=function(b){b=Number(b);return 0===b||isNaN(b)?b:0<b?1:-1};
$jscomp.math.log10=function(b){return Math.log(b)/Math.LN10};$jscomp.math.log2=function(b){return Math.log(b)/Math.LN2};$jscomp.math.log1p=function(b){b=Number(b);if(.25>b&&-.25<b){for(var d=b,f=1,a=b,c=0,h=1;c!=a;)d*=b,h*=-1,a=(c=a)+h*d/++f;return a}return Math.log(1+b)};$jscomp.math.expm1=function(b){b=Number(b);if(.25>b&&-.25<b){for(var d=b,f=1,a=b,c=0;c!=a;)d*=b/++f,a=(c=a)+d;return a}return Math.exp(b)-1};$jscomp.math.cosh=function(b){b=Number(b);return(Math.exp(b)+Math.exp(-b))/2};
$jscomp.math.sinh=function(b){b=Number(b);return 0===b?b:(Math.exp(b)-Math.exp(-b))/2};$jscomp.math.tanh=function(b){b=Number(b);if(0===b)return b;var d=Math.exp(2*-Math.abs(b)),d=(1-d)/(1+d);return 0>b?-d:d};$jscomp.math.acosh=function(b){b=Number(b);return Math.log(b+Math.sqrt(b*b-1))};$jscomp.math.asinh=function(b){b=Number(b);if(0===b)return b;var d=Math.log(Math.abs(b)+Math.sqrt(b*b+1));return 0>b?-d:d};
$jscomp.math.atanh=function(b){b=Number(b);return($jscomp.math.log1p(b)-$jscomp.math.log1p(-b))/2};
$jscomp.math.hypot=function(b,d,f){for(var a=[],c=2;c<arguments.length;++c)a[c-2]=arguments[c];b=Number(b);d=Number(d);for(var h=Math.max(Math.abs(b),Math.abs(d)),e=$jscomp.makeIterator(a),c=e.next();!c.done;c=e.next())h=Math.max(h,Math.abs(c.value));if(1E100<h||1E-100>h){b/=h;d/=h;e=b*b+d*d;a=$jscomp.makeIterator(a);for(c=a.next();!c.done;c=a.next())c=c.value,c=Number(c)/h,e+=c*c;return Math.sqrt(e)*h}h=b*b+d*d;a=$jscomp.makeIterator(a);for(c=a.next();!c.done;c=a.next())c=c.value,c=Number(c),h+=
c*c;return Math.sqrt(h)};$jscomp.math.trunc=function(b){b=Number(b);if(isNaN(b)||Infinity===b||-Infinity===b||0===b)return b;var d=Math.floor(Math.abs(b));return 0>b?-d:d};$jscomp.math.cbrt=function(b){if(0===b)return b;b=Number(b);var d=Math.pow(Math.abs(b),1/3);return 0>b?-d:d};$jscomp.number=$jscomp.number||{};$jscomp.number.isFinite=function(b){return"number"!==typeof b?!1:!isNaN(b)&&Infinity!==b&&-Infinity!==b};
$jscomp.number.isInteger=function(b){return $jscomp.number.isFinite(b)?b===Math.floor(b):!1};$jscomp.number.isNaN=function(b){return"number"===typeof b&&isNaN(b)};$jscomp.number.isSafeInteger=function(b){return $jscomp.number.isInteger(b)&&Math.abs(b)<=$jscomp.number.MAX_SAFE_INTEGER};$jscomp.number.EPSILON=Math.pow(2,-52);$jscomp.number.MAX_SAFE_INTEGER=9007199254740991;$jscomp.number.MIN_SAFE_INTEGER=-9007199254740991;$jscomp.object=$jscomp.object||{};
$jscomp.object.assign=function(b,d){for(var f=[],a=1;a<arguments.length;++a)f[a-1]=arguments[a];f=$jscomp.makeIterator(f);for(a=f.next();!a.done;a=f.next())if(a=a.value)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b};$jscomp.object.is=function(b,d){return b===d?0!==b||1/b===1/d:b!==b&&d!==d};$jscomp.Set=function(b){b=void 0===b?[]:b;this.map_=new $jscomp.Map;if(b){b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next())this.add(d.value)}this.size=this.map_.size};
$jscomp.Set.checkBrowserConformance_=function(){var b=$jscomp.global.Set;if(!b||!b.prototype.entries||!Object.seal)return!1;var d=Object.seal({x:4}),b=new b($jscomp.makeIterator([d]));if(b.has(d)||1!=b.size||b.add(d)!=b||1!=b.size||b.add({x:4})!=b||2!=b.size)return!1;var b=b.entries(),f=b.next();if(f.done||f.value[0]!=d||f.value[1]!=d)return!1;f=b.next();return f.done||f.value[0]==d||4!=f.value[0].x||f.value[1]!=f.value[0]?!1:b.next().done};
$jscomp.Set.prototype.add=function(b){this.map_.set(b,b);this.size=this.map_.size;return this};$jscomp.Set.prototype["delete"]=function(b){b=this.map_["delete"](b);this.size=this.map_.size;return b};$jscomp.Set.prototype.clear=function(){this.map_.clear();this.size=0};$jscomp.Set.prototype.has=function(b){return this.map_.has(b)};$jscomp.Set.prototype.entries=function(){return this.map_.entries()};$jscomp.Set.prototype.values=function(){return this.map_.values()};
$jscomp.Set.prototype.forEach=function(b,d){var f=this;this.map_.forEach(function(a){return b.call(d,a,a,f)})};$jscomp.Set.ASSUME_NO_NATIVE=!1;$jscomp.Set$install=function(){!$jscomp.Set.ASSUME_NO_NATIVE&&$jscomp.Set.checkBrowserConformance_()?$jscomp.Set=$jscomp.global.Set:($jscomp.Map$install(),$jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Set.prototype[Symbol.iterator]=$jscomp.Set.prototype.values);$jscomp.Set$install=function(){}};$jscomp.string=$jscomp.string||{};
$jscomp.string.noRegExp_=function(b,d){if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");};
$jscomp.string.fromCodePoint=function(b){for(var d=[],f=0;f<arguments.length;++f)d[f-0]=arguments[f];for(var f="",d=$jscomp.makeIterator(d),a=d.next();!a.done;a=d.next()){a=a.value;a=+a;if(0>a||1114111<a||a!==Math.floor(a))throw new RangeError("invalid_code_point "+a);65535>=a?f+=String.fromCharCode(a):(a-=65536,f+=String.fromCharCode(a>>>10&1023|55296),f+=String.fromCharCode(a&1023|56320))}return f};
$jscomp.string.repeat=function(b){var d=this.toString();if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var f="";b;)if(b&1&&(f+=d),b>>>=1)d+=d;return f};$jscomp.string.repeat$install=function(){String.prototype.repeat||(String.prototype.repeat=$jscomp.string.repeat)};
$jscomp.string.codePointAt=function(b){var d=this.toString(),f=d.length;b=Number(b)||0;if(0<=b&&b<f){b|=0;var a=d.charCodeAt(b);if(55296>a||56319<a||b+1===f)return a;b=d.charCodeAt(b+1);return 56320>b||57343<b?a:1024*(a-55296)+b+9216}};$jscomp.string.codePointAt$install=function(){String.prototype.codePointAt||(String.prototype.codePointAt=$jscomp.string.codePointAt)};
$jscomp.string.includes=function(b,d){d=void 0===d?0:d;$jscomp.string.noRegExp_(b,"includes");return-1!==this.toString().indexOf(b,d)};$jscomp.string.includes$install=function(){String.prototype.includes||(String.prototype.includes=$jscomp.string.includes)};
$jscomp.string.startsWith=function(b,d){d=void 0===d?0:d;$jscomp.string.noRegExp_(b,"startsWith");var f=this.toString();b+="";for(var a=f.length,c=b.length,h=Math.max(0,Math.min(d|0,f.length)),e=0;e<c&&h<a;)if(f[h++]!=b[e++])return!1;return e>=c};$jscomp.string.startsWith$install=function(){String.prototype.startsWith||(String.prototype.startsWith=$jscomp.string.startsWith)};
$jscomp.string.endsWith=function(b,d){$jscomp.string.noRegExp_(b,"endsWith");var f=this.toString();b+="";void 0===d&&(d=f.length);for(var a=Math.max(0,Math.min(d|0,f.length)),c=b.length;0<c&&0<a;)if(f[--a]!=b[--c])return!1;return 0>=c};$jscomp.string.endsWith$install=function(){String.prototype.endsWith||(String.prototype.endsWith=$jscomp.string.endsWith)};
(function e$$0(d,f,a){function c(e,k){if(!f[e]){if(!d[e]){var l="function"==typeof require&&require;if(!k&&l)return l(e,!0);if(h)return h(e,!0);l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l;}l=f[e]={exports:{}};d[e][0].call(l.exports,function(a){var h=d[e][1][a];return c(h?h:a)},l,l.exports,e$$0,d,f,a)}return f[e].exports}for(var h="function"==typeof require&&require,e=0;e<a.length;e++)c(a[e]);return c})({1:[function(b,d,f){function a(a,h,e){return Math.sqrt(Math.pow(a,2)+
Math.pow(h,2)+Math.pow(e,2))}d.exports=function(c,h){for(var e=h.length,b=c.length,k=Array(e),l=0;l<e;++l)k[l]=[0,0,0];for(l=0;l<b;++l){var d=c[l],f=h[d[0]],v=h[d[1]],g=h[d[2]],r=f[0]-v[0],u=f[1]-v[1],y=f[2]-v[2],p=a(r,u,y),A=v[0]-g[0],z=v[1]-g[1],B=v[2]-g[2],F=a(A,z,B),D=a(g[0]-f[0],g[1]-f[1],g[2]-f[2]);1E-6>Math.min(p,F,D)||(g=.5*(p+F+D),v=Math.sqrt((g-p)*(g-F)*(g-D)/g),f=u*B-y*z,y=y*A-r*B,r=r*z-u*A,u=a(f,y,r),f/=u,y/=u,r/=u,u=k[d[0]],F=Math.atan2(v,g-F),A=y,z=r,u[0]+=F*f,u[1]+=F*A,u[2]+=F*z,F=
k[d[1]],D=Math.atan2(v,g-D),u=y,A=r,F[0]+=D*f,F[1]+=D*u,F[2]+=D*A,d=k[d[2]],p=Math.atan2(v,g-p),g=y,v=r,d[0]+=p*f,d[1]+=p*g,d[2]+=p*v)}for(l=0;l<e;++l)b=k[l],p=Math.sqrt(Math.pow(b[0],2)+Math.pow(b[1],2)+Math.pow(b[2],2)),1E-8>p?(b[0]=1,b[1]=0,b[2]=0):(b[0]/=p,b[1]/=p,b[2]/=p);return k}},{}],2:[function(b,d,f){function a(a){var h=a.length;if(0<h%4)throw Error("Invalid string. Length must be a multiple of 4");return"="===a[h-2]?2:"="===a[h-1]?1:0}function c(a,c,b){for(var e=[],d=c;d<b;d+=3)c=(a[d]<<
16)+(a[d+1]<<8)+a[d+2],e.push(h[c>>18&63]+h[c>>12&63]+h[c>>6&63]+h[c&63]);return e.join("")}f.byteLength=function(h){return 3*h.length/4-a(h)};f.toByteArray=function(h){var c,b,d,f,g;c=h.length;f=a(h);g=new E(3*c/4-f);b=0<f?c-4:c;var r=0;for(c=0;c<b;c+=4)d=e[h.charCodeAt(c)]<<18|e[h.charCodeAt(c+1)]<<12|e[h.charCodeAt(c+2)]<<6|e[h.charCodeAt(c+3)],g[r++]=d>>16&255,g[r++]=d>>8&255,g[r++]=d&255;2===f?(d=e[h.charCodeAt(c)]<<2|e[h.charCodeAt(c+1)]>>4,g[r++]=d&255):1===f&&(d=e[h.charCodeAt(c)]<<10|e[h.charCodeAt(c+
1)]<<4|e[h.charCodeAt(c+2)]>>2,g[r++]=d>>8&255,g[r++]=d&255);return g};f.fromByteArray=function(a){for(var b=a.length,e=b%3,d="",f=[],g=0,E=b-e;g<E;g+=16383)f.push(c(a,g,g+16383>E?E:g+16383));1===e?(a=a[b-1],d+=h[a>>2],d+=h[a<<4&63],d+="=="):2===e&&(a=(a[b-2]<<8)+a[b-1],d+=h[a>>10],d+=h[a>>4&63],d+=h[a<<2&63],d+="=");f.push(d);return f.join("")};var h=[],e=[],E="undefined"!==typeof Uint8Array?Uint8Array:Array;for(b=0;64>b;++b)h[b]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[b],
e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(b)]=b;e[45]=62;e[95]=63},{}],3:[function(b,d,f){function a(a){var c=32;(a&=-a)&&c--;a&65535&&(c-=16);a&16711935&&(c-=8);a&252645135&&(c-=4);a&858993459&&(c-=2);a&1431655765&&--c;return c}"use restrict";f.INT_BITS=32;f.INT_MAX=2147483647;f.INT_MIN=-2147483648;f.sign=function(a){return(0<a)-(0>a)};f.abs=function(a){var c=a>>31;return(a^c)-c};f.min=function(a,c){return c^(a^c)&-(a<c)};f.max=function(a,c){return a^(a^c)&-(a<
c)};f.isPow2=function(a){return!(a&a-1)&&!!a};f.log2=function(a){var c,b;c=(65535<a)<<4;a>>>=c;b=(255<a)<<3;a>>>=b;c|=b;b=(15<a)<<2;a>>>=b;c|=b;b=(3<a)<<1;return c|b|a>>>b>>1};f.log10=function(a){return 1E9<=a?9:1E8<=a?8:1E7<=a?7:1E6<=a?6:1E5<=a?5:1E4<=a?4:1E3<=a?3:100<=a?2:10<=a?1:0};f.popCount=function(a){a-=a>>>1&1431655765;a=(a&858993459)+(a>>>2&858993459);return 16843009*(a+(a>>>4)&252645135)>>>24};f.countTrailingZeros=a;f.nextPow2=function(a){a+=0===a;--a;a|=a>>>1;a|=a>>>2;a|=a>>>4;a|=a>>>8;
return(a|a>>>16)+1};f.prevPow2=function(a){a|=a>>>1;a|=a>>>2;a|=a>>>4;a|=a>>>8;a|=a>>>16;return a-(a>>>1)};f.parity=function(a){a^=a>>>16;a^=a>>>8;a=(a^a>>>4)&15;return 27030>>>a&1};var c=Array(256);(function(a){for(var c=0;256>c;++c){for(var b=c,d=c,f=7,b=b>>>1;b;b>>>=1)d<<=1,d|=b&1,--f;a[c]=d<<f&255}})(c);f.reverse=function(a){return c[a&255]<<24|c[a>>>8&255]<<16|c[a>>>16&255]<<8|c[a>>>24&255]};f.interleave2=function(a,c){a&=65535;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;c&=
65535;c=(c|c<<8)&16711935;c=(c|c<<4)&252645135;c=(c|c<<2)&858993459;return(a|a<<1)&1431655765|((c|c<<1)&1431655765)<<1};f.deinterleave2=function(a,c){a=a>>>c&1431655765;a=(a|a>>>1)&858993459;a=(a|a>>>2)&252645135;a=(a|a>>>4)&16711935;return((a|a>>>16)&65535)<<16>>16};f.interleave3=function(a,c,b){a&=1023;a=(a|a<<16)&4278190335;a=(a|a<<8)&251719695;a=(a|a<<4)&3272356035;c&=1023;c=(c|c<<16)&4278190335;c=(c|c<<8)&251719695;c=(c|c<<4)&3272356035;a=(a|a<<2)&1227133513|((c|c<<2)&1227133513)<<1;b&=1023;
b=(b|b<<16)&4278190335;b=(b|b<<8)&251719695;b=(b|b<<4)&3272356035;return a|((b|b<<2)&1227133513)<<2};f.deinterleave3=function(a,c){a=a>>>c&1227133513;a=(a|a>>>2)&3272356035;a=(a|a>>>4)&251719695;a=(a|a>>>8)&4278190335;return((a|a>>>16)&1023)<<22>>22};f.nextCombination=function(c){var b=c|c-1;return b+1|(~b&-~b)-1>>>a(c)+1}},{}],4:[function(b,d,f){(function(a){function c(){try{var a=new Uint8Array(1);a.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return 42===a.foo()&&"function"===
typeof a.subarray&&0===a.subarray(1,1).byteLength}catch(c){return!1}}function d(a,c){if((e.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<c)throw new RangeError("Invalid typed array length");e.TYPED_ARRAY_SUPPORT?(a=new Uint8Array(c),a.__proto__=e.prototype):(null===a&&(a=new e(c)),a.length=c);return a}function e(a,c,b){if(!(e.TYPED_ARRAY_SUPPORT||this instanceof e))return new e(a,c,b);if("number"===typeof a){if("string"===typeof c)throw Error("If encoding is specified then the first argument must be a string");
return l(this,a)}return E(this,a,c,b)}function E(a,c,b,k){if("number"===typeof c)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&c instanceof ArrayBuffer){c.byteLength;if(0>b||c.byteLength<b)throw new RangeError("'offset' is out of bounds");if(c.byteLength<b+(k||0))throw new RangeError("'length' is out of bounds");c=void 0===b&&void 0===k?new Uint8Array(c):void 0===k?new Uint8Array(c,b):new Uint8Array(c,b,k);e.TYPED_ARRAY_SUPPORT?(a=c,a.__proto__=
e.prototype):a=q(a,c);return a}if("string"===typeof c){k=a;a=b;if("string"!==typeof a||""===a)a="utf8";if(!e.isEncoding(a))throw new TypeError('"encoding" must be a valid string encoding');b=g(c,a)|0;k=d(k,b);c=k.write(c,a);c!==b&&(k=k.slice(0,c));return k}return x(a,c)}function k(a){if("number"!==typeof a)throw new TypeError('"size" argument must be a number');if(0>a)throw new RangeError('"size" argument must not be negative');}function l(a,c){k(c);a=d(a,0>c?0:v(c)|0);if(!e.TYPED_ARRAY_SUPPORT)for(var b=
0;b<c;++b)a[b]=0;return a}function q(a,c){var b=0>c.length?0:v(c.length)|0;a=d(a,b);for(var e=0;e<b;e+=1)a[e]=c[e]&255;return a}function x(a,c){if(e.isBuffer(c)){var b=v(c.length)|0;a=d(a,b);if(0===a.length)return a;c.copy(a,0,0,b);return a}if(c){if("undefined"!==typeof ArrayBuffer&&c.buffer instanceof ArrayBuffer||"length"in c)return(b="number"!==typeof c.length)||(b=c.length,b=b!==b),b?d(a,0):q(a,c);if("Buffer"===c.type&&U(c.data))return q(a,c.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");
}function v(a){if(a>=(e.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(e.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return a|0}function g(a,c){if(e.isBuffer(a))return a.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(a)||a instanceof ArrayBuffer))return a.byteLength;"string"!==typeof a&&(a=""+a);var b=a.length;if(0===b)return 0;for(var d=!1;;)switch(c){case "ascii":case "latin1":case "binary":return b;
case "utf8":case "utf-8":case void 0:return P(a).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*b;case "hex":return b>>>1;case "base64":return W.toByteArray(N(a)).length;default:if(d)return P(a).length;c=(""+c).toLowerCase();d=!0}}function r(a,c,b){var e=!1;if(void 0===c||0>c)c=0;if(c>this.length)return"";if(void 0===b||b>this.length)b=this.length;if(0>=b)return"";b>>>=0;c>>>=0;if(b<=c)return"";for(a||(a="utf8");;)switch(a){case "hex":a=c;c=b;b=this.length;if(!a||0>a)a=0;
if(!c||0>c||c>b)c=b;e="";for(b=a;b<c;++b)a=e,e=this[b],e=16>e?"0"+e.toString(16):e.toString(16),e=a+e;return e;case "utf8":case "utf-8":return A(this,c,b);case "ascii":a="";for(b=Math.min(this.length,b);c<b;++c)a+=String.fromCharCode(this[c]&127);return a;case "latin1":case "binary":a="";for(b=Math.min(this.length,b);c<b;++c)a+=String.fromCharCode(this[c]);return a;case "base64":return c=0===c&&b===this.length?W.fromByteArray(this):W.fromByteArray(this.slice(c,b)),c;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":c=
this.slice(c,b);b="";for(a=0;a<c.length;a+=2)b+=String.fromCharCode(c[a]+256*c[a+1]);return b;default:if(e)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase();e=!0}}function u(a,c,b){var e=a[c];a[c]=a[b];a[b]=e}function y(a,c,b,d,h){if(0===a.length)return-1;"string"===typeof b?(d=b,b=0):2147483647<b?b=2147483647:-2147483648>b&&(b=-2147483648);b=+b;isNaN(b)&&(b=h?0:a.length-1);0>b&&(b=a.length+b);if(b>=a.length){if(h)return-1;b=a.length-1}else if(0>b)if(h)b=0;else return-1;"string"===
typeof c&&(c=e.from(c,d));if(e.isBuffer(c))return 0===c.length?-1:p(a,c,b,d,h);if("number"===typeof c)return c&=255,e.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?h?Uint8Array.prototype.indexOf.call(a,c,b):Uint8Array.prototype.lastIndexOf.call(a,c,b):p(a,[c],b,d,h);throw new TypeError("val must be string, number or Buffer");}function p(a,c,b,e,d){function h(a,c){return 1===k?a[c]:a.readUInt16BE(c*k)}var k=1,g=a.length,f=c.length;if(void 0!==e&&(e=String(e).toLowerCase(),"ucs2"===
e||"ucs-2"===e||"utf16le"===e||"utf-16le"===e)){if(2>a.length||2>c.length)return-1;k=2;g/=2;f/=2;b/=2}if(d)for(e=-1;b<g;b++)if(h(a,b)===h(c,-1===e?0:b-e)){if(-1===e&&(e=b),b-e+1===f)return e*k}else-1!==e&&(b-=b-e),e=-1;else for(b+f>g&&(b=g-f);0<=b;b--){g=!0;for(e=0;e<f;e++)if(h(a,b+e)!==h(c,e)){g=!1;break}if(g)return b}return-1}function A(a,c,b){b=Math.min(a.length,b);for(var e=[];c<b;){var d=a[c],h=null,k=239<d?4:223<d?3:191<d?2:1;if(c+k<=b){var g,f,l;switch(k){case 1:128>d&&(h=d);break;case 2:g=
a[c+1];128===(g&192)&&(d=(d&31)<<6|g&63,127<d&&(h=d));break;case 3:g=a[c+1];f=a[c+2];128===(g&192)&&128===(f&192)&&(d=(d&15)<<12|(g&63)<<6|f&63,2047<d&&(55296>d||57343<d)&&(h=d));break;case 4:g=a[c+1],f=a[c+2],l=a[c+3],128===(g&192)&&128===(f&192)&&128===(l&192)&&(d=(d&15)<<18|(g&63)<<12|(f&63)<<6|l&63,65535<d&&1114112>d&&(h=d))}}null===h?(h=65533,k=1):65535<h&&(h-=65536,e.push(h>>>10&1023|55296),h=56320|h&1023);e.push(h);c+=k}a=e.length;if(a<=aa)e=String.fromCharCode.apply(String,e);else{b="";for(c=
0;c<a;)b+=String.fromCharCode.apply(String,e.slice(c,c+=aa));e=b}return e}function z(a,c,b){if(0!==a%1||0>a)throw new RangeError("offset is not uint");if(a+c>b)throw new RangeError("Trying to access beyond buffer length");}function B(a,c,b,d,h,g){if(!e.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>h||c<g)throw new RangeError('"value" argument is out of bounds');if(b+d>a.length)throw new RangeError("Index out of range");}function F(a,c,b,e){0>c&&(c=65535+c+1);
for(var d=0,h=Math.min(a.length-b,2);d<h;++d)a[b+d]=(c&255<<8*(e?d:1-d))>>>8*(e?d:1-d)}function D(a,c,b,e){0>c&&(c=4294967295+c+1);for(var d=0,h=Math.min(a.length-b,4);d<h;++d)a[b+d]=c>>>8*(e?d:3-d)&255}function w(a,c,b,e,d,h){if(b+e>a.length)throw new RangeError("Index out of range");if(0>b)throw new RangeError("Index out of range");}function C(a,c,b,e,d){d||w(a,c,b,4,3.4028234663852886E38,-3.4028234663852886E38);K.write(a,c,b,e,23,4);return b+4}function H(a,c,b,e,d){d||w(a,c,b,8,1.7976931348623157E308,
-1.7976931348623157E308);K.write(a,c,b,e,52,8);return b+8}function N(a){a=a.trim?a.trim():a.replace(/^\s+|\s+$/g,"");a=a.replace(O,"");if(2>a.length)return"";for(;0!==a.length%4;)a+="=";return a}function P(a,c){c=c||Infinity;for(var b,e=a.length,d=null,h=[],g=0;g<e;++g){b=a.charCodeAt(g);if(55295<b&&57344>b){if(!d){if(56319<b){-1<(c-=3)&&h.push(239,191,189);continue}else if(g+1===e){-1<(c-=3)&&h.push(239,191,189);continue}d=b;continue}if(56320>b){-1<(c-=3)&&h.push(239,191,189);d=b;continue}b=(d-55296<<
10|b-56320)+65536}else d&&-1<(c-=3)&&h.push(239,191,189);d=null;if(128>b){if(0>--c)break;h.push(b)}else if(2048>b){if(0>(c-=2))break;h.push(b>>6|192,b&63|128)}else if(65536>b){if(0>(c-=3))break;h.push(b>>12|224,b>>6&63|128,b&63|128)}else if(1114112>b){if(0>(c-=4))break;h.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw Error("Invalid code point");}return h}function G(a){for(var c=[],b=0;b<a.length;++b)c.push(a.charCodeAt(b)&255);return c}function J(a,c,b,e){for(var d=0;d<e&&!(d+b>=c.length||
d>=a.length);++d)c[d+b]=a[d];return d}var W=b("base64-js"),K=b("ieee754"),U=b("isarray");f.Buffer=e;f.SlowBuffer=function(a){+a!=a&&(a=0);return e.alloc(+a)};f.INSPECT_MAX_BYTES=50;e.TYPED_ARRAY_SUPPORT=void 0!==a.TYPED_ARRAY_SUPPORT?a.TYPED_ARRAY_SUPPORT:c();f.kMaxLength=e.TYPED_ARRAY_SUPPORT?2147483647:1073741823;e.poolSize=8192;e._augment=function(a){a.__proto__=e.prototype;return a};e.from=function(a,c,b){return E(null,a,c,b)};e.TYPED_ARRAY_SUPPORT&&(e.prototype.__proto__=Uint8Array.prototype,
e.__proto__=Uint8Array,$jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.initSymbol(),"undefined"!==typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&($jscomp.initSymbol(),Object.defineProperty(e,Symbol.species,{value:null,configurable:!0})));e.alloc=function(a,c,b){k(a);a=0>=a?d(null,a):void 0!==c?"string"===typeof b?d(null,a).fill(c,b):d(null,a).fill(c):d(null,a);return a};e.allocUnsafe=function(a){return l(null,a)};e.allocUnsafeSlow=function(a){return l(null,a)};e.isBuffer=function(a){return!(null==
a||!a._isBuffer)};e.compare=function(a,c){if(!e.isBuffer(a)||!e.isBuffer(c))throw new TypeError("Arguments must be Buffers");if(a===c)return 0;for(var b=a.length,d=c.length,h=0,g=Math.min(b,d);h<g;++h)if(a[h]!==c[h]){b=a[h];d=c[h];break}return b<d?-1:d<b?1:0};e.isEncoding=function(a){switch(String(a).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};e.concat=
function(a,c){if(!U(a))throw new TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return e.alloc(0);var b;if(void 0===c)for(b=c=0;b<a.length;++b)c+=a[b].length;var d=e.allocUnsafe(c),h=0;for(b=0;b<a.length;++b){var g=a[b];if(!e.isBuffer(g))throw new TypeError('"list" argument must be an Array of Buffers');g.copy(d,h);h+=g.length}return d};e.byteLength=g;e.prototype._isBuffer=!0;e.prototype.swap16=function(){var a=this.length;if(0!==a%2)throw new RangeError("Buffer size must be a multiple of 16-bits");
for(var c=0;c<a;c+=2)u(this,c,c+1);return this};e.prototype.swap32=function(){var a=this.length;if(0!==a%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<a;c+=4)u(this,c,c+3),u(this,c+1,c+2);return this};e.prototype.swap64=function(){var a=this.length;if(0!==a%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var c=0;c<a;c+=8)u(this,c,c+7),u(this,c+1,c+6),u(this,c+2,c+5),u(this,c+3,c+4);return this};e.prototype.toString=function(){var a=this.length|
0;return 0===a?"":0===arguments.length?A(this,0,a):r.apply(this,arguments)};e.prototype.equals=function(a){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:0===e.compare(this,a)};e.prototype.inspect=function(){var a="",c=f.INSPECT_MAX_BYTES;0<this.length&&(a=this.toString("hex",0,c).match(/.{2}/g).join(" "),this.length>c&&(a+=" ... "));return"<Buffer "+a+">"};e.prototype.compare=function(a,c,b,d,h){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");
void 0===c&&(c=0);void 0===b&&(b=a?a.length:0);void 0===d&&(d=0);void 0===h&&(h=this.length);if(0>c||b>a.length||0>d||h>this.length)throw new RangeError("out of range index");if(d>=h&&c>=b)return 0;if(d>=h)return-1;if(c>=b)return 1;c>>>=0;b>>>=0;d>>>=0;h>>>=0;if(this===a)return 0;var g=h-d,k=b-c,f=Math.min(g,k);d=this.slice(d,h);a=a.slice(c,b);for(c=0;c<f;++c)if(d[c]!==a[c]){g=d[c];k=a[c];break}return g<k?-1:k<g?1:0};e.prototype.includes=function(a,c,b){return-1!==this.indexOf(a,c,b)};e.prototype.indexOf=
function(a,c,b){return y(this,a,c,b,!0)};e.prototype.lastIndexOf=function(a,c,b){return y(this,a,c,b,!1)};e.prototype.write=function(a,c,b,e){if(void 0===c)e="utf8",b=this.length,c=0;else if(void 0===b&&"string"===typeof c)e=c,b=this.length,c=0;else if(isFinite(c))c|=0,isFinite(b)?(b|=0,void 0===e&&(e="utf8")):(e=b,b=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var d=this.length-c;if(void 0===b||b>d)b=d;if(0<a.length&&(0>b||0>c)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");
e||(e="utf8");for(d=!1;;)switch(e){case "hex":a:{c=Number(c)||0;e=this.length-c;b?(b=Number(b),b>e&&(b=e)):b=e;e=a.length;if(0!==e%2)throw new TypeError("Invalid hex string");b>e/2&&(b=e/2);for(e=0;e<b;++e){d=parseInt(a.substr(2*e,2),16);if(isNaN(d)){a=e;break a}this[c+e]=d}a=e}return a;case "utf8":case "utf-8":return J(P(a,this.length-c),this,c,b);case "ascii":return J(G(a),this,c,b);case "latin1":case "binary":return J(G(a),this,c,b);case "base64":return J(W.toByteArray(N(a)),this,c,b);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":e=
this.length-c;for(var h=void 0,h=d=void 0,g=[],k=0;k<a.length&&!(0>(e-=2));++k)h=a.charCodeAt(k),d=h>>8,h%=256,g.push(h),g.push(d);return J(g,this,c,b);default:if(d)throw new TypeError("Unknown encoding: "+e);e=(""+e).toLowerCase();d=!0}};e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var aa=4096;e.prototype.slice=function(a,c){var b=this.length;a=~~a;c=void 0===c?b:~~c;0>a?(a+=b,0>a&&(a=0)):a>b&&(a=b);0>c?(c+=b,0>c&&(c=0)):c>b&&(c=b);c<a&&
(c=a);if(e.TYPED_ARRAY_SUPPORT)b=this.subarray(a,c),b.__proto__=e.prototype;else for(var d=c-a,b=new e(d,void 0),h=0;h<d;++h)b[h]=this[h+a];return b};e.prototype.readUIntLE=function(a,c,b){a|=0;c|=0;b||z(a,c,this.length);b=this[a];for(var e=1,d=0;++d<c&&(e*=256);)b+=this[a+d]*e;return b};e.prototype.readUIntBE=function(a,c,b){a|=0;c|=0;b||z(a,c,this.length);b=this[a+--c];for(var e=1;0<c&&(e*=256);)b+=this[a+--c]*e;return b};e.prototype.readUInt8=function(a,c){c||z(a,1,this.length);return this[a]};
e.prototype.readUInt16LE=function(a,c){c||z(a,2,this.length);return this[a]|this[a+1]<<8};e.prototype.readUInt16BE=function(a,c){c||z(a,2,this.length);return this[a]<<8|this[a+1]};e.prototype.readUInt32LE=function(a,c){c||z(a,4,this.length);return(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]};e.prototype.readUInt32BE=function(a,c){c||z(a,4,this.length);return 16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])};e.prototype.readIntLE=function(a,c,b){a|=0;c|=0;b||z(a,c,this.length);b=
this[a];for(var e=1,d=0;++d<c&&(e*=256);)b+=this[a+d]*e;b>=128*e&&(b-=Math.pow(2,8*c));return b};e.prototype.readIntBE=function(a,c,b){a|=0;c|=0;b||z(a,c,this.length);b=c;for(var e=1,d=this[a+--b];0<b&&(e*=256);)d+=this[a+--b]*e;d>=128*e&&(d-=Math.pow(2,8*c));return d};e.prototype.readInt8=function(a,c){c||z(a,1,this.length);return this[a]&128?-1*(255-this[a]+1):this[a]};e.prototype.readInt16LE=function(a,c){c||z(a,2,this.length);var b=this[a]|this[a+1]<<8;return b&32768?b|4294901760:b};e.prototype.readInt16BE=
function(a,c){c||z(a,2,this.length);var b=this[a+1]|this[a]<<8;return b&32768?b|4294901760:b};e.prototype.readInt32LE=function(a,c){c||z(a,4,this.length);return this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24};e.prototype.readInt32BE=function(a,c){c||z(a,4,this.length);return this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]};e.prototype.readFloatLE=function(a,c){c||z(a,4,this.length);return K.read(this,a,!0,23,4)};e.prototype.readFloatBE=function(a,c){c||z(a,4,this.length);return K.read(this,a,!1,
23,4)};e.prototype.readDoubleLE=function(a,c){c||z(a,8,this.length);return K.read(this,a,!0,52,8)};e.prototype.readDoubleBE=function(a,c){c||z(a,8,this.length);return K.read(this,a,!1,52,8)};e.prototype.writeUIntLE=function(a,c,b,e){a=+a;c|=0;b|=0;e||B(this,a,c,b,Math.pow(2,8*b)-1,0);e=1;var d=0;for(this[c]=a&255;++d<b&&(e*=256);)this[c+d]=a/e&255;return c+b};e.prototype.writeUIntBE=function(a,c,b,e){a=+a;c|=0;b|=0;e||B(this,a,c,b,Math.pow(2,8*b)-1,0);e=b-1;var d=1;for(this[c+e]=a&255;0<=--e&&(d*=
256);)this[c+e]=a/d&255;return c+b};e.prototype.writeUInt8=function(a,c,b){a=+a;c|=0;b||B(this,a,c,1,255,0);e.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));this[c]=a&255;return c+1};e.prototype.writeUInt16LE=function(a,c,b){a=+a;c|=0;b||B(this,a,c,2,65535,0);e.TYPED_ARRAY_SUPPORT?(this[c]=a&255,this[c+1]=a>>>8):F(this,a,c,!0);return c+2};e.prototype.writeUInt16BE=function(a,c,b){a=+a;c|=0;b||B(this,a,c,2,65535,0);e.TYPED_ARRAY_SUPPORT?(this[c]=a>>>8,this[c+1]=a&255):F(this,a,c,!1);return c+2};e.prototype.writeUInt32LE=
function(a,c,b){a=+a;c|=0;b||B(this,a,c,4,4294967295,0);e.TYPED_ARRAY_SUPPORT?(this[c+3]=a>>>24,this[c+2]=a>>>16,this[c+1]=a>>>8,this[c]=a&255):D(this,a,c,!0);return c+4};e.prototype.writeUInt32BE=function(a,c,b){a=+a;c|=0;b||B(this,a,c,4,4294967295,0);e.TYPED_ARRAY_SUPPORT?(this[c]=a>>>24,this[c+1]=a>>>16,this[c+2]=a>>>8,this[c+3]=a&255):D(this,a,c,!1);return c+4};e.prototype.writeIntLE=function(a,c,b,e){a=+a;c|=0;e||(e=Math.pow(2,8*b-1),B(this,a,c,b,e-1,-e));e=0;var d=1,h=0;for(this[c]=a&255;++e<
b&&(d*=256);)0>a&&0===h&&0!==this[c+e-1]&&(h=1),this[c+e]=(a/d>>0)-h&255;return c+b};e.prototype.writeIntBE=function(a,c,b,e){a=+a;c|=0;e||(e=Math.pow(2,8*b-1),B(this,a,c,b,e-1,-e));e=b-1;var d=1,h=0;for(this[c+e]=a&255;0<=--e&&(d*=256);)0>a&&0===h&&0!==this[c+e+1]&&(h=1),this[c+e]=(a/d>>0)-h&255;return c+b};e.prototype.writeInt8=function(a,c,b){a=+a;c|=0;b||B(this,a,c,1,127,-128);e.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));0>a&&(a=255+a+1);this[c]=a&255;return c+1};e.prototype.writeInt16LE=function(a,
c,b){a=+a;c|=0;b||B(this,a,c,2,32767,-32768);e.TYPED_ARRAY_SUPPORT?(this[c]=a&255,this[c+1]=a>>>8):F(this,a,c,!0);return c+2};e.prototype.writeInt16BE=function(a,c,b){a=+a;c|=0;b||B(this,a,c,2,32767,-32768);e.TYPED_ARRAY_SUPPORT?(this[c]=a>>>8,this[c+1]=a&255):F(this,a,c,!1);return c+2};e.prototype.writeInt32LE=function(a,c,b){a=+a;c|=0;b||B(this,a,c,4,2147483647,-2147483648);e.TYPED_ARRAY_SUPPORT?(this[c]=a&255,this[c+1]=a>>>8,this[c+2]=a>>>16,this[c+3]=a>>>24):D(this,a,c,!0);return c+4};e.prototype.writeInt32BE=
function(a,c,b){a=+a;c|=0;b||B(this,a,c,4,2147483647,-2147483648);0>a&&(a=4294967295+a+1);e.TYPED_ARRAY_SUPPORT?(this[c]=a>>>24,this[c+1]=a>>>16,this[c+2]=a>>>8,this[c+3]=a&255):D(this,a,c,!1);return c+4};e.prototype.writeFloatLE=function(a,c,b){return C(this,a,c,!0,b)};e.prototype.writeFloatBE=function(a,c,b){return C(this,a,c,!1,b)};e.prototype.writeDoubleLE=function(a,c,b){return H(this,a,c,!0,b)};e.prototype.writeDoubleBE=function(a,c,b){return H(this,a,c,!1,b)};e.prototype.copy=function(a,c,
b,d){b||(b=0);d||0===d||(d=this.length);c>=a.length&&(c=a.length);c||(c=0);0<d&&d<b&&(d=b);if(d===b||0===a.length||0===this.length)return 0;if(0>c)throw new RangeError("targetStart out of bounds");if(0>b||b>=this.length)throw new RangeError("sourceStart out of bounds");if(0>d)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length);a.length-c<d-b&&(d=a.length-c+b);var h=d-b;if(this===a&&b<c&&c<d)for(d=h-1;0<=d;--d)a[d+c]=this[d+b];else if(1E3>h||!e.TYPED_ARRAY_SUPPORT)for(d=
0;d<h;++d)a[d+c]=this[d+b];else Uint8Array.prototype.set.call(a,this.subarray(b,b+h),c);return h};e.prototype.fill=function(a,c,b,d){if("string"===typeof a){"string"===typeof c?(d=c,c=0,b=this.length):"string"===typeof b&&(d=b,b=this.length);if(1===a.length){var h=a.charCodeAt(0);256>h&&(a=h)}if(void 0!==d&&"string"!==typeof d)throw new TypeError("encoding must be a string");if("string"===typeof d&&!e.isEncoding(d))throw new TypeError("Unknown encoding: "+d);}else"number"===typeof a&&(a&=255);if(0>
c||this.length<c||this.length<b)throw new RangeError("Out of range index");if(b<=c)return this;c>>>=0;b=void 0===b?this.length:b>>>0;a||(a=0);if("number"===typeof a)for(d=c;d<b;++d)this[d]=a;else for(a=e.isBuffer(a)?a:P((new e(a,d)).toString()),h=a.length,d=0;d<b-c;++d)this[d+c]=a[d%h];return this};var O=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"base64-js":2,ieee754:32,isarray:36}],5:[function(b,d,f){function a(){this.argTypes=
[];this.shimArgs=[];this.arrayArgs=[];this.arrayBlockIndices=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.post=this.body=this.pre=null;this.debug=!1}var c=b("./lib/thunk.js");d.exports=function(b){var e=new a;e.pre=b.pre;e.body=b.body;e.post=b.post;var d=b.args.slice(0);e.argTypes=d;for(var k=0;k<d.length;++k){var f=d[k];if("array"===f||"object"===typeof f&&f.blockIndices){e.argTypes[k]="array";e.arrayArgs.push(k);e.arrayBlockIndices.push(f.blockIndices?
f.blockIndices:0);e.shimArgs.push("array"+k);if(k<e.pre.args.length&&0<e.pre.args[k].count)throw Error("cwise: pre() block may not reference array args");if(k<e.post.args.length&&0<e.post.args[k].count)throw Error("cwise: post() block may not reference array args");}else if("scalar"===f)e.scalarArgs.push(k),e.shimArgs.push("scalar"+k);else if("index"===f){e.indexArgs.push(k);if(k<e.pre.args.length&&0<e.pre.args[k].count)throw Error("cwise: pre() block may not reference array index");if(k<e.body.args.length&&
e.body.args[k].lvalue)throw Error("cwise: body() block may not write to array index");if(k<e.post.args.length&&0<e.post.args[k].count)throw Error("cwise: post() block may not reference array index");}else if("shape"===f){e.shapeArgs.push(k);if(k<e.pre.args.length&&e.pre.args[k].lvalue)throw Error("cwise: pre() block may not write to array shape");if(k<e.body.args.length&&e.body.args[k].lvalue)throw Error("cwise: body() block may not write to array shape");if(k<e.post.args.length&&e.post.args[k].lvalue)throw Error("cwise: post() block may not write to array shape");
}else if("object"===typeof f&&f.offset)e.argTypes[k]="offset",e.offsetArgs.push({array:f.array,offset:f.offset}),e.offsetArgIndex.push(k);else throw Error("cwise: Unknown argument type "+d[k]);}if(0>=e.arrayArgs.length)throw Error("cwise: No array arguments specified");if(e.pre.args.length>d.length)throw Error("cwise: Too many arguments in pre() block");if(e.body.args.length>d.length)throw Error("cwise: Too many arguments in body() block");if(e.post.args.length>d.length)throw Error("cwise: Too many arguments in post() block");
e.debug=!!b.printCode||!!b.debug;e.funcName=b.funcName||"cwise";e.blockSize=b.blockSize||64;return c(e)}},{"./lib/thunk.js":7}],6:[function(b,d,f){function a(a,c,b){var e=a.length,d=c.arrayArgs.length;c=0<c.indexArgs.length;var h=[],f=[],u=0,E=0,p,A;for(p=0;p<e;++p)f.push(["i",p,"=0"].join(""));for(A=0;A<d;++A)for(p=0;p<e;++p)E=u,u=a[p],0===p?f.push(["d",A,"s",p,"=t",A,"p",u].join("")):f.push(["d",A,"s",p,"=(t",A,"p",u,"-s",E,"*t",A,"p",E,")"].join(""));h.push("var "+f.join(","));for(p=e-1;0<=p;--p)u=
a[p],h.push(["for(i",p,"=0;i",p,"<s",u,";++i",p,"){"].join(""));h.push(b);for(p=0;p<e;++p){E=u;u=a[p];for(A=0;A<d;++A)h.push(["p",A,"+=d",A,"s",p].join(""));c&&(0<p&&h.push(["index[",E,"]-=s",E].join("")),h.push(["++index[",u,"]"].join("")));h.push("}")}return h.join("\n")}function c(c,b,e,d){for(var h=b.length,g=e.arrayArgs.length,f=e.blockSize,u=0<e.indexArgs.length,E=[],p=0;p<g;++p)E.push(["var offset",p,"=p",p].join(""));for(p=c;p<h;++p)E.push(["for(var j"+p+"=SS[",b[p],"]|0;j",p,">0;){"].join("")),
E.push(["if(j",p,"<",f,"){"].join("")),E.push(["s",b[p],"=j",p].join("")),E.push(["j",p,"=0"].join("")),E.push(["}else{s",b[p],"=",f].join("")),E.push(["j",p,"-=",f,"}"].join("")),u&&E.push(["index[",b[p],"]=j",p].join(""));for(p=0;p<g;++p){f=["offset"+p];for(u=c;u<h;++u)f.push(["j",u,"*t",p,"p",b[u]].join(""));E.push(["p",p,"=(",f.join("+"),")"].join(""))}E.push(a(b,e,d));for(p=c;p<h;++p)E.push("}");return E.join("\n")}function h(a,c,b){for(var e=a.body,d=[],h=[],f=0;f<a.args.length;++f){var E=a.args[f];
if(!(0>=E.count)){var y=new RegExp(E.name,"g"),p="",A=c.arrayArgs.indexOf(f);switch(c.argTypes[f]){case "offset":var z=c.offsetArgIndex.indexOf(f),A=c.offsetArgs[z].array,p="+q"+z;case "array":var p="p"+A+p,B="l"+f,z="a"+A;if(0===c.arrayBlockIndices[A])1===E.count?"generic"===b[A]?E.lvalue?(d.push(["var ",B,"=",z,".get(",p,")"].join("")),e=e.replace(y,B),h.push([z,".set(",p,",",B,")"].join(""))):e=e.replace(y,[z,".get(",p,")"].join("")):e=e.replace(y,[z,"[",p,"]"].join("")):"generic"===b[A]?(d.push(["var ",
B,"=",z,".get(",p,")"].join("")),e=e.replace(y,B),E.lvalue&&h.push([z,".set(",p,",",B,")"].join(""))):(d.push(["var ",B,"=",z,"[",p,"]"].join("")),e=e.replace(y,B),E.lvalue&&h.push([z,"[",p,"]=",B].join("")));else{y=[E.name];E=[p];for(p=0;p<Math.abs(c.arrayBlockIndices[A]);p++)y.push("\\s*\\[([^\\]]+)\\]"),E.push("$"+(p+1)+"*t"+A+"b"+p);y=new RegExp(y.join(""),"g");p=E.join("+");if("generic"===b[A])throw Error("cwise: Generic arrays not supported in combination with blocks!");e=e.replace(y,[z,"[",
p,"]"].join(""))}break;case "scalar":e=e.replace(y,"Y"+c.scalarArgs.indexOf(f));break;case "index":e=e.replace(y,"index");break;case "shape":e=e.replace(y,"shape")}}}return[d.join("\n"),e,h.join("\n")].join("\n").trim()}function e(a){for(var c=Array(a.length),b=!0,e=0;e<a.length;++e){var d=a[e],h=d.match(/\d+/),h=h?h[0]:"";0===d.charAt(0)?c[e]="u"+d.charAt(1)+h:c[e]=d.charAt(0)+h;0<e&&(b=b&&c[e]===c[e-1])}return b?c[0]:c.join("")}var E=b("uniq");d.exports=function(b,d){for(var f=d[1].length-Math.abs(b.arrayBlockIndices[0])|
0,x=Array(b.arrayArgs.length),v=Array(b.arrayArgs.length),g=0;g<b.arrayArgs.length;++g)v[g]=d[2*g],x[g]=d[2*g+1];for(var r=[],u=[],y=[],p=[],A=[],g=0;g<b.arrayArgs.length;++g){0>b.arrayBlockIndices[g]?(y.push(0),p.push(f),r.push(f),u.push(f+b.arrayBlockIndices[g])):(y.push(b.arrayBlockIndices[g]),p.push(b.arrayBlockIndices[g]+f),r.push(0),u.push(b.arrayBlockIndices[g]));for(var z=[],B=0;B<x[g].length;B++)y[g]<=x[g][B]&&x[g][B]<p[g]&&z.push(x[g][B]-y[g]);A.push(z)}u=["SS"];p=["'use strict'"];z=[];
for(B=0;B<f;++B)z.push(["s",B,"=SS[",B,"]"].join(""));for(g=0;g<b.arrayArgs.length;++g){u.push("a"+g);u.push("t"+g);u.push("p"+g);for(B=0;B<f;++B)z.push(["t",g,"p",B,"=t",g,"[",y[g]+B,"]"].join(""));for(B=0;B<Math.abs(b.arrayBlockIndices[g]);++B)z.push(["t",g,"b",B,"=t",g,"[",r[g]+B,"]"].join(""))}for(g=0;g<b.scalarArgs.length;++g)u.push("Y"+g);0<b.shapeArgs.length&&z.push("shape=SS.slice(0)");if(0<b.indexArgs.length){B=Array(f);for(g=0;g<f;++g)B[g]="0";z.push(["index=[",B.join(","),"]"].join(""))}for(g=
0;g<b.offsetArgs.length;++g){r=b.offsetArgs[g];y=[];for(B=0;B<r.offset.length;++B)0!==r.offset[B]&&(1===r.offset[B]?y.push(["t",r.array,"p",B].join("")):y.push([r.offset[B],"*t",r.array,"p",B].join("")));0===y.length?z.push("q"+g+"=0"):z.push(["q",g,"=",y.join("+")].join(""))}g=E([].concat(b.pre.thisVars).concat(b.body.thisVars).concat(b.post.thisVars));z=z.concat(g);p.push("var "+z.join(","));for(g=0;g<b.arrayArgs.length;++g)p.push("p"+g+"|=0");3<b.pre.body.length&&p.push(h(b.pre,b,v));g=h(b.body,
b,v);a:for(B=0,z=A[0].length;B<z;){for(r=1;r<A.length;++r)if(A[r][B]!==A[0][B])break a;++B}B<f?p.push(c(B,A[0],b,g)):p.push(a(A[0],b,g));3<b.post.body.length&&p.push(h(b.post,b,v));b.debug&&console.log("-----Generated cwise routine for ",d,":\n"+p.join("\n")+"\n----------");f=[b.funcName||"unnamed","_cwise_loop_",x[0].join("s"),"m",B,e(v)].join("");return(new Function(["function ",f,"(",u.join(","),"){",p.join("\n"),"} return ",f].join("")))()}},{uniq:51}],7:[function(b,d,f){var a=b("./compile.js");
d.exports=function(c){var b=["'use strict'","var CACHED={}"],e=[];b.push(["return function ",c.funcName+"_cwise_thunk","(",c.shimArgs.join(","),"){"].join(""));for(var d=[],f=[],l=[["array",c.arrayArgs[0],".shape.slice(",Math.max(0,c.arrayBlockIndices[0]),0>c.arrayBlockIndices[0]?","+c.arrayBlockIndices[0]+")":")"].join("")],q=[],x=[],v=0;v<c.arrayArgs.length;++v){var g=c.arrayArgs[v];e.push(["t",g,"=array",g,".dtype,r",g,"=array",g,".order"].join(""));d.push("t"+g);d.push("r"+g);f.push("t"+g);f.push("r"+
g+".join()");l.push("array"+g+".data");l.push("array"+g+".stride");l.push("array"+g+".offset|0");0<v&&(q.push("array"+c.arrayArgs[0]+".shape.length===array"+g+".shape.length+"+(Math.abs(c.arrayBlockIndices[0])-Math.abs(c.arrayBlockIndices[v]))),x.push("array"+c.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,c.arrayBlockIndices[0])+"]===array"+g+".shape[shapeIndex+"+Math.max(0,c.arrayBlockIndices[v])+"]"))}1<c.arrayArgs.length&&(b.push("if (!("+q.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),
b.push("for(var shapeIndex=array"+c.arrayArgs[0]+".shape.length-"+Math.abs(c.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),b.push("if (!("+x.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),b.push("}"));for(v=0;v<c.scalarArgs.length;++v)l.push("scalar"+c.scalarArgs[v]);e.push(["type=[",f.join(","),"].join()"].join(""));e.push("proc=CACHED[type]");b.push("var "+e.join(","));b.push(["if(!proc){CACHED[type]=proc=compile([",d.join(","),"])}return proc(",l.join(","),
")}"].join(""));c.debug&&console.log("-----Generated thunk:\n"+b.join("\n")+"\n----------");return(new Function("compile",b.join("\n")))(a.bind(void 0,c))}},{"./compile.js":6}],8:[function(b,d,f){function a(c,b,e){var d=c[e]|0;if(0>=d)return[];var f=Array(d),l;if(e===c.length-1)for(l=0;l<d;++l)f[l]=b;else for(l=0;l<d;++l)f[l]=a(c,b,e+1);return f}d.exports=function(c,b){"undefined"===typeof b&&(b=0);switch(typeof c){case "number":if(0<c){var e=c|0,d=b,f,l;f=Array(e);for(l=0;l<e;++l)f[l]=d;return f}break;
case "object":if("number"===typeof c.length)return a(c,b,0)}return[]}},{}],9:[function(b,d,f){function a(a){if(0>a)return Number("0/0");for(var c=h[0],b=h.length-1;0<b;--b)c+=h[b]/(a+b);b=a+4.7421875+.5;return.5*Math.log(2*Math.PI)+(a+.5)*Math.log(b)-b+Math.log(c)-Math.log(a)}var c=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9.984369578019572E-6,1.5056327351493116E-7],h=[.9999999999999971,57.15623566586292,-59.59796035547549,
14.136097974741746,-.4919138160976202,3.399464998481189E-5,4.652362892704858E-5,-9.837447530487956E-5,1.580887032249125E-4,-2.1026444172410488E-4,2.1743961811521265E-4,-1.643181065367639E-4,8.441822398385275E-5,-2.6190838401581408E-5,3.6899182659531625E-6];d.exports=function E(b){if(.5>b)return Math.PI/(Math.sin(Math.PI*b)*E(1-b));if(100<b)return Math.exp(a(b));--b;for(var d=c[0],h=1;9>h;h++)d+=c[h]/(b+h);h=b+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(h,b+.5)*Math.exp(-h)*d};d.exports.log=a},{}],10:[function(b,
d,f){d.exports=function(a,c){var b=c[0],e=c[1],d=c[2],f=c[3],l=c[4],q=c[5],x=c[6],v=c[7],g=c[8];a[0]=l*g-q*v;a[1]=d*v-e*g;a[2]=e*q-d*l;a[3]=q*x-f*g;a[4]=b*g-d*x;a[5]=d*f-b*q;a[6]=f*v-l*x;a[7]=e*x-b*v;a[8]=b*l-e*f;return a}},{}],11:[function(b,d,f){d.exports=function(a){var c=new Float32Array(9);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c}},{}],12:[function(b,d,f){d.exports=function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];
a[6]=c[6];a[7]=c[7];a[8]=c[8];return a}},{}],13:[function(b,d,f){d.exports=function(){var a=new Float32Array(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a}},{}],14:[function(b,d,f){d.exports=function(a){var c=a[3],b=a[4],e=a[5],d=a[6],f=a[7],l=a[8];return a[0]*(l*b-e*f)+a[1]*(e*d-l*c)+a[2]*(f*c-b*d)}},{}],15:[function(b,d,f){d.exports=function(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]+a[3]*a[3]+a[4]*a[4]+a[5]*a[5]+a[6]*a[6]+a[7]*a[7]+a[8]*a[8])}},{}],16:[function(b,
d,f){d.exports=function(a,c){a[0]=c[0];a[1]=c[1];a[2]=0;a[3]=c[2];a[4]=c[3];a[5]=0;a[6]=c[4];a[7]=c[5];a[8]=1;return a}},{}],17:[function(b,d,f){d.exports=function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[4];a[4]=c[5];a[5]=c[6];a[6]=c[8];a[7]=c[9];a[8]=c[10];return a}},{}],18:[function(b,d,f){d.exports=function(a,c){var b=c[0],e=c[1],d=c[2],f=c[3],l=b+b,q=e+e,x=d+d,b=b*l,v=e*l,e=e*q,g=d*l,r=d*q,d=d*x,l=f*l,q=f*q,f=f*x;a[0]=1-e-d;a[3]=v-f;a[6]=g+q;a[1]=v+f;a[4]=1-b-d;a[7]=r-l;a[2]=g-q;a[5]=r+l;a[8]=
1-b-e;return a}},{}],19:[function(b,d,f){d.exports=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a}},{}],20:[function(b,d,f){d.exports={adjoint:b("./adjoint"),clone:b("./clone"),copy:b("./copy"),create:b("./create"),determinant:b("./determinant"),frob:b("./frob"),fromMat2:b("./from-mat2"),fromMat4:b("./from-mat4"),fromQuat:b("./from-quat"),identity:b("./identity"),invert:b("./invert"),multiply:b("./multiply"),normalFromMat4:b("./normal-from-mat4"),rotate:b("./rotate"),
scale:b("./scale"),str:b("./str"),translate:b("./translate"),transpose:b("./transpose")}},{"./adjoint":10,"./clone":11,"./copy":12,"./create":13,"./determinant":14,"./frob":15,"./from-mat2":16,"./from-mat4":17,"./from-quat":18,"./identity":19,"./invert":21,"./multiply":22,"./normal-from-mat4":23,"./rotate":24,"./scale":25,"./str":26,"./translate":27,"./transpose":28}],21:[function(b,d,f){d.exports=function(a,c){var b=c[0],d=c[1],f=c[2],k=c[3],l=c[4],q=c[5],x=c[6],v=c[7],g=c[8],r=g*l-q*v,u=-g*k+q*
x,y=v*k-l*x,p=b*r+d*u+f*y;if(!p)return null;p=1/p;a[0]=r*p;a[1]=(-g*d+f*v)*p;a[2]=(q*d-f*l)*p;a[3]=u*p;a[4]=(g*b-f*x)*p;a[5]=(-q*b+f*k)*p;a[6]=y*p;a[7]=(-v*b+d*x)*p;a[8]=(l*b-d*k)*p;return a}},{}],22:[function(b,d,f){d.exports=function(a,c,b){var d=c[0],f=c[1],k=c[2],l=c[3],q=c[4],x=c[5],v=c[6],g=c[7];c=c[8];var r=b[0],u=b[1],y=b[2],p=b[3],A=b[4],z=b[5],B=b[6],F=b[7];b=b[8];a[0]=r*d+u*l+y*v;a[1]=r*f+u*q+y*g;a[2]=r*k+u*x+y*c;a[3]=p*d+A*l+z*v;a[4]=p*f+A*q+z*g;a[5]=p*k+A*x+z*c;a[6]=B*d+F*l+b*v;a[7]=
B*f+F*q+b*g;a[8]=B*k+F*x+b*c;return a}},{}],23:[function(b,d,f){d.exports=function(a,c){var b=c[0],d=c[1],f=c[2],k=c[3],l=c[4],q=c[5],x=c[6],v=c[7],g=c[8],r=c[9],u=c[10],y=c[11],p=c[12],A=c[13],z=c[14],B=c[15],F=b*q-d*l,D=b*x-f*l,w=b*v-k*l,C=d*x-f*q,H=d*v-k*q,N=f*v-k*x,P=g*A-r*p,G=g*z-u*p,g=g*B-y*p,J=r*z-u*A,r=r*B-y*A,u=u*B-y*z,y=F*u-D*r+w*J+C*g-H*G+N*P;if(!y)return null;y=1/y;a[0]=(q*u-x*r+v*J)*y;a[1]=(x*g-l*u-v*G)*y;a[2]=(l*r-q*g+v*P)*y;a[3]=(f*r-d*u-k*J)*y;a[4]=(b*u-f*g+k*G)*y;a[5]=(d*g-b*r-k*
P)*y;a[6]=(A*N-z*H+B*C)*y;a[7]=(z*w-p*N-B*D)*y;a[8]=(p*H-A*w+B*F)*y;return a}},{}],24:[function(b,d,f){d.exports=function(a,c,b){var d=c[0],f=c[1],k=c[2],l=c[3],q=c[4],x=c[5],v=c[6],g=c[7];c=c[8];var r=Math.sin(b);b=Math.cos(b);a[0]=b*d+r*l;a[1]=b*f+r*q;a[2]=b*k+r*x;a[3]=b*l-r*d;a[4]=b*q-r*f;a[5]=b*x-r*k;a[6]=v;a[7]=g;a[8]=c;return a}},{}],25:[function(b,d,f){d.exports=function(a,c,b){var d=b[0];b=b[1];a[0]=d*c[0];a[1]=d*c[1];a[2]=d*c[2];a[3]=b*c[3];a[4]=b*c[4];a[5]=b*c[5];a[6]=c[6];a[7]=c[7];a[8]=
c[8];return a}},{}],26:[function(b,d,f){d.exports=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"}},{}],27:[function(b,d,f){d.exports=function(a,c,b){var d=c[0],f=c[1],k=c[2],l=c[3],q=c[4],x=c[5],v=c[6],g=c[7];c=c[8];var r=b[0];b=b[1];a[0]=d;a[1]=f;a[2]=k;a[3]=l;a[4]=q;a[5]=x;a[6]=r*d+b*l+v;a[7]=r*f+b*q+g;a[8]=r*k+b*x+c;return a}},{}],28:[function(b,d,f){d.exports=function(a,c){if(a===c){var b=c[1],d=c[2],f=c[5];a[1]=c[3];a[2]=c[6];
a[3]=b;a[5]=c[7];a[6]=d;a[7]=f}else a[0]=c[0],a[1]=c[3],a[2]=c[6],a[3]=c[1],a[4]=c[4],a[5]=c[7],a[6]=c[2],a[7]=c[5],a[8]=c[8];return a}},{}],29:[function(b,d,f){d.exports=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],30:[function(b,d,f){var a=b("./identity");d.exports=function(c,b,d,f){var k,l,q,x,v,g,r,u,y=b[0],p=b[1];b=b[2];q=f[0];x=f[1];l=f[2];r=d[0];f=d[1];k=d[2];if(1E-6>Math.abs(y-r)&&1E-6>Math.abs(p-
f)&&1E-6>Math.abs(b-k))return a(c);d=y-r;f=p-f;r=b-k;u=1/Math.sqrt(d*d+f*f+r*r);d*=u;f*=u;r*=u;k=x*r-l*f;l=l*d-q*r;q=q*f-x*d;(u=Math.sqrt(k*k+l*l+q*q))?(u=1/u,k*=u,l*=u,q*=u):q=l=k=0;x=f*q-r*l;v=r*k-d*q;g=d*l-f*k;(u=Math.sqrt(x*x+v*v+g*g))?(u=1/u,x*=u,v*=u,g*=u):g=v=x=0;c[0]=k;c[1]=x;c[2]=d;c[3]=0;c[4]=l;c[5]=v;c[6]=f;c[7]=0;c[8]=q;c[9]=g;c[10]=r;c[11]=0;c[12]=-(k*y+l*p+q*b);c[13]=-(x*y+v*p+g*b);c[14]=-(d*y+f*p+r*b);c[15]=1;return c}},{"./identity":29}],31:[function(b,d,f){d.exports=function(a,c,
b,d,f){c=1/Math.tan(c/2);var k=1/(d-f);a[0]=c/b;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(f+d)*k;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*f*d*k;a[15]=0;return a}},{}],32:[function(b,d,f){f.read=function(a,c,b,d,f){var k;k=8*f-d-1;var l=(1<<k)-1,q=l>>1,x=-7;f=b?f-1:0;var v=b?-1:1,g=a[c+f];f+=v;b=g&(1<<-x)-1;g>>=-x;for(x+=k;0<x;b=256*b+a[c+f],f+=v,x-=8);k=b&(1<<-x)-1;b>>=-x;for(x+=d;0<x;k=256*k+a[c+f],f+=v,x-=8);if(0===b)b=1-q;else{if(b===l)return k?NaN:Infinity*(g?-1:1);k+=Math.pow(2,
d);b-=q}return(g?-1:1)*k*Math.pow(2,b-d)};f.write=function(a,c,b,d,f,k){var l,q=8*k-f-1,x=(1<<q)-1,v=x>>1,g=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;k=d?0:k-1;var r=d?1:-1,u=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,d=x):(d=Math.floor(Math.log(c)/Math.LN2),1>c*(l=Math.pow(2,-d))&&(d--,l*=2),c=1<=d+v?c+g/l:c+g*Math.pow(2,1-v),2<=c*l&&(d++,l/=2),d+v>=x?(c=0,d=x):1<=d+v?(c=(c*l-1)*Math.pow(2,f),d+=v):(c=c*Math.pow(2,v-1)*Math.pow(2,f),d=0));for(;8<=f;a[b+k]=c&255,k+=
r,c/=256,f-=8);d=d<<f|c;for(q+=f;0<q;a[b+k]=d&255,k+=r,d/=256,q-=8);a[b+k-r]|=128*u}},{}],33:[function(b,d,f){d.exports=function(a,c){c=c||Array(a.length);for(var b=0;b<a.length;++b)c[a[b]]=b;return c}},{}],34:[function(b,d,f){d.exports=function(a){for(var c=Array(a),b=0;b<a;++b)c[b]=b;return c}},{}],35:[function(b,d,f){function a(a){return!!a.constructor&&"function"===typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)}d.exports=function(b){return null!=b&&(a(b)||"function"===typeof b.readFloatLE&&
"function"===typeof b.slice&&a(b.slice(0,0))||!!b._isBuffer)}},{}],36:[function(b,d,f){var a={}.toString;d.exports=Array.isArray||function(b){return"[object Array]"==a.call(b)}},{}],37:[function(b,d,f){d.exports=function(b,d){function e(a){var b=!1;"altKey"in a&&(b=b||a.altKey!==A.alt,A.alt=!!a.altKey);"shiftKey"in a&&(b=b||a.shiftKey!==A.shift,A.shift=!!a.shiftKey);"ctrlKey"in a&&(b=b||a.ctrlKey!==A.control,A.control=!!a.ctrlKey);"metaKey"in a&&(b=b||a.metaKey!==A.meta,A.meta=!!a.metaKey);return b}
function f(b,c){var g=a.x(c),k=a.y(c);"buttons"in c&&(b=c.buttons|0);if(b!==u||g!==y||k!==p||e(c))u=b|0,y=g||0,p=k||0,d&&d(u,y,p,A)}function k(a){f(0,a)}function l(){if(u||y||p||A.shift||A.alt||A.meta||A.control)u=y=p=0,A.shift=A.alt=A.control=A.meta=!1,d&&d(0,0,0,A)}function q(a){e(a)&&d&&d(u,y,p,A)}function x(b){0===a.buttons(b)?f(0,b):f(u,b)}function v(b){f(u|a.buttons(b),b)}function g(b){f(u&~a.buttons(b),b)}function r(){z||(z=!0,b.addEventListener("mousemove",x),b.addEventListener("mousedown",
v),b.addEventListener("mouseup",g),b.addEventListener("mouseleave",k),b.addEventListener("mouseenter",k),b.addEventListener("mouseout",k),b.addEventListener("mouseover",k),b.addEventListener("blur",l),b.addEventListener("keyup",q),b.addEventListener("keydown",q),b.addEventListener("keypress",q),b!==window&&(window.addEventListener("blur",l),window.addEventListener("keyup",q),window.addEventListener("keydown",q),window.addEventListener("keypress",q)))}d||(d=b,b=window);var u=0,y=0,p=0,A={shift:!1,
alt:!1,control:!1,meta:!1},z=!1;r();var B={element:b};Object.defineProperties(B,{enabled:{get:function(){return z},set:function(a){a?r():z&&(z=!1,b.removeEventListener("mousemove",x),b.removeEventListener("mousedown",v),b.removeEventListener("mouseup",g),b.removeEventListener("mouseleave",k),b.removeEventListener("mouseenter",k),b.removeEventListener("mouseout",k),b.removeEventListener("mouseover",k),b.removeEventListener("blur",l),b.removeEventListener("keyup",q),b.removeEventListener("keydown",
q),b.removeEventListener("keypress",q),b!==window&&(window.removeEventListener("blur",l),window.removeEventListener("keyup",q),window.removeEventListener("keydown",q),window.removeEventListener("keypress",q)))},enumerable:!0},buttons:{get:function(){return u},enumerable:!0},x:{get:function(){return y},enumerable:!0},y:{get:function(){return p},enumerable:!0},mods:{get:function(){return A},enumerable:!0}});return B};var a=b("mouse-event")},{"mouse-event":38}],38:[function(b,d,f){function a(a){return a.target||
a.srcElement||window}f.buttons=function(a){if("object"===typeof a){if("buttons"in a)return a.buttons;if("which"in a){a=a.which;if(2===a)return 4;if(3===a)return 2;if(0<a)return 1<<a-1}else if("button"in a){a=a.button;if(1===a)return 4;if(2===a)return 2;if(0<=a)return 1<<a}}return 0};f.element=a;f.x=function(b){if("object"===typeof b){if("offsetX"in b)return b.offsetX;var d=a(b).getBoundingClientRect();return b.clientX-d.left}return 0};f.y=function(b){if("object"===typeof b){if("offsetY"in b)return b.offsetY;
var d=a(b).getBoundingClientRect();return b.clientY-d.top}return 0}},{}],39:[function(b,d,f){var a=b("to-px");d.exports=function(b,d,e){"function"===typeof b&&(e=!!d,d=b,b=window);var f=a("ex",b),k=function(a){e&&a.preventDefault();var b=a.deltaX||0,c=a.deltaY||0,k=a.deltaZ||0,g=1;switch(a.deltaMode){case 1:g=f;break;case 2:g=window.innerHeight}b*=g;c*=g;k*=g;if(b||c||k)return d(b,c,k,a)};b.addEventListener("wheel",k);return k}},{"to-px":48}],40:[function(b,d,f){function a(a,b,c){for(var d=0,e=0;e<
a;++e)b&1<<e&&(d|=1<<c[e]);return d}function c(b,c,d,f,y,p){function A(a,b){H.push("for(","i"+y[a],"=",b,";","i"+y[a],"<","s"+y[a],";","++","i"+y[a],"){")}function z(a){for(var b=0;b<D;++b)H.push("p"+b,"+=","u"+b+"_"+y[a],";");H.push("}")}function B(){for(var a=1;a<1<<w;++a)H.push(x,"=","e"+a,";","e"+a,"=","y"+a,";","y"+a,"=",x,";")}function F(a,b){if(0>a){for(var c=0;c<D;++c)p[c]?H.push("c"+c+"_0","=","d"+c,".get(","p"+c,");"):H.push("c"+c+"_0","=","d"+c,"[","p"+c,"];");for(var d=[],c=0;c<D;++c)d.push("c"+
c+"_0");for(c=0;c<f;++c)d.push("x"+c);H.push("b0","=",E,"[",q,"]=phase(",d.join(),");");for(d=1;d<1<<w;++d)H.push("b"+d,"=",E,"[",q,"+","e"+d,"];");c=[];for(d=1;d<1<<w;++d)c.push("(b0!==b"+d+")");H.push("if(",c.join("||"),"){");for(var g=[],c=0;c<w;++c)g.push("i"+c);for(c=0;c<D;++c)for(g.push("c"+c+"_0"),d=1;d<1<<w;++d)p[c]?H.push("c"+c+"_"+d,"=","d"+c,".get(","p"+c,"+","d"+c+"_"+d,");"):H.push("c"+c+"_"+d,"=","d"+c,"[","p"+c,"+","d"+c+"_"+d,"];"),g.push("c"+c+"_"+d);for(c=0;c<1<<w;++c)g.push("b"+
c);for(c=0;c<f;++c)g.push("x"+c);H.push("vertex(",g.join(),");","v0","=",e,"[",q,"]=",k,"++;");c=(1<<w)-1;g="b"+c;for(d=0;d<w;++d)if(0===(b&~(1<<d))){for(var h=c^1<<d,l="b"+h,v=[],r=h;0<r;r=r-1&h)v.push(e+"["+q+"+"+("e"+r)+"]");v.push("v0");for(r=0;r<D;++r)d&1?v.push("c"+r+"_"+c,"c"+r+"_"+h):v.push("c"+r+"_"+h,"c"+r+"_"+c);d&1?v.push(g,l):v.push(l,g);for(r=0;r<f;++r)v.push("x"+r);H.push("if(",g,"!==",l,"){","face(",v.join(),")}")}H.push("}",q,"+=1;")}else{for(d=a-1;0<=d;--d)A(d,0);c=[];for(d=0;d<
D;++d)p[d]?c.push("d"+d+".get("+("p"+d)+")"):c.push("d"+d+"["+("p"+d)+"]");for(d=0;d<f;++d)c.push("x"+d);H.push(E,"[",q,"++]=phase(",c.join(),");");for(d=0;d<a;++d)z(d);for(d=0;d<D;++d)H.push("p"+d,"+=","u"+d+"_"+y[a],";");H.push("if(","s"+y[a],">0){","i"+y[a],"=1;");F(a-1,b|1<<y[a]);for(d=0;d<D;++d)H.push("p"+d,"+=","u"+d+"_"+y[a],";");a===w-1&&(H.push(q,"=0;"),B());A(a,2);F(a-1,b);a===w-1&&(H.push("if(","i"+y[w-1],"&1){",q,"=0;}"),B());z(a);H.push("}")}}var D=p.length,w=y.length;if(2>w)throw Error("ndarray-extract-contour: Dimension must be at least 2");
for(var C="extractContour"+y.join("_"),H=[],N=[],P=[],G=0;G<D;++G)P.push("a"+G);for(G=0;G<f;++G)P.push("x"+G);for(G=0;G<w;++G)N.push("s"+G+"=a0.shape["+G+"]|0");for(G=0;G<D;++G){N.push("d"+G+"="+("a"+G)+".data","o"+G+"="+("a"+G)+".offset|0");for(var J=0;J<w;++J)N.push("t"+G+"_"+J+"="+("a"+G)+".stride["+J+"]|0")}for(G=0;G<D;++G)for(N.push("p"+G+"="+("o"+G)),N.push("c"+G+"_0"),J=1;J<1<<w;++J){for(var W=[],K=0;K<w;++K)J&1<<K&&W.push("-"+("t"+G+"_"+K));N.push("d"+G+"_"+J+"=("+W.join("")+")|0");N.push("c"+
G+"_"+J+"=0")}for(G=0;G<D;++G)for(J=0;J<w;++J)K=["t"+G+"_"+y[J]],0<J&&K.push("t"+G+"_"+y[J-1]+"*"+("s"+y[J-1])),N.push("u"+G+"_"+y[J]+"=("+K.join("-")+")|0");for(G=0;G<w;++G)N.push("i"+G+"=0");N.push(k+"=0");J=["2"];for(G=w-2;0<=G;--G)J.push("s"+y[G]);N.push(l+"=("+J.join("*")+")|0",E+"=mallocUint32("+l+")",e+"=mallocUint32("+l+")",q+"=0");N.push("b0=0");for(J=1;J<1<<w;++J){G=[];W=[];for(K=0;K<w;++K)J&1<<K&&(0===W.length?G.push("1"):G.unshift(W.join("*"))),W.push("s"+y[K]);K="";0>G[0].indexOf("s"+
y[w-2])&&(K="-");W=a(w,J,y);N.push("e"+W+"=(-"+G.join("-")+")|0","y"+W+"=("+K+G.join("-")+")|0","b"+W+"=0")}N.push("v0=0",x+"=0");F(w-1,0);H.push("freeUint32(",e,");freeUint32(",E,");");C=["'use strict';function ",C,"(",P.join(),"){var ",N.join(),";",H.join(""),"}return ",C].join("");return(new Function("vertex","face","phase","mallocUint32","freeUint32",C))(b,c,d,h.mallocUint32,h.freeUint32)}var h=b("typedarray-pool");d.exports=function(a){function b(a){throw Error("ndarray-extract-contour: "+a);
}"object"!==typeof a&&b("Must specify arguments");var d=a.order;Array.isArray(d)||b("Must specify order");var e=a.arrayArguments||1;1>e&&b("Must have at least one array argument");var f=a.scalarArguments||0;0>f&&b("Scalar arg count must be > 0");"function"!==typeof a.vertex&&b("Must specify vertex creation function");"function"!==typeof a.cell&&b("Must specify cell creation function");"function"!==typeof a.phase&&b("Must specify phase function");for(var h=a.getters||[],k=Array(e),l=0;l<e;++l)0<=h.indexOf(l)?
k[l]=!0:k[l]=!1;return c(a.vertex,a.cell,a.phase,f,d,k)};var e="V",E="P",k="N",l="Q",q="X",x="T"},{"typedarray-pool":50}],41:[function(b,d,f){function a(a,b){return a[0]-b[0]}function c(){var b=this.stride,c=Array(b.length),d;for(d=0;d<c.length;++d)c[d]=[Math.abs(b[d]),d];c.sort(a);b=Array(c.length);for(d=0;d<b.length;++d)b[d]=c[d][1];return b}function h(a,b){var d=["View",b,"d",a].join("");0>b&&(d="View_Nil"+a);var e="generic"===a;if(-1===b){var f,d=new Function("function "+d+"(a){this.data=a;};var proto="+
d+".prototype;proto.dtype='"+a+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+d+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+d+"(a){return new "+d+"(a);}");return d()}if(0===b)return d=new Function("TrivialArray","function "+d+"(a,d) {this.data = a;this.offset = d};var proto="+d+".prototype;proto.dtype='"+
a+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+d+"_copy() {return new "+d+"(this.data,this.offset)};proto.pick=function "+d+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+d+"_get(){return "+(e?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+d+"_set(v){return "+(e?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+
"};return function construct_"+d+"(a,b,c,d){return new "+d+"(a,d)}"),d(q[a][0]);f=["'use strict'"];var h=E(b),k=h.map(function(a){return"i"+a}),l="this.offset+"+h.map(function(a){return"this.stride["+a+"]*i"+a}).join("+"),z=h.map(function(a){return"b"+a}).join(","),B=h.map(function(a){return"c"+a}).join(",");f.push("function "+d+"(a,"+z+","+B+",d){this.data=a","this.shape=["+z+"]","this.stride=["+B+"]","this.offset=d|0}","var proto="+d+".prototype","proto.dtype='"+a+"'","proto.dimension="+b);f.push("Object.defineProperty(proto,'size',{get:function "+
d+"_size(){return "+h.map(function(a){return"this.shape["+a+"]"}).join("*"),"}})");1===b?f.push("proto.order=[0]"):(f.push("Object.defineProperty(proto,'order',{get:"),4>b?(f.push("function "+d+"_order(){"),2===b?f.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===b&&f.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):
f.push("ORDER})"));f.push("proto.set=function "+d+"_set("+k.join(",")+",v){");e?f.push("return this.data.set("+l+",v)}"):f.push("return this.data["+l+"]=v}");f.push("proto.get=function "+d+"_get("+k.join(",")+"){");e?f.push("return this.data.get("+l+")}"):f.push("return this.data["+l+"]}");f.push("proto.index=function "+d+"_index(",k.join(),"){return "+l+"}");f.push("proto.hi=function "+d+"_hi("+k.join(",")+"){return new "+d+"(this.data,"+h.map(function(a){return["(typeof i",a,"!=='number'||i",a,
"<0)?this.shape[",a,"]:i",a,"|0"].join("")}).join(",")+","+h.map(function(a){return"this.stride["+a+"]"}).join(",")+",this.offset)}");e=h.map(function(a){return"a"+a+"=this.shape["+a+"]"});l=h.map(function(a){return"c"+a+"=this.stride["+a+"]"});f.push("proto.lo=function "+d+"_lo("+k.join(",")+"){var b=this.offset,d=0,"+e.join(",")+","+l.join(","));for(e=0;e<b;++e)f.push("if(typeof i"+e+"==='number'&&i"+e+">=0){d=i"+e+"|0;b+=c"+e+"*d;a"+e+"-=d}");f.push("return new "+d+"(this.data,"+h.map(function(a){return"a"+
a}).join(",")+","+h.map(function(a){return"c"+a}).join(",")+",b)}");f.push("proto.step=function "+d+"_step("+k.join(",")+"){var "+h.map(function(a){return"a"+a+"=this.shape["+a+"]"}).join(",")+","+h.map(function(a){return"b"+a+"=this.stride["+a+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(e=0;e<b;++e)f.push("if(typeof i"+e+"==='number'){d=i"+e+"|0;if(d<0){c+=b"+e+"*(a"+e+"-1);a"+e+"=ceil(-a"+e+"/d)}else{a"+e+"=ceil(a"+e+"/d)}b"+e+"*=d}");f.push("return new "+d+"(this.data,"+h.map(function(a){return"a"+
a}).join(",")+","+h.map(function(a){return"b"+a}).join(",")+",c)}");l=Array(b);z=Array(b);for(e=0;e<b;++e)l[e]="a[i"+e+"]",z[e]="b[i"+e+"]";f.push("proto.transpose=function "+d+"_transpose("+k+"){"+k.map(function(a,b){return a+"=("+a+"===undefined?"+b+":"+a+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+d+"(this.data,"+l.join(",")+","+z.join(",")+",this.offset)}");f.push("proto.pick=function "+d+"_pick("+k+"){var a=[],b=[],c=this.offset");for(e=0;e<b;++e)f.push("if(typeof i"+e+"==='number'&&i"+
e+">=0){c=(c+this.stride["+e+"]*i"+e+")|0}else{a.push(this.shape["+e+"]);b.push(this.stride["+e+"])}");f.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}");f.push("return function construct_"+d+"(data,shape,stride,offset){return new "+d+"(data,"+h.map(function(a){return"shape["+a+"]"}).join(",")+","+h.map(function(a){return"stride["+a+"]"}).join(",")+",offset)}");d=new Function("CTOR_LIST","ORDER",f.join("\n"));return d(q[a],c)}function e(a){if(k(a))return"buffer";if(l)switch(Object.prototype.toString.call(a)){case "[object Float64Array]":return"float64";
case "[object Float32Array]":return"float32";case "[object Int8Array]":return"int8";case "[object Int16Array]":return"int16";case "[object Int32Array]":return"int32";case "[object Uint8Array]":return"uint8";case "[object Uint16Array]":return"uint16";case "[object Uint32Array]":return"uint32";case "[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(a)?"array":"generic"}var E=b("iota-array"),k=b("is-buffer"),l="undefined"!==typeof Float64Array,q={float32:[],float64:[],int8:[],int16:[],
int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};(function(){for(var a in q)q[a].push(h(a,-1))});d.exports=function(a,b,c,d){if(void 0===a){var f=q.array[0];return f([])}"number"===typeof a&&(a=[a]);void 0===b&&(b=[a.length]);f=b.length;if(void 0===c){c=Array(f);for(var k=f-1,l=1;0<=k;--k)c[k]=l,l*=b[k]}if(void 0===d)for(k=d=0;k<f;++k)0>c[k]&&(d-=(b[k]-1)*c[k]);k=e(a);for(l=q[k];l.length<=f+1;)l.push(h(k,l.length-1));f=l[f+1];return f(a,b,c,d)}},{"iota-array":34,
"is-buffer":35}],42:[function(b,d,f){d.exports=function(a,b){b||(b=[0,""]);a=String(a);var d=parseFloat(a,10);b[0]=d;b[1]=a.match(/[\d.\-\+]*\s*(.*)/)[1]||"";return b}},{}],43:[function(b,d,f){d.exports=function(b){var d=b.length;if(d<a)for(var f=1,k=0;k<d;++k)for(var l=0;l<k;++l)if(b[k]<b[l])f=-f;else{if(b[k]===b[l])return 0}else{for(var q=c.mallocUint8(d),k=0;k<d;++k)q[k]=0;f=1;for(k=0;k<d;++k)if(!q[k]){var x=1;q[k]=1;for(l=b[k];l!==k;l=b[l]){if(q[l])return c.freeUint8(q),0;x+=1;q[l]=1}x&1||(f=
-f)}c.freeUint8(q)}return f};var a=32,c=b("typedarray-pool")},{"typedarray-pool":50}],44:[function(b,d,f){var a=b("typedarray-pool"),c=b("invert-permutation");f.rank=function(b){var d=b.length;switch(d){case 0:case 1:return 0;case 2:return b[1]}var f=a.mallocUint32(d),k=a.mallocUint32(d),l=0,q;c(b,k);for(q=0;q<d;++q)f[q]=b[q];for(q=d-1;0<q;--q)d=k[q],b=f[q],f[q]=f[d],f[d]=b,k[q]=k[b],k[b]=d,l=(l+b)*q;a.freeUint32(k);a.freeUint32(f);return l};f.unrank=function(a,b,c){switch(a){case 0:return c?c:[];
case 1:return c?(c[0]=0,c):[0];case 2:return c?(b?(c[0]=0,c[1]=1):(c[0]=1,c[1]=0),c):b?[0,1]:[1,0]}c=c||Array(a);var d,f,q=1;c[0]=0;for(f=1;f<a;++f)c[f]=f,q=q*f|0;for(f=a-1;0<f;--f)a=b/q|0,b=b-a*q|0,q=q/f|0,d=c[f]|0,c[f]=c[a]|0,c[a]=d|0;return c}},{"invert-permutation":33,"typedarray-pool":50}],45:[function(b,d,f){(function(a,b){"object"===typeof f&&"undefined"!==typeof d?d.exports=b():"function"===typeof define&&define.amd?define(b):a.createREGL=b()})(this,function(){function a(a){return"undefined"!==
typeof btoa?btoa(a):"base64:"+a}function b(a){a=Error("(regl) "+a);console.error(a);throw a;}function d(a,e){a||b(e)}function e(a){return a?": "+a:""}function f(a,d,n){0>d.indexOf(a)&&b("invalid value"+e(n)+". must be one of: "+d)}function k(a,b){for(a+="";a.length<b;)a=" "+a;return a}function l(){this.name="unknown";this.lines=[];this.index={};this.hasErrors=!1}function q(a,b){this.number=a;this.line=b;this.errors=[]}function x(a,b,c){this.file=a;this.line=b;this.message=c}function v(){var a=Error(),
a=(a.stack||a).toString(),b=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(a);return b?b[1]:(a=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(a))?a[1]:"unknown"}function g(){var a=Error(),a=(a.stack||a).toString(),b=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(a);return b?b[1]:(a=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(a))?a[1]:"unknown"}function r(b,c){var d=b.split("\n"),e=1,f=0,n={unknown:new l,0:new l};n.unknown.name=n[0].name=c||v();n.unknown.lines.push(new q(0,""));for(var h=0;h<d.length;++h){var k=
d[h],g=/^\s*\#\s*(\w+)\s+(.+)\s*$/.exec(k);if(g)switch(g[1]){case "line":if(g=/(\d+)(\s+\d+)?/.exec(g[2]))e=g[1]|0,g[2]&&(f=g[2]|0,f in n||(n[f]=new l));break;case "define":if(g=/SHADER_NAME(_B64)?\s+(.*)$/.exec(g[2]))n[f].name=g[1]?a(g[2]):g[2]}n[f].lines.push(new q(e++,k))}Object.keys(n).forEach(function(a){var b=n[a];b.lines.forEach(function(a){b.index[a.number]=a})});return n}function u(a){var b=[];a.split("\n").forEach(function(a){if(!(5>a.length)){var c=/^ERROR\:\s+(\d+)\:(\d+)\:\s*(.*)$/.exec(a);
c?b.push(new x(c[1]|0,c[2]|0,c[3].trim())):0<a.length&&b.push(new x("unknown",0,a))}});return b}function y(a,b){b.forEach(function(b){var c=a[b.file];if(c){var d=c.index[b.line];if(d){d.errors.push(b);c.hasErrors=!0;return}}a.unknown.hasErrors=!0;a.unknown.lines[0].errors.push(b)})}function p(a){a._commandRef=v()}function A(a,d){var f=g();b(a+" in command "+(d||v())+("unknown"===f?"":" called from "+f))}function z(a,b,c,d){typeof a!==b&&A("invalid parameter type"+e(c)+". expected "+b+", got "+typeof a,
d||v())}function B(a,b){return 32820===a||32819===a||33635===a?2:34042===a?4:ba[a]*b}function F(a,b){this.id=Cb++;this.type=a;this.data=b}function D(a){if(0===a.length)return[];var b=a.charAt(0),c=a.charAt(a.length-1);if(1<a.length&&b===c&&('"'===b||"'"===b))return['"'+a.substr(1,a.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(b=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return D(a.substr(0,b.index)).concat(D(b[1])).concat(D(a.substr(b.index+b[0].length)));b=a.split(".");if(1===
b.length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];a=[];for(c=0;c<b.length;++c)a=a.concat(D(b[c]));return a}function w(a){return"["+D(a).join("][")+"]"}function C(){var a={"":0},b=[""];return{id:function(c){var d=a[c];if(d)return d;d=a[c]=b.length;b.push(c);return d},str:function(a){return b[a]}}}function H(a,b,c){function d(){var b=window.innerWidth,e=window.innerHeight;a!==document.body&&(e=a.getBoundingClientRect(),b=e.right-e.left,e=e.bottom-e.top);f.width=c*b;f.height=c*e;S(f.style,
{width:b+"px",height:e+"px"})}var f=document.createElement("canvas");S(f.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(f);a===document.body&&(f.style.position="absolute",S(a.style,{margin:0,padding:0}));window.addEventListener("resize",d,!1);d();return{canvas:f,onDestroy:function(){window.removeEventListener("resize",d);a.removeChild(f)}}}function N(a,b){function c(d){try{return a.getContext(d,b)}catch(f){return null}}return c("webgl")||c("experimental-webgl")||c("webgl-experimental")}
function P(a){if("string"===typeof a)return a.split();n(Array.isArray(a),"invalid extension array");return a}function G(a){return"string"===typeof a?(n("undefined"!==typeof document,"not supported outside of DOM"),document.querySelector(a)):a}function J(a){var b=a||{},c,d,f,e;a={};var g=[],h=[],k="undefined"===typeof window?1:window.devicePixelRatio,l=!1,q=function(a){a&&n.raise(a)},p=function(){};"string"===typeof b?(n("undefined"!==typeof document,"selector queries only supported in DOM enviroments"),
c=document.querySelector(b),n(c,"invalid query string for element")):"object"===typeof b?"string"===typeof b.nodeName&&"function"===typeof b.appendChild&&"function"===typeof b.getBoundingClientRect?c=b:"function"===typeof b.drawArrays||"function"===typeof b.drawElements?(e=b,f=e.canvas):(n.constructor(b),"gl"in b?e=b.gl:"canvas"in b?f=G(b.canvas):"container"in b&&(d=G(b.container)),"attributes"in b&&(a=b.attributes,n.type(a,"object","invalid context attributes")),"extensions"in b&&(g=P(b.extensions)),
"optionalExtensions"in b&&(h=P(b.optionalExtensions)),"onDone"in b&&(n.type(b.onDone,"function","invalid or missing onDone callback"),q=b.onDone),"profile"in b&&(l=!!b.profile),"pixelRatio"in b&&(k=+b.pixelRatio,n(0<k,"invalid pixel ratio"))):n.raise("invalid arguments to regl");c&&("canvas"===c.nodeName.toLowerCase()?f=c:d=c);if(!e){if(!f){n("undefined"!==typeof document,"must manually specify webgl context outside of DOM environments");c=H(d||document.body,q,k);if(!c)return null;f=c.canvas;p=c.onDestroy}e=
N(f,a)}return e?{gl:e,canvas:f,container:d,extensions:g,optionalExtensions:h,pixelRatio:k,profile:l,onDone:q,onDestroy:p}:(p(),q("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function W(a,b){function c(b){n.type(b,"string","extension name must be string");b=b.toLowerCase();var f;try{f=d[b]=a.getExtension(b)}catch(e){}return!!f}for(var d={},f=0;f<b.extensions.length;++f){var e=b.extensions[f];if(!c(e))return b.onDestroy(),b.onDone('"'+e+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),
null}b.optionalExtensions.forEach(c);return{extensions:d,restore:function(){Object.keys(d).forEach(function(a){if(!c(a))throw Error("(regl): error restoring extension "+a);})}}}function K(a){return!!a&&"object"===typeof a&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&"number"===typeof a.offset&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||X(a.data))}function U(a,b){for(var c=Array(a),d=0;d<a;++d)c[d]=b(d);return c}function aa(a){var b,c;b=(65535<a)<<4;a>>>=b;c=(255<a)<<3;a>>>=c;b|=
c;c=(15<a)<<2;a>>>=c;b|=c;c=(3<a)<<1;return b|c|a>>>c>>1}function O(a){a:{for(var b=16;268435456>=b;b*=16)if(a<=b){a=b;break a}a=0}b=kb[aa(a)>>2];return 0<b.length?b.pop():new ArrayBuffer(a)}function ja(a){kb[aa(a.byteLength)>>2].push(a)}function ca(a,b,c,d,f,e){for(var n=0;n<b;++n)for(var g=a[n],h=0;h<c;++h)for(var k=g[h],l=0;l<d;++l)f[e++]=k[l]}function fb(a,b,c,d,f){for(var e=1,n=c+1;n<b.length;++n)e*=b[n];var g=b[c];if(4===b.length-c){var h=b[c+1],k=b[c+2];b=b[c+3];for(n=0;n<g;++n)ca(a[n],h,k,
b,d,f),f+=e}else for(n=0;n<g;++n)fb(a[n],b,c+1,d,f),f+=e}function Oa(a){return Ia[Object.prototype.toString.call(a)]|0}function gb(a,b){for(var c=0;c<b.length;++c)a[c]=b[c]}function hb(a,b,c,d,f,e,n){for(var g=0,h=0;h<c;++h)for(var k=0;k<d;++k)a[g++]=b[f*h+e*k+n]}function Ab(a,b,c){function d(b){this.id=h++;this.buffer=a.createBuffer();this.type=b;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;this.persistentData=null;c.profile&&(this.stats={size:0})}function f(b,c,d){b.byteLength=
c.byteLength;a.bufferData(b.type,c,d)}function e(a,b,c,d,t,g){a.usage=c;if(Array.isArray(b)){if(a.dtype=d||5126,0<b.length)if(Array.isArray(b[0])){t=lb(b);for(var h=d=1;h<t.length;++h)d*=t[h];a.dimension=d;b=Xa(b,t,a.dtype);f(a,b,c);g?a.persistentData=b:V.freeType(b)}else"number"===typeof b[0]?(a.dimension=t,t=V.allocType(a.dtype,b.length),gb(t,b),f(a,t,c),g?a.persistentData=t:V.freeType(t)):X(b[0])?(a.dimension=b[0].length,a.dtype=d||Oa(b[0])||5126,b=Xa(b,[b.length,b[0].length],a.dtype),f(a,b,c),
g?a.persistentData=b:V.freeType(b)):n.raise("invalid buffer data")}else if(X(b))a.dtype=d||Oa(b),a.dimension=t,f(a,b,c),g&&(a.persistentData=new Uint8Array(new Uint8Array(b.buffer)));else if(K(b)){t=b.shape;var k=b.stride,h=b.offset,l=0,L=0,q=0,p=0;1===t.length?(l=t[0],L=1,q=k[0],p=0):2===t.length?(l=t[0],L=t[1],q=k[0],p=k[1]):n.raise("invalid shape");a.dtype=d||Oa(b.data)||5126;a.dimension=L;t=V.allocType(a.dtype,l*L);hb(t,b.data,l,L,q,p,h);f(a,t,c);g?a.persistentData=t:V.freeType(t)}else n.raise("invalid buffer data")}
function g(c){b.bufferCount--;var d=c.buffer;n(d,"buffer must not be deleted already");a.deleteBuffer(d);c.buffer=null;delete k[c.id]}var h=0,k={};d.prototype.bind=function(){a.bindBuffer(this.type,this.buffer)};d.prototype.destroy=function(){g(this)};var l=[];c.profile&&(b.getTotalBufferSize=function(){var a=0;Object.keys(k).forEach(function(b){a+=k[b].stats.size});return a});return{create:function(f,h,l,q){function p(b){var d=35044,f=null,g=0,h=0,k=1;Array.isArray(b)||X(b)||K(b)?f=b:"number"===
typeof b?g=b|0:b&&(n.type(b,"object","buffer arguments must be an object, a number or an array"),"data"in b&&(n(null===f||Array.isArray(f)||X(f)||K(f),"invalid data for buffer"),f=b.data),"usage"in b&&(n.parameter(b.usage,Qa,"invalid buffer usage"),d=Qa[b.usage]),"type"in b&&(n.parameter(b.type,Ja,"invalid buffer type"),h=Ja[b.type]),"dimension"in b&&(n.type(b.dimension,"number","invalid dimension"),k=b.dimension|0),"length"in b&&(n.nni(g,"buffer length must be a nonnegative integer"),g=b.length|
0));C.bind();f?e(C,f,d,h,k,q):(a.bufferData(C.type,g,d),C.dtype=h||5121,C.usage=d,C.dimension=k,C.byteLength=g);c.profile&&(C.stats.size=C.byteLength*oa[C.dtype]);return p}function w(b,c){n(c+b.byteLength<=C.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+b.byteLength+" starting from offset "+c+" to a buffer of size "+C.byteLength);a.bufferSubData(C.type,c,b)}b.bufferCount++;var C=new d(h);k[C.id]=C;l||p(f);p._reglType="buffer";p._buffer=C;p.subdata=function(a,
b){var c=(b||0)|0,d;C.bind();if(Array.isArray(a)){if(0<a.length)if("number"===typeof a[0]){var f=V.allocType(C.dtype,a.length);gb(f,a);w(f,c);V.freeType(f)}else Array.isArray(a[0])||X(a[0])?(d=lb(a),f=Xa(a,d,C.dtype),w(f,c),V.freeType(f)):n.raise("invalid buffer data")}else if(X(a))w(a,c);else if(K(a)){d=a.shape;var e=a.stride,t=f=0,g=0,h=0;1===d.length?(f=d[0],t=1,g=e[0],h=0):2===d.length?(f=d[0],t=d[1],g=e[0],h=e[1]):n.raise("invalid shape");d=Array.isArray(a.data)?C.dtype:Oa(a.data);d=V.allocType(d,
f*t);hb(d,a.data,f,t,g,h,a.offset);w(d,c);V.freeType(d)}else n.raise("invalid data for buffer subdata");return p};c.profile&&(p.stats=C.stats);p.destroy=function(){g(C)};return p},createStream:function(a,b){var c=l.pop();c||(c=new d(a));c.bind();e(c,b,35040,0,1,!1);return c},destroyStream:function(a){l.push(a)},clear:function(){Y(k).forEach(g);l.forEach(g)},getBuffer:function(a){return a&&a._buffer instanceof d?a._buffer:null},restore:function(){Y(k).forEach(function(b){b.buffer=a.createBuffer();
a.bindBuffer(b.type,b.buffer);a.bufferData(b.type,b.persistentData||b.byteLength,b.usage)})},_initBuffer:e}}function Bb(a,b,c,d){function f(a){this.id=k++;h[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function e(d,f,g,h,k,l,q){d.buffer.bind();if(f){var p=q;q||X(f)&&(!K(f)||X(f.data))||(p=b.oes_element_index_uint?5125:5123);c._initBuffer(d.buffer,f,g,p,3)}else a.bufferData(34963,l,g),d.buffer.dtype=p||5121,d.buffer.usage=g,d.buffer.dimension=3,d.buffer.byteLength=l;p=q;if(!q){switch(d.buffer.dtype){case 5121:case 5120:p=
5121;break;case 5123:case 5122:p=5123;break;case 5125:case 5124:p=5125;break;default:n.raise("unsupported type for element array")}d.buffer.dtype=p}d.type=p;n(5125!==p||!!b.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");f=k;0>f&&(f=d.buffer.byteLength,5123===p?f>>=1:5125===p&&(f>>=2));d.vertCount=f;f=h;0>h&&(f=4,h=d.buffer.dimension,1===h&&(f=0),2===h&&(f=1),3===h&&(f=4));d.primType=f}function g(a){d.elementsCount--;n(null!==a.buffer,"must not double destroy elements");
delete h[a.id];a.buffer.destroy();a.buffer=null}var h={},k=0,l={uint8:5121,uint16:5123};b.oes_element_index_uint&&(l.uint32=5125);f.prototype.bind=function(){this.buffer.bind()};var q=[];return{create:function(a,b){function t(a){if(a)if("number"===typeof a)h(a),k.primType=4,k.vertCount=a|0,k.type=5121;else{var b=null,c=35044,d=-1,f=-1,g=0,L=0;if(Array.isArray(a)||X(a)||K(a))b=a;else if(n.type(a,"object","invalid arguments for elements"),"data"in a&&(b=a.data,n(Array.isArray(b)||X(b)||K(b),"invalid data for element buffer")),
"usage"in a&&(n.parameter(a.usage,Qa,"invalid element buffer usage"),c=Qa[a.usage]),"primitive"in a&&(n.parameter(a.primitive,Aa,"invalid element buffer primitive"),d=Aa[a.primitive]),"count"in a&&(n("number"===typeof a.count&&0<=a.count,"invalid vertex count for elements"),f=a.count|0),"type"in a&&(n.parameter(a.type,l,"invalid buffer type"),L=l[a.type]),"length"in a)g=a.length|0;else if(g=f,5123===L||5122===L)g*=2;else if(5125===L||5124===L)g*=4;e(k,b,c,d,f,g,L)}else h(),k.primType=4,k.vertCount=
0,k.type=5121;return t}var h=c.create(null,34963,!0),k=new f(h._buffer);d.elementsCount++;t(a);t._reglType="elements";t._elements=k;t.subdata=function(a,b){h.subdata(a,b);return t};t.destroy=function(){g(k)};return t},createStream:function(a){var b=q.pop();b||(b=new f(c.create(null,34963,!0,!1)._buffer));e(b,a,35040,-1,-1,0,0);return b},destroyStream:function(a){q.push(a)},getElements:function(a){return"function"===typeof a&&a._elements instanceof f?a._elements:null},clear:function(){Y(h).forEach(g)}}}
function jb(a){for(var b=V.allocType(5123,a.length),c=0;c<a.length;++c)if(isNaN(a[c]))b[c]=65535;else if(Infinity===a[c])b[c]=31744;else if(-Infinity===a[c])b[c]=64512;else{mb[0]=a[c];var d=Db[0],f=d>>>31<<15,e=(d<<1>>>24)-127,d=d>>13&1023;b[c]=-24>e?f:-14>e?f+(d+1024>>-14-e):15<e?f+31744:f+(e+15<<10)+d}return b}function Q(a){return Array.isArray(a)||X(a)}function ib(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function nb(a){return Array.isArray(a)&&0!==a.length&&Q(a[0])?!0:
!1}function Ba(a){return Object.prototype.toString.call(a)}function Za(a){if(!a)return!1;var b=Ba(a);return 0<=Eb.indexOf(b)?!0:ib(a)||nb(a)||K(a)}function ob(a,b){36193===a.type?(a.data=jb(b),V.freeType(b)):a.data=b}function Ra(a,b,c,d,f,e){a="undefined"!==typeof M[a]?M[a]:fa[a]*Ca[b];e&&(a*=6);if(f){for(d=0;1<=c;)d+=a*c*c,c/=2;return d}return a*c*d}function Fb(a,b,c,d,f,e,g){function h(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=
1;this.channels=this.height=this.width=this.colorSpace=0}function k(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function l(a,d){if("object"===typeof d&&d){"premultiplyAlpha"in d&&(n.type(d.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),a.premultiplyAlpha=d.premultiplyAlpha);
"flipY"in d&&(n.type(d.flipY,"boolean","invalid texture flip"),a.flipY=d.flipY);"alignment"in d&&(n.oneOf(d.alignment,[1,2,4,8],"invalid texture unpack alignment"),a.unpackAlignment=d.alignment);"colorSpace"in d&&(n.parameter(d.colorSpace,N,"invalid colorSpace"),a.colorSpace=N[d.colorSpace]);if("type"in d){var f=d.type;n(b.oes_texture_float||!("float"===f||"float32"===f),"you must enable the OES_texture_float extension in order to use floating point textures.");n(b.oes_texture_half_float||!("half float"===
f||"float16"===f),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures.");n(b.webgl_depth_texture||!("uint16"===f||"uint32"===f||"depth stencil"===f),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures.");n.parameter(f,la,"invalid texture type");a.type=la[f]}var e=a.width,g=a.height,h=a.channels,f=!1;"shape"in d?(n(Array.isArray(d.shape)&&2<=d.shape.length,"shape must be an array"),e=d.shape[0],g=d.shape[1],3===
d.shape.length&&(h=d.shape[2],n(0<h&&4>=h,"invalid number of channels"),f=!0),n(0<=e&&e<=c.maxTextureSize,"invalid width"),n(0<=g&&g<=c.maxTextureSize,"invalid height")):("radius"in d&&(e=g=d.radius,n(0<=e&&e<=c.maxTextureSize,"invalid radius")),"width"in d&&(e=d.width,n(0<=e&&e<=c.maxTextureSize,"invalid width")),"height"in d&&(g=d.height,n(0<=g&&g<=c.maxTextureSize,"invalid height")),"channels"in d&&(h=d.channels,n(0<h&&4>=h,"invalid number of channels"),f=!0));a.width=e|0;a.height=g|0;a.channels=
h|0;e=!1;"format"in d&&(e=d.format,n(b.webgl_depth_texture||!("depth"===e||"depth stencil"===e),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),n.parameter(e,R,"invalid texture format"),g=a.internalformat=R[e],a.format=ab[g],e in la&&!("type"in d)&&(a.type=la[e]),e in P&&(a.compressed=!0),e=!0);!f&&e?a.channels=fa[a.format]:f&&!e?a.channels!==Sa[a.format]&&(a.format=a.internalformat=Sa[a.channels]):e&&f&&n(a.channels===fa[a.format],"number of channels inconsistent with specified format")}}
function p(b){a.pixelStorei(37440,b.flipY);a.pixelStorei(37441,b.premultiplyAlpha);a.pixelStorei(37443,b.colorSpace);a.pixelStorei(3317,b.unpackAlignment)}function q(){h.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function C(a,b){var d=null;Za(b)?d=b:b&&(n.type(b,"object","invalid pixel data type"),l(a,b),"x"in b&&(a.xOffset=b.x|0),"y"in b&&(a.yOffset=b.y|0),Za(b.data)&&(d=b.data));n(!a.compressed||d instanceof Uint8Array,"compressed texture data must be stored in a uint8array");
if(b.copy){n(!d,"can not specify copy and data field for the same texture");var e=f.viewportWidth,g=f.viewportHeight;a.width=a.width||e-a.xOffset;a.height=a.height||g-a.yOffset;a.needsCopy=!0;n(0<=a.xOffset&&a.xOffset<e&&0<=a.yOffset&&a.yOffset<g&&0<a.width&&a.width<=e&&0<a.height&&a.height<=g,"copy texture read out of bounds")}else if(!d)a.width=a.width||1,a.height=a.height||1,a.channels=a.channels||4;else if(X(d))a.channels=a.channels||4,a.data=d,"type"in b||5121!==a.type||(a.type=Ia[Object.prototype.toString.call(d)]|
0);else if(ib(d)){a.channels=a.channels||4;e=d;g=e.length;switch(a.type){case 5121:case 5123:case 5125:case 5126:g=V.allocType(a.type,g);g.set(e);a.data=g;break;case 36193:a.data=jb(e);break;default:n.raise("unsupported texture type, must specify a typed array")}a.alignment=1;a.needsFree=!0}else if(K(d)){e=d.data;Array.isArray(e)||5121!==a.type||(a.type=Ia[Object.prototype.toString.call(e)]|0);var g=d.shape,h=d.stride,k,t,I,da;3===g.length?(I=g[2],da=h[2]):(n(2===g.length,"invalid ndarray pixel data, must be 2 or 3D"),
da=I=1);k=g[0];t=g[1];g=h[0];h=h[1];a.alignment=1;a.width=k;a.height=t;a.channels=I;a.format=a.internalformat=Sa[I];a.needsFree=!0;k=da;d=d.offset;I=a.width;da=a.height;t=a.channels;for(var p=V.allocType(36193===a.type?5126:a.type,I*da*t),q=0,L=0;L<da;++L)for(var xa=0;xa<I;++xa)for(var bb=0;bb<t;++bb)p[q++]=e[g*xa+h*L+k*bb+d];ob(a,p)}else if("[object HTMLCanvasElement]"===Ba(d)||"[object CanvasRenderingContext2D]"===Ba(d))"[object HTMLCanvasElement]"===Ba(d)?a.element=d:a.element=d.canvas,a.width=
a.element.width,a.height=a.element.height,a.channels=4;else if("[object HTMLImageElement]"===Ba(d))a.element=d,a.width=d.naturalWidth,a.height=d.naturalHeight,a.channels=4;else if("[object HTMLVideoElement]"===Ba(d))a.element=d,a.width=d.videoWidth,a.height=d.videoHeight,a.channels=4;else if(nb(d)){e=a.width||d[0].length;g=a.height||d.length;h=a.channels;h=Q(d[0][0])?h||d[0][0].length:h||1;k=Ta.shape(d);I=1;for(da=0;da<k.length;++da)I*=k[da];I=V.allocType(36193===a.type?5126:a.type,I);Ta.flatten(d,
k,"",I);ob(a,I);a.alignment=1;a.width=e;a.height=g;a.channels=h;a.format=a.internalformat=Sa[h];a.needsFree=!0}5126===a.type?n(0<=c.extensions.indexOf("oes_texture_float"),"oes_texture_float extension not enabled"):36193===a.type&&n(0<=c.extensions.indexOf("oes_texture_half_float"),"oes_texture_half_float extension not enabled")}function w(b,c,f,e,g){var h=b.element,k=b.data,n=b.internalformat,I=b.format,da=b.type,l=b.width,q=b.height;p(b);h?a.texSubImage2D(c,g,f,e,I,da,h):b.compressed?a.compressedTexSubImage2D(c,
g,f,e,n,l,q,k):b.needsCopy?(d(),a.copyTexSubImage2D(c,g,f,e,b.xOffset,b.yOffset,l,q)):a.texSubImage2D(c,g,f,e,l,q,I,da,k)}function u(){return T.pop()||new q}function v(a){a.needsFree&&V.freeType(a.data);q.call(a);T.push(a)}function r(){h.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function x(a,b,c){var d=a.images[0]=u();a.mipmask=1;d.width=a.width=b;d.height=a.height=c;d.channels=a.channels=4}function B(a,b){var c=null;if(Za(b))c=a.images[0]=u(),k(c,a),
C(c,b),a.mipmask=1;else if(l(a,b),Array.isArray(b.mipmap))for(var d=b.mipmap,f=0;f<d.length;++f)c=a.images[f]=u(),k(c,a),c.width>>=f,c.height>>=f,C(c,d[f]),a.mipmask|=1<<f;else c=a.images[0]=u(),k(c,a),C(c,b),a.mipmask=1;k(a,a.images[0]);(a.compressed&&33776===a.internalformat||33777===a.internalformat||33778===a.internalformat||33779===a.internalformat)&&n(0===a.width%4&&0===a.height%4,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function y(b,
c){for(var f=b.images,e=0;e<f.length&&f[e];++e){var g=f[e],h=c,k=e,n=g.element,I=g.data,da=g.internalformat,l=g.format,q=g.type,C=g.width,xa=g.height;p(g);n?a.texImage2D(h,k,l,l,q,n):g.compressed?a.compressedTexImage2D(h,k,da,C,xa,0,I):g.needsCopy?(d(),a.copyTexImage2D(h,k,l,g.xOffset,g.yOffset,C,xa,0)):a.texImage2D(h,k,l,C,xa,0,l,q,I)}}function z(){var a=O.pop()||new r;h.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function A(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&v(b[c]),
b[c]=null;O.push(a)}function H(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function J(a,b){if("min"in b){var d=b.min;n.parameter(d,Ua);a.minFilter=Ua[d];0<=Gb.indexOf(a.minFilter)&&(a.genMipmaps=!0)}"mag"in b&&(d=b.mag,n.parameter(d,Ma),a.magFilter=Ma[d]);var d=a.wrapS,f=a.wrapT;if("wrap"in b){var e=b.wrap;"string"===typeof e?(n.parameter(e,F),d=f=F[e]):Array.isArray(e)&&(n.parameter(e[0],F),n.parameter(e[1],F),d=F[e[0]],
f=F[e[1]])}else"wrapS"in b&&(d=b.wrapS,n.parameter(d,F),d=F[d]),"wrapT"in b&&(f=b.wrapT,n.parameter(f,F),f=F[f]);a.wrapS=d;a.wrapT=f;"anisotropic"in b&&(d=b.anisotropic,n("number"===typeof d&&1<=d&&d<=c.maxAnisotropic,"aniso samples must be between 1 and "),a.anisotropic=b.anisotropic);if("mipmap"in b){d=!1;switch(typeof b.mipmap){case "string":n.parameter(b.mipmap,pb,"invalid mipmap hint");a.mipmapHint=pb[b.mipmap];d=a.genMipmaps=!0;break;case "boolean":d=a.genMipmaps=b.mipmap;break;case "object":n(Array.isArray(b.mipmap),
"invalid mipmap type");a.genMipmaps=!1;d=!0;break;default:n.raise("invalid mipmap type")}!d||"min"in b||(a.minFilter=9984)}}function G(c,d){a.texParameteri(d,10241,c.minFilter);a.texParameteri(d,10240,c.magFilter);a.texParameteri(d,10242,c.wrapS);a.texParameteri(d,10243,c.wrapT);b.ext_texture_filter_anisotropic&&a.texParameteri(d,34046,c.anisotropic);c.genMipmaps&&(a.hint(33170,c.mipmapHint),a.generateMipmap(d))}function Ya(b){h.call(this);this.mipmask=0;this.internalformat=6408;this.id=Hb++;this.refCount=
1;this.target=b;this.texture=a.createTexture();this.unit=-1;this.bindCount=0;this.texInfo=new H;g.profile&&(this.stats={size:0})}function E(b){a.activeTexture(33984);a.bindTexture(b.target,b.texture)}function D(){var b=pa[0];b?a.bindTexture(b.target,b.texture):a.bindTexture(3553,null)}function qb(b){var c=b.texture;n(c,"must not double destroy texture");var d=b.unit,f=b.target;0<=d&&(a.activeTexture(33984+d),a.bindTexture(f,null),pa[d]=null);a.deleteTexture(c);b.texture=null;b.params=null;b.pixels=
null;b.refCount=0;delete Z[b.id];e.textureCount--}var pb={"don't care":4352,"dont care":4352,nice:4354,fast:4353},F={repeat:10497,clamp:33071,mirror:33648},Ma={nearest:9728,linear:9729},Ua=S({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Ma),N={none:0,browser:37444},la={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},R={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,
rgb565:36194},P={};b.ext_srgb&&(R.srgb=35904,R.srgba=35906);b.oes_texture_float&&(la.float32=la["float"]=5126);b.oes_texture_half_float&&(la.float16=la["half float"]=36193);b.webgl_depth_texture&&(S(R,{depth:6402,"depth stencil":34041}),S(la,{uint16:5123,uint32:5125,"depth stencil":34042}));b.webgl_compressed_texture_s3tc&&S(P,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});b.webgl_compressed_texture_atc&&S(P,{"rgb atc":35986,"rgba atc explicit alpha":35987,
"rgba atc interpolated alpha":34798});b.webgl_compressed_texture_pvrtc&&S(P,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});b.webgl_compressed_texture_etc1&&(P["rgb etc1"]=36196);var U=Array.prototype.slice.call(a.getParameter(34467));Object.keys(P).forEach(function(a){var b=P[a];0<=U.indexOf(b)&&(R[a]=b)});var W=Object.keys(R);c.textureFormats=W;var cb=[];Object.keys(R).forEach(function(a){cb[R[a]]=a});var aa=[];Object.keys(la).forEach(function(a){aa[la[a]]=
a});var Na=[];Object.keys(Ma).forEach(function(a){Na[Ma[a]]=a});var ya=[];Object.keys(Ua).forEach(function(a){ya[Ua[a]]=a});var za=[];Object.keys(F).forEach(function(a){za[F[a]]=a});var ab=W.reduce(function(a,b){var c=R[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{}),T=[],O=[],Hb=0,Z={},M=c.maxTextureUnits,pa=Array(M).map(function(){return null});S(Ya.prototype,{bind:function(){this.bindCount+=1;var b=this.unit;
if(0>b){for(var c=0;c<M;++c){var d=pa[c];if(d){if(0<d.bindCount)continue;d.unit=-1}pa[c]=this;b=c;break}b>=M&&n.raise("insufficient number of texture units");g.profile&&e.maxTextureUnits<b+1&&(e.maxTextureUnits=b+1);this.unit=b;a.activeTexture(33984+b);a.bindTexture(this.target,this.texture)}return b},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&qb(this)}});g.profile&&(e.getTotalTextureSize=function(){var a=0;Object.keys(Z).forEach(function(b){a+=Z[b].stats.size});return a});
return{create2D:function(b,d){function f(a,b){var d=h.texInfo;H.call(d);var e=z();"number"===typeof a?"number"===typeof b?x(e,a|0,b|0):x(e,a|0,a|0):a?(n.type(a,"object","invalid arguments to regl.texture"),J(d,a),B(e,a)):x(e,1,1);d.genMipmaps&&(e.mipmask=(e.width<<1)-1);h.mipmask=e.mipmask;k(h,e);n.texture2D(d,e,c);h.internalformat=e.internalformat;f.width=e.width;f.height=e.height;E(h);y(e,3553);G(d,3553);D();A(e);g.profile&&(h.stats.size=Ra(h.internalformat,h.type,e.width,e.height,d.genMipmaps,
!1));f.format=cb[h.internalformat];f.type=aa[h.type];f.mag=Na[d.magFilter];f.min=ya[d.minFilter];f.wrapS=za[d.wrapS];f.wrapT=za[d.wrapT];return f}var h=new Ya(3553);Z[h.id]=h;e.textureCount++;f(b,d);f.subimage=function(a,b,c,d){n(!!a,"must specify image data");b|=0;c|=0;d|=0;var e=u();k(e,h);e.width=0;e.height=0;C(e,a);e.width=e.width||(h.width>>d)-b;e.height=e.height||(h.height>>d)-c;n(h.type===e.type&&h.format===e.format&&h.internalformat===e.internalformat,"incompatible format for texture.subimage");
n(0<=b&&0<=c&&b+e.width<=h.width&&c+e.height<=h.height,"texture.subimage write out of bounds");n(h.mipmask&1<<d,"missing mipmap data");n(e.data||e.element||e.needsCopy,"missing image data");E(h);w(e,3553,b,c,d);D();v(e);return f};f.resize=function(b,c){var d=b|0,e=c|0||d;if(d===h.width&&e===h.height)return f;f.width=h.width=d;f.height=h.height=e;E(h);for(var k=0;h.mipmask>>k;++k)a.texImage2D(3553,k,h.format,d>>k,e>>k,0,h.format,h.type,null);D();g.profile&&(h.stats.size=Ra(h.internalformat,h.type,
d,e,!1,!1));return f};f._reglType="texture2d";f._texture=h;g.profile&&(f.stats=h.stats);f.destroy=function(){h.decRef()};return f},createCube:function(b,d,f,h,q,p){function L(a,b,d,f,e,h){var t,ga=r.texInfo;H.call(ga);for(t=0;6>t;++t)I[t]=z();if("number"!==typeof a&&a)if("object"===typeof a)if(b)B(I[0],a),B(I[1],b),B(I[2],d),B(I[3],f),B(I[4],e),B(I[5],h);else if(J(ga,a),l(r,a),"faces"in a)for(a=a.faces,n(Array.isArray(a)&&6===a.length,"cube faces must be a length 6 array"),t=0;6>t;++t)n("object"===
typeof a[t]&&!!a[t],"invalid input for cube map face"),k(I[t],r),B(I[t],a[t]);else for(t=0;6>t;++t)B(I[t],a);else n.raise("invalid arguments to cube map");else for(a=a|0||1,t=0;6>t;++t)x(I[t],a,a);k(r,I[0]);r.mipmask=ga.genMipmaps?(I[0].width<<1)-1:I[0].mipmask;n.textureCube(r,ga,I,c);r.internalformat=I[0].internalformat;L.width=I[0].width;L.height=I[0].height;E(r);for(t=0;6>t;++t)y(I[t],34069+t);G(ga,34067);D();g.profile&&(r.stats.size=Ra(r.internalformat,r.type,L.width,L.height,ga.genMipmaps,!0));
L.format=cb[r.internalformat];L.type=aa[r.type];L.mag=Na[ga.magFilter];L.min=ya[ga.minFilter];L.wrapS=za[ga.wrapS];L.wrapT=za[ga.wrapT];for(t=0;6>t;++t)A(I[t]);return L}var r=new Ya(34067);Z[r.id]=r;e.cubeCount++;var I=Array(6);L(b,d,f,h,q,p);L.subimage=function(a,b,c,d,f){n(!!b,"must specify image data");n("number"===typeof a&&a===(a|0)&&0<=a&&6>a,"invalid face");c|=0;d|=0;f|=0;var e=u();k(e,r);e.width=0;e.height=0;C(e,b);e.width=e.width||(r.width>>f)-c;e.height=e.height||(r.height>>f)-d;n(r.type===
e.type&&r.format===e.format&&r.internalformat===e.internalformat,"incompatible format for texture.subimage");n(0<=c&&0<=d&&c+e.width<=r.width&&d+e.height<=r.height,"texture.subimage write out of bounds");n(r.mipmask&1<<f,"missing mipmap data");n(e.data||e.element||e.needsCopy,"missing image data");E(r);w(e,34069+a,c,d,f);D();v(e);return L};L.resize=function(b){b|=0;if(b!==r.width){L.width=r.width=b;L.height=r.height=b;E(r);for(var c=0;6>c;++c)for(var d=0;r.mipmask>>d;++d)a.texImage2D(34069+c,d,r.format,
b>>d,b>>d,0,r.format,r.type,null);D();g.profile&&(r.stats.size=Ra(r.internalformat,r.type,L.width,L.height,!1,!0));return L}};L._reglType="textureCube";L._texture=r;g.profile&&(L.stats=r.stats);L.destroy=function(){r.decRef()};return L},clear:function(){for(var b=0;b<M;++b)a.activeTexture(33984+b),a.bindTexture(3553,null),pa[b]=null;Y(Z).forEach(qb);e.cubeCount=0;e.textureCount=0},getTexture:function(a){return null},restore:function(){Y(Z).forEach(function(b){b.texture=a.createTexture();a.bindTexture(b.target,
b.texture);for(var c=0;32>c;++c)if(0!==(b.mipmask&1<<c))if(3553===b.target)a.texImage2D(3553,c,b.internalformat,b.width>>c,b.height>>c,0,b.internalformat,b.type,null);else for(var d=0;6>d;++d)a.texImage2D(34069+d,c,b.internalformat,b.width>>c,b.height>>c,0,b.internalformat,b.type,null);G(b.texInfo,b.target)})}}}function Ib(a,b,c,d,f,e){function h(a,b,c){this.target=a;this.texture=b;this.renderbuffer=c;var d=a=0;b?(a=b.width,d=b.height):c&&(a=c.width,d=c.height);this.width=a;this.height=d}function g(a){a&&
(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function k(a,b,c){if(a){if(a.texture){a=a.texture._texture;var d=Math.max(1,a.height);n(Math.max(1,a.width)===b&&d===c,"inconsistent width/height for supplied texture")}else a=a.renderbuffer._renderbuffer,n(a.width===b&&a.height===c,"inconsistent width/height for renderbuffer");a.refCount+=1}}function l(b,c){c&&(c.texture?a.framebufferTexture2D(36160,b,c.target,c.texture._texture.texture,0):a.framebufferRenderbuffer(36160,
b,36161,c.renderbuffer._renderbuffer.renderbuffer))}function q(a){var b=3553,c=null,d=null,f=a;"object"===typeof a&&(f=a.data,"target"in a&&(b=a.target|0));n.type(f,"function","invalid attachment data");a=f._reglType;"texture2d"===a?(c=f,n(3553===b)):"textureCube"===a?(c=f,n(34069<=b&&34075>b,"invalid cube map target")):"renderbuffer"===a?(d=f,b=36161):n.raise("invalid regl object for attachment");return new h(b,c,d)}function p(a,b,c,e,g){if(c)return a=d.create2D({width:a,height:b,format:e,type:g}),
a._texture.refCount=0,new h(3553,a,null);a=f.create({width:a,height:b,format:e});a._renderbuffer.refCount=0;return new h(36161,null,a)}function C(a){return a&&(a.texture||a.renderbuffer)}function r(a,b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c))}function w(){this.id=E++;F[this.id]=this;this.framebuffer=a.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function u(a){a.colorAttachments.forEach(g);
g(a.depthAttachment);g(a.stencilAttachment);g(a.depthStencilAttachment)}function v(b){var c=b.framebuffer;n(c,"must not double destroy framebuffer");a.deleteFramebuffer(c);b.framebuffer=null;e.framebufferCount--;delete F[b.id]}function B(b){var d;a.bindFramebuffer(36160,b.framebuffer);var f=b.colorAttachments;for(d=0;d<f.length;++d)l(36064+d,f[d]);for(d=f.length;d<c.maxColorAttachments;++d)a.framebufferTexture2D(36160,36064+d,3553,null,0);a.framebufferTexture2D(36160,33306,3553,null,0);a.framebufferTexture2D(36160,
36096,3553,null,0);a.framebufferTexture2D(36160,36128,3553,null,0);l(36096,b.depthAttachment);l(36128,b.stencilAttachment);l(33306,b.depthStencilAttachment);b=a.checkFramebufferStatus(36160);36053!==b&&n.raise("framebuffer configuration not supported, status = "+Jb[b]);a.bindFramebuffer(36160,y.next);y.cur=y.next;a.getError()}function x(a,d){function f(a,d){var e;n(y.next!==h,"can not update framebuffer which is currently in use");var g=b.webgl_draw_buffers,t=0,l=0,r=!0,w=!0;e=null;var v=!0,x="rgba",
ka="uint8",F=1,E=null,G=null,J=null,Pa=!1;if("number"===typeof a)t=a|0,l=d|0||t;else if(a){n.type(a,"object","invalid arguments for framebuffer");"shape"in a?(l=a.shape,n(Array.isArray(l)&&2<=l.length,"invalid shape for framebuffer"),t=l[0],l=l[1]):("radius"in a&&(t=l=a.radius),"width"in a&&(t=a.width),"height"in a&&(l=a.height));if("color"in a||"colors"in a)e=a.color||a.colors,Array.isArray(e)&&n(1===e.length||g,"multiple render targets not supported");if(!e){"colorCount"in a&&(F=a.colorCount|0,
n(0<F,"invalid color buffer count"));"colorTexture"in a&&(v=!!a.colorTexture,x="rgba4");if("colorType"in a){ka=a.colorType;if(v)n(b.oes_texture_float||!("float"===ka||"float32"===ka),"you must enable OES_texture_float in order to use floating point framebuffer objects"),n(b.oes_texture_half_float||!("half float"===ka||"float16"===ka),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects");else if("half float"===ka||"float16"===ka)n(b.ext_color_buffer_half_float,
"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),x="rgba16f";else if("float"===ka||"float32"===ka)n(b.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),x="rgba32f";n.oneOf(ka,H,"invalid color type")}if("colorFormat"in a)if(x=a.colorFormat,0<=z.indexOf(x))v=!0;else if(0<=A.indexOf(x))v=!1;else if(v)n.oneOf(a.colorFormat,z,"invalid color format for texture");else n.oneOf(a.colorFormat,A,"invalid color format for renderbuffer")}if("depthTexture"in
a||"depthStencilTexture"in a)Pa=!(!a.depthTexture&&!a.depthStencilTexture),n(!Pa||b.webgl_depth_texture,"webgl_depth_texture extension not supported");"depth"in a&&("boolean"===typeof a.depth?r=a.depth:(E=a.depth,w=!1));"stencil"in a&&("boolean"===typeof a.stencil?w=a.stencil:(G=a.stencil,r=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?r=w=a.depthStencil:(J=a.depthStencil,w=r=!1))}else t=l=1;var D=g=null,ra=null,na=null;if(Array.isArray(e))g=e.map(q);else if(e)g=[q(e)];else for(g=Array(F),
e=0;e<F;++e)g[e]=p(t,l,v,x,ka);n(b.webgl_draw_buffers||1>=g.length,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers.");n(g.length<=c.maxColorAttachments,"too many color attachments, not supported");t=t||g[0].width;l=l||g[0].height;E?D=q(E):r&&!w&&(D=p(t,l,Pa,"depth","uint32"));G?ra=q(G):w&&!r&&(ra=p(t,l,!1,"stencil","uint8"));J?na=q(J):!E&&!G&&w&&r&&(na=p(t,l,Pa,"depth stencil","depth stencil"));n(1>=!!E+!!G+!!J,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");
r=null;for(e=0;e<g.length;++e)k(g[e],t,l),n(!g[e]||g[e].texture&&0<=Kb.indexOf(g[e].texture._texture.format)||g[e].renderbuffer&&0<=Lb.indexOf(g[e].renderbuffer._renderbuffer.format),"framebuffer color attachment "+e+" is invalid"),g[e]&&g[e].texture&&(w=rb[g[e].texture._texture.format]*Va[g[e].texture._texture.type],null===r?r=w:n(r===w,"all color attachments much have the same number of bits per pixel."));k(D,t,l);n(!D||D.texture&&6402===D.texture._texture.format||D.renderbuffer&&33189===D.renderbuffer._renderbuffer.format,
"invalid depth attachment for framebuffer object");k(ra,t,l);n(!ra||ra.renderbuffer&&36168===ra.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object");k(na,t,l);n(!na||na.texture&&34041===na.texture._texture.format||na.renderbuffer&&34041===na.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object");u(h);h.width=t;h.height=l;h.colorAttachments=g;h.depthAttachment=D;h.stencilAttachment=ra;h.depthStencilAttachment=na;f.color=g.map(C);
f.depth=C(D);f.stencil=C(ra);f.depthStencil=C(na);f.width=h.width;f.height=h.height;B(h);return f}var h=new w;e.framebufferCount++;f(a,d);return S(f,{resize:function(a,b){n(y.next!==h,"can not resize a framebuffer which is currently in use");var c=a|0,d=b|0||c;if(c===h.width&&d===h.height)return f;for(var e=h.colorAttachments,g=0;g<e.length;++g)r(e[g],c,d);r(h.depthAttachment,c,d);r(h.stencilAttachment,c,d);r(h.depthStencilAttachment,c,d);h.width=f.width=c;h.height=f.height=d;B(h);return f},_reglType:"framebuffer",
_framebuffer:h,destroy:function(){v(h);u(h)},use:function(a){y.setFBO({framebuffer:f},a)}})}var y={cur:null,next:null,dirty:!1,setFBO:null},z=["rgba"],A=["rgba4","rgb565","rgb5 a1"];b.ext_srgb&&A.push("srgba");b.ext_color_buffer_half_float&&A.push("rgba16f","rgb16f");b.webgl_color_buffer_float&&A.push("rgba32f");var H=["uint8"];b.oes_texture_half_float&&H.push("half float","float16");b.oes_texture_float&&H.push("float","float32");var E=0,F={};return S(y,{getFramebuffer:function(a){return"function"===
typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof w)?a:null},create:x,createCube:function(a){function e(a){var c;n(0>f.indexOf(y.next),"can not update framebuffer which is currently in use");var h=b.webgl_draw_buffers,g={color:null},k=0,t=null;c="rgba";var l="uint8",q=1;if("number"===typeof a)k=a|0;else if(a){n.type(a,"object","invalid arguments for framebuffer");"shape"in a?(k=a.shape,n(Array.isArray(k)&&2<=k.length,"invalid shape for framebuffer"),n(k[0]===k[1],"cube framebuffer must be square"),
k=k[0]):("radius"in a&&(k=a.radius|0),"width"in a?(k=a.width|0,"height"in a&&n(a.height===k,"must be square")):"height"in a&&(k=a.height|0));if("color"in a||"colors"in a)t=a.color||a.colors,Array.isArray(t)&&n(1===t.length||h,"multiple render targets not supported");t||("colorCount"in a&&(q=a.colorCount|0,n(0<q,"invalid color buffer count")),"colorType"in a&&(n.oneOf(a.colorType,H,"invalid color type"),l=a.colorType),"colorFormat"in a&&(c=a.colorFormat,n.oneOf(a.colorFormat,z,"invalid color format for texture")));
"depth"in a&&(g.depth=a.depth);"stencil"in a&&(g.stencil=a.stencil);"depthStencil"in a&&(g.depthStencil=a.depthStencil)}else k=1;if(t)if(Array.isArray(t))for(a=[],c=0;c<t.length;++c)a[c]=t[c];else a=[t];else for(a=Array(q),t={radius:k,format:c,type:l},c=0;c<q;++c)a[c]=d.createCube(t);g.color=Array(a.length);for(c=0;c<a.length;++c)q=a[c],n("function"===typeof q&&"textureCube"===q._reglType,"invalid cube map"),k=k||q.width,n(q.width===k&&q.height===k,"invalid cube map shape"),g.color[c]={target:34069,
data:a[c]};for(c=0;6>c;++c){for(q=0;q<a.length;++q)g.color[q].target=34069+c;0<c&&(g.depth=f[0].depth,g.stencil=f[0].stencil,g.depthStencil=f[0].depthStencil);if(f[c])f[c](g);else f[c]=x(g)}return S(e,{width:k,height:k,color:a})}var f=Array(6);e(a);return S(e,{faces:f,resize:function(a){var b=a|0;n(0<b&&b<=c.maxCubeMapSize,"invalid radius for cube fbo");if(b===e.width)return e;var d=e.color;for(a=0;a<d.length;++a)d[a].resize(b);for(a=0;6>a;++a)f[a].resize(b);e.width=e.height=b;return e},_reglType:"framebufferCube",
destroy:function(){f.forEach(function(a){a.destroy()})}})},clear:function(){Y(F).forEach(v)},restore:function(){Y(F).forEach(function(b){b.framebuffer=a.createFramebuffer();B(b)})}})}function sb(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}function Mb(a,b,c,d,e){a=c.maxAttributes;b=Array(a);for(c=0;c<a;++c)b[c]=new sb;return{Record:sb,scope:{},state:b}}function Nb(a,b,c,d){function e(a,b,c,d){this.name=
a;this.id=b;this.location=c;this.info=d}function f(a,b){for(var c=0;c<a.length;++c)if(a[c].id===b.id){a[c].location=b.location;return}a.push(b)}function g(c,d,e){var f=35632===c?l:q,h=f[d];if(!h){var k=b.str(d),h=a.createShader(c);a.shaderSource(h,k);a.compileShader(h);n.shaderError(a,h,k,c,e);f[d]=h}return h}function h(a,b){this.id=C++;this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[];d.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function k(c,h){var l,
q;l=g(35632,c.fragId);q=g(35633,c.vertId);var p=c.program=a.createProgram();a.attachShader(p,l);a.attachShader(p,q);a.linkProgram(p);n.linkError(a,p,b.str(c.fragId),b.str(c.vertId),h);var r=a.getProgramParameter(p,35718);d.profile&&(c.stats.uniformsCount=r);var C=c.uniforms;for(l=0;l<r;++l)if(q=a.getActiveUniform(p,l))if(1<q.size)for(var w=0;w<q.size;++w){var u=q.name.replace("[0]","["+w+"]");f(C,new e(u,b.id(u),a.getUniformLocation(p,u),q))}else f(C,new e(q.name,b.id(q.name),a.getUniformLocation(p,
q.name),q));r=a.getProgramParameter(p,35721);d.profile&&(c.stats.attributesCount=r);C=c.attributes;for(l=0;l<r;++l)(q=a.getActiveAttrib(p,l))&&f(C,new e(q.name,b.id(q.name),a.getAttribLocation(p,q.name),q))}var l={},q={},p={},r=[],C=0;d.profile&&(c.getMaxUniformsCount=function(){var a=0;r.forEach(function(b){b.stats.uniformsCount>a&&(a=b.stats.uniformsCount)});return a},c.getMaxAttributesCount=function(){var a=0;r.forEach(function(b){b.stats.attributesCount>a&&(a=b.stats.attributesCount)});return a});
return{clear:function(){var b=a.deleteShader.bind(a);Y(l).forEach(b);l={};Y(q).forEach(b);q={};r.forEach(function(b){a.deleteProgram(b.program)});r.length=0;p={};c.shaderCount=0},program:function(a,b,d){n.command(0<=a,"missing vertex shader",d);n.command(0<=b,"missing fragment shader",d);var e=p[b];e||(e=p[b]={});var f=e[a];f||(f=new h(b,a),c.shaderCount++,k(f,d),e[a]=f,r.push(f));return f},restore:function(){l={};q={};for(var a=0;a<r.length;++a)k(r[a])},shader:g,frag:-1,vert:-1}}function Ob(a,b,
c,d,f,e){function h(g){var k;null===b.next?(n(f.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),k=5121):(n(null!==b.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),k=b.next.colorAttachments[0].texture._texture.type,e.oes_texture_float?n(5121===k||5126===k,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"):n(5121===k,"Reading from a framebuffer is only allowed for the type 'uint8'"));
var l=0,q=0,p=d.framebufferWidth,r=d.framebufferHeight,C=null;X(g)?C=g:g&&(n.type(g,"object","invalid arguments to regl.read()"),l=g.x|0,q=g.y|0,n(0<=l&&l<d.framebufferWidth,"invalid x offset for regl.read"),n(0<=q&&q<d.framebufferHeight,"invalid y offset for regl.read"),p=(g.width||d.framebufferWidth-l)|0,r=(g.height||d.framebufferHeight-q)|0,C=g.data||null);C&&(5121===k?n(C instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):5126===k&&n(C instanceof
Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'"));n(0<p&&p+l<=d.framebufferWidth,"invalid width for read pixels");n(0<r&&r+q<=d.framebufferHeight,"invalid height for read pixels");c();g=p*r*4;C||(5121===k?C=new Uint8Array(g):5126===k&&(C=C||new Float32Array(g)));n.isTypedArray(C,"data buffer for regl.read() must be a typedarray");n(C.byteLength>=g,"data buffer for regl.read() too small");a.pixelStorei(3333,4);a.readPixels(l,q,p,r,6408,k,C);return C}function g(a){var c;
b.setFBO({framebuffer:a.framebuffer},function(){c=h(a)});return c}return function(a){return a&&"framebuffer"in a?g(a):h(a)}}function Ea(a){return Array.prototype.slice.call(a)}function Fa(a){return Ea(a).join("")}function Pb(){function a(){var b=[],d=[];return S(function(){b.push.apply(b,Ea(arguments))},{def:function(){var a="v"+c++;d.push(a);0<arguments.length&&(b.push(a,"="),b.push.apply(b,Ea(arguments)),b.push(";"));return a},toString:function(){return Fa([0<d.length?"var "+d+";":"",Fa(b)])}})}
function b(){function c(a,b){f(a,b,"=",d.def(a,b),";")}var d=a(),f=a(),e=d.toString,g=f.toString;return S(function(){d.apply(d,Ea(arguments))},{def:d.def,entry:d,exit:f,save:c,set:function(a,b,f){c(a,b);d(a,b,"=",f,";")},toString:function(){return e()+g()}})}var c=0,d=[],f=[],e=a(),g={};return{global:e,link:function(a){for(var b=0;b<f.length;++b)if(f[b]===a)return d[b];b="g"+c++;d.push(b);f.push(a);return b},block:a,proc:function(a,c){function d(){var a="a"+f.length;f.push(a);return a}var f=[];c=
c||0;for(var e=0;e<c;++e)d();var e=b(),h=e.toString;return g[a]=S(e,{arg:d,toString:function(){return Fa(["function(",f.join(),"){",h(),"}"])}})},scope:b,cond:function(){var a=Fa(arguments),c=b(),d=b(),f=c.toString,e=d.toString;return S(c,{then:function(){c.apply(c,Ea(arguments));return this},"else":function(){d.apply(d,Ea(arguments));return this},toString:function(){var b=e();b&&(b="else{"+b+"}");return Fa(["if(",a,"){",f(),"}",b])}})},compile:function(){var a=['"use strict";',e,"return {"];Object.keys(g).forEach(function(b){a.push('"',
b,'":',g[b].toString(),",")});a.push("}");var b=Fa(a).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,d.concat(b)).apply(null,f)}}}function Wa(a){return Array.isArray(a)||X(a)||K(a)}function tb(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function ia(a,b,c,d){this.thisDep=a;this.contextDep=b;this.propDep=c;this.append=d}function va(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function T(a){return new ia(!1,!1,!1,a)}
function ha(a,b){var c=a.type;return 0===c?(c=a.data.length,new ia(!0,1<=c,2<=c,b)):4===c?(c=a.data,new ia(c.thisDep,c.contextDep,c.propDep,b)):new ia(3===c,2===c,1===c,b)}function Qb(a,b,c,d,f,e,g,h,k,l,q,p,r,C,w){function u(a){return a.replace(".","_")}function v(a,b,c){var d=u(a);La.push(a);Ka[d]=sa[d]=!!c;ta[d]=b}function x(a,b,c){var d=u(a);La.push(a);Array.isArray(c)?(sa[d]=c.slice(),Ka[d]=c.slice()):sa[d]=Ka[d]=c;ua[d]=b}function B(){var a=Pb(),c=a.link,d=a.global;a.id=oa++;a.batchId="0";var f=
c($a),e=a.shared={props:"a0"};Object.keys($a).forEach(function(a){e[a]=d.def(f,".",a)});n.optional(function(){a.CHECK=c(n);a.commandStr=n.guessCommand();a.command=c(a.commandStr);a.assert=function(a,b,d){a("if(!(",b,"))",this.CHECK,".commandRaise(",c(d),",",this.command,");")};ja.invalidBlendCombinations=ub});var g=a.next={},h=a.current={};Object.keys(ua).forEach(function(a){Array.isArray(sa[a])&&(g[a]=d.def(e.next,".",a),h[a]=d.def(e.current,".",a))});var k=a.constants={};Object.keys(ja).forEach(function(a){k[a]=
d.def(JSON.stringify(ja[a]))});a.invoke=function(b,d){switch(d.type){case 0:var f=["this",e.context,e.props,a.batchId];return b.def(c(d.data),".call(",f.slice(0,Math.max(d.data.length+1,4)),")");case 1:return b.def(e.props,d.data);case 2:return b.def(e.context,d.data);case 3:return b.def("this",d.data);case 4:return d.data.append(a,b),d.data.ref}};a.attribCache={};var ga={};a.scopeAttrib=function(a){a=b.id(a);if(a in ga)return ga[a];var d=l.scope[a];d||(d=l.scope[a]=new Y);return ga[a]=c(d)};return a}
function y(a){var b=a["static"];a=a.dynamic;var c;if("profile"in b){var d=!!b.profile;c=T(function(a,b){return d});c.enable=d}else if("profile"in a){var f=a.profile;c=ha(f,function(a,b){return a.invoke(b,f)})}return c}function z(a,b){var c=a["static"],d=a.dynamic;if("framebuffer"in c){var f=c.framebuffer;return f?(f=h.getFramebuffer(f),n.command(f,"invalid framebuffer object"),T(function(a,b){var c=a.link(f),d=a.shared;b.set(d.framebuffer,".next",c);d=d.context;b.set(d,".framebufferWidth",c+".width");
b.set(d,".framebufferHeight",c+".height");return c})):T(function(a,b){var c=a.shared;b.set(c.framebuffer,".next","null");c=c.context;b.set(c,".framebufferWidth",c+".drawingBufferWidth");b.set(c,".framebufferHeight",c+".drawingBufferHeight");return"null"})}if("framebuffer"in d){var e=d.framebuffer;return ha(e,function(a,b){var c=a.invoke(b,e),d=a.shared,f=d.framebuffer,g=b.def(f,".getFramebuffer(",c,")");n.optional(function(){a.assert(b,"!"+c+"||"+g,"invalid framebuffer object")});b.set(f,".next",
g);d=d.context;b.set(d,".framebufferWidth",g+"?"+g+".width:"+d+".drawingBufferWidth");b.set(d,".framebufferHeight",g+"?"+g+".height:"+d+".drawingBufferHeight");return g})}return null}function A(a,b,c){function d(a){if(a in f){var g=f[a];n.commandType(g,"object","invalid "+a,c.commandStr);var h=!0,k=g.x|0,l=g.y|0,t,q;"width"in g?(t=g.width|0,n.command(0<=t,"invalid "+a,c.commandStr)):h=!1;"height"in g?(q=g.height|0,n.command(0<=q,"invalid "+a,c.commandStr)):h=!1;return new ia(!h&&b&&b.thisDep,!h&&
b&&b.contextDep,!h&&b&&b.propDep,function(a,b){var c=a.shared.context,d=t;"width"in g||(d=b.def(c,".","framebufferWidth","-",k));var f=q;"height"in g||(f=b.def(c,".","framebufferHeight","-",l));return[k,l,d,f]})}if(a in e){var I=e[a],h=ha(I,function(b,c){var d=b.invoke(c,I);n.optional(function(){b.assert(c,d+"&&typeof "+d+'==="object"',"invalid "+a)});var f=b.shared.context,e=c.def(d,".x|0"),g=c.def(d,".y|0"),h=c.def('"width" in ',d,"?",d,".width|0:","(",f,".","framebufferWidth","-",e,")"),k=c.def('"height" in ',
d,"?",d,".height|0:","(",f,".","framebufferHeight","-",g,")");n.optional(function(){b.assert(c,h+">=0&&"+k+">=0","invalid "+a)});return[e,g,h,k]});b&&(h.thisDep=h.thisDep||b.thisDep,h.contextDep=h.contextDep||b.contextDep,h.propDep=h.propDep||b.propDep);return h}return b?new ia(b.thisDep,b.contextDep,b.propDep,function(a,b){var c=a.shared.context;return[0,0,b.def(c,".","framebufferWidth"),b.def(c,".","framebufferHeight")]}):null}var f=a["static"],e=a.dynamic;if(a=d("viewport")){var g=a;a=new ia(a.thisDep,
a.contextDep,a.propDep,function(a,b){var c=g.append(a,b),d=a.shared.context;b.set(d,".viewportWidth",c[2]);b.set(d,".viewportHeight",c[3]);return c})}return{viewport:a,scissor_box:d("scissor.box")}}function H(a){function c(a){if(a in d){var e=b.id(d[a]);n.optional(function(){q.shader(vb[a],e,n.guessCommand())});var g=T(function(){return e});g.id=e;return g}if(a in f){var h=f[a];return ha(h,function(b,c){var d=b.invoke(c,h),f=c.def(b.shared.strings,".id(",d,")");n.optional(function(){c(b.shared.shader,
".shader(",vb[a],",",f,",",b.command,");")});return f})}return null}var d=a["static"],f=a.dynamic,e=c("frag"),g=c("vert"),h=null;va(e)&&va(g)?(h=q.program(g.id,e.id),a=T(function(a,b){return a.link(h)})):a=new ia(e&&e.thisDep||g&&g.thisDep,e&&e.contextDep||g&&g.contextDep,e&&e.propDep||g&&g.propDep,function(a,b){var c=a.shared.shader,d;d=e?e.append(a,b):b.def(c,".","frag");var f;f=g?g.append(a,b):b.def(c,".","vert");var h=c+".program("+f+","+d;n.optional(function(){h+=","+a.command});return b.def(h+
")")});return{frag:e,vert:g,progVar:a,program:h}}function E(a,b){function c(a,e){if(a in d){var h=d[a]|0;n.command(!e||0<=h,"invalid "+a,b.commandStr);return T(function(a,b){e&&(a.OFFSET=h);return h})}if(a in f){var k=f[a];return ha(k,function(b,c){var d=b.invoke(c,k);e&&(b.OFFSET=d,n.optional(function(){b.assert(c,d+">=0","invalid "+a)}));return d})}return e&&g?T(function(a,b){a.OFFSET="0";return 0}):null}var d=a["static"],f=a.dynamic,g=function(){if("elements"in d){var a=d.elements;Wa(a)?a=e.getElements(e.create(a,
!0)):a&&(a=e.getElements(a),n.command(a,"invalid elements",b.commandStr));var c=T(function(b,c){if(a){var d=b.link(a);return b.ELEMENTS=d}return b.ELEMENTS=null});c.value=a;return c}if("elements"in f){var g=f.elements;return ha(g,function(a,b){var c=a.shared,d=c.isBufferArgs,c=c.elements,f=a.invoke(b,g),e=b.def("null"),d=b.def(d,"(",f,")"),h=a.cond(d).then(e,"=",c,".createStream(",f,");")["else"](e,"=",c,".getElements(",f,");");n.optional(function(){a.assert(h["else"],"!"+f+"||"+e,"invalid elements")});
b.entry(h);b.exit(a.cond(d).then(c,".destroyStream(",e,");"));return a.ELEMENTS=e})}return null}(),h=c("offset",!0);return{elements:g,primitive:function(){if("primitive"in d){var a=d.primitive;n.commandParameter(a,Aa,"invalid primitve",b.commandStr);return T(function(b,c){return Aa[a]})}if("primitive"in f){var c=f.primitive;return ha(c,function(a,b){var d=a.constants.primTypes,f=a.invoke(b,c);n.optional(function(){a.assert(b,f+" in "+d,"invalid primitive, must be one of "+Object.keys(Aa))});return b.def(d,
"[",f,"]")})}return g?va(g)?g.value?T(function(a,b){return b.def(a.ELEMENTS,".primType")}):T(function(){return 4}):new ia(g.thisDep,g.contextDep,g.propDep,function(a,b){var c=a.ELEMENTS;return b.def(c,"?",c,".primType:",4)}):null}(),count:function(){if("count"in d){var a=d.count|0;n.command("number"===typeof a&&0<=a,"invalid vertex count",b.commandStr);return T(function(){return a})}if("count"in f){var c=f.count;return ha(c,function(a,b){var d=a.invoke(b,c);n.optional(function(){a.assert(b,"typeof "+
d+'==="number"&&'+d+">=0&&"+d+"===("+d+"|0)","invalid vertex count")});return d})}if(g){if(va(g)){if(g)return h?new ia(h.thisDep,h.contextDep,h.propDep,function(a,b){var c=b.def(a.ELEMENTS,".vertCount-",a.OFFSET);n.optional(function(){a.assert(b,c+">=0","invalid vertex offset/element buffer too small")});return c}):T(function(a,b){return b.def(a.ELEMENTS,".vertCount")});var e=T(function(){return-1});n.optional(function(){e.MISSING=!0});return e}var k=new ia(g.thisDep||h.thisDep,g.contextDep||h.contextDep,
g.propDep||h.propDep,function(a,b){var c=a.ELEMENTS;return a.OFFSET?b.def(c,"?",c,".vertCount-",a.OFFSET,":-1"):b.def(c,"?",c,".vertCount:-1")});n.optional(function(){k.DYNAMIC=!0});return k}return null}(),instances:c("instances",!1),offset:h}}function F(a,b){var c=a["static"],f=a.dynamic,e={};La.forEach(function(a){function g(b,d){if(a in c){var k=b(c[a]);e[h]=T(function(){return k})}else if(a in f){var l=f[a];e[h]=ha(l,function(a,b){return d(a,b,a.invoke(b,l))})}}var h=u(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return g(function(c){n.commandType(c,
"boolean",a,b.commandStr);return c},function(b,c,d){n.optional(function(){b.assert(c,"typeof "+d+'==="boolean"',"invalid flag "+a,b.commandStr)});return d});case "depth.func":return g(function(c){n.commandParameter(c,Ga,"invalid "+a,b.commandStr);return Ga[c]},function(b,c,d){var f=b.constants.compareFuncs;n.optional(function(){b.assert(c,d+" in "+f,"invalid "+a+", must be one of "+Object.keys(Ga))});return c.def(f,"[",d,"]")});case "depth.range":return g(function(a){n.command(Q(a)&&2===a.length&&
"number"===typeof a[0]&&"number"===typeof a[1]&&a[0]<=a[1],"depth range is 2d array",b.commandStr);return a},function(a,b,c){n.optional(function(){a.assert(b,a.shared.isArrayLike+"("+c+")&&"+c+".length===2&&typeof "+c+'[0]==="number"&&typeof '+c+'[1]==="number"&&'+c+"[0]<="+c+"[1]","depth range must be a 2d array")});var d=b.def("+",c,"[0]"),f=b.def("+",c,"[1]");return[d,f]});case "blend.func":return g(function(a){n.commandType(a,"object","blend.func",b.commandStr);var c="srcRGB"in a?a.srcRGB:a.src,
d="srcAlpha"in a?a.srcAlpha:a.src,f="dstRGB"in a?a.dstRGB:a.dst;a="dstAlpha"in a?a.dstAlpha:a.dst;n.commandParameter(c,qa,h+".srcRGB",b.commandStr);n.commandParameter(d,qa,h+".srcAlpha",b.commandStr);n.commandParameter(f,qa,h+".dstRGB",b.commandStr);n.commandParameter(a,qa,h+".dstAlpha",b.commandStr);n.command(-1===ub.indexOf(c+", "+f),"unallowed blending combination (srcRGB, dstRGB) = ("+c+", "+f+")",b.commandStr);return[qa[c],qa[f],qa[d],qa[a]]},function(b,c,d){function f(g,h){var k=c.def('"',g,
h,'" in ',d,"?",d,".",g,h,":",d,".",g);n.optional(function(){b.assert(c,k+" in "+e,"invalid "+a+"."+g+h+", must be one of "+Object.keys(qa))});return k}var e=b.constants.blendFuncs;n.optional(function(){b.assert(c,d+"&&typeof "+d+'==="object"',"invalid blend func, must be an object")});var g=f("src","RGB"),h=f("dst","RGB");n.optional(function(){b.assert(c,b.constants.invalidBlendCombinations+".indexOf("+g+'+", "+'+h+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var k=c.def(e,
"[",g,"]"),l=c.def(e,"[",f("src","Alpha"),"]"),t=c.def(e,"[",h,"]"),q=c.def(e,"[",f("dst","Alpha"),"]");return[k,t,l,q]});case "blend.equation":return g(function(c){if("string"===typeof c)return n.commandParameter(c,Z,"invalid "+a,b.commandStr),[Z[c],Z[c]];if("object"===typeof c)return n.commandParameter(c.rgb,Z,a+".rgb",b.commandStr),n.commandParameter(c.alpha,Z,a+".alpha",b.commandStr),[Z[c.rgb],Z[c.alpha]];n.commandRaise("invalid blend.equation",b.commandStr)},function(b,c,d){var f=b.constants.blendEquations,
e=c.def(),g=c.def(),h=b.cond("typeof ",d,'==="string"');n.optional(function(){function c(a,d,e){b.assert(a,e+" in "+f,"invalid "+d+", must be one of "+Object.keys(Z))}c(h.then,a,d);b.assert(h["else"],d+"&&typeof "+d+'==="object"',"invalid "+a);c(h["else"],a+".rgb",d+".rgb");c(h["else"],a+".alpha",d+".alpha")});h.then(e,"=",g,"=",f,"[",d,"];");h["else"](e,"=",f,"[",d,".rgb];",g,"=",f,"[",d,".alpha];");c(h);return[e,g]});case "blend.color":return g(function(a){n.command(Q(a)&&4===a.length,"blend.color must be a 4d array",
b.commandStr);return U(4,function(b){return+a[b]})},function(a,b,c){n.optional(function(){a.assert(b,a.shared.isArrayLike+"("+c+")&&"+c+".length===4","blend.color must be a 4d array")});return U(4,function(a){return b.def("+",c,"[",a,"]")})});case "stencil.mask":return g(function(a){n.commandType(a,"number",h,b.commandStr);return a|0},function(a,b,c){n.optional(function(){a.assert(b,"typeof "+c+'==="number"',"invalid stencil.mask")});return b.def(c,"|0")});case "stencil.func":return g(function(c){n.commandType(c,
"object",h,b.commandStr);var d=c.cmp||"keep",f=c.ref||0;c="mask"in c?c.mask:-1;n.commandParameter(d,Ga,a+".cmp",b.commandStr);n.commandType(f,"number",a+".ref",b.commandStr);n.commandType(c,"number",a+".mask",b.commandStr);return[Ga[d],f,c]},function(a,b,c){var d=a.constants.compareFuncs;n.optional(function(){function f(){a.assert(b,Array.prototype.join.call(arguments,""),"invalid stencil.func")}f(c+"&&typeof ",c,'==="object"');f('!("cmp" in ',c,")||(",c,".cmp in ",d,")")});var f=b.def('"cmp" in ',
c,"?",d,"[",c,".cmp]",":",7680),e=b.def(c,".ref|0"),g=b.def('"mask" in ',c,"?",c,".mask|0:-1");return[f,e,g]});case "stencil.opFront":case "stencil.opBack":return g(function(c){n.commandType(c,"object",h,b.commandStr);var d=c.fail||"keep",f=c.zfail||"keep";c=c.zpass||"keep";n.commandParameter(d,wa,a+".fail",b.commandStr);n.commandParameter(f,wa,a+".zfail",b.commandStr);n.commandParameter(c,wa,a+".zpass",b.commandStr);return["stencil.opBack"===a?1029:1028,wa[d],wa[f],wa[c]]},function(b,c,d){function f(g){n.optional(function(){b.assert(c,
'!("'+g+'" in '+d+")||("+d+"."+g+" in "+e+")","invalid "+a+"."+g+", must be one of "+Object.keys(wa))});return c.def('"',g,'" in ',d,"?",e,"[",d,".",g,"]:",7680)}var e=b.constants.stencilOps;n.optional(function(){b.assert(c,d+"&&typeof "+d+'==="object"',"invalid "+a)});return["stencil.opBack"===a?1029:1028,f("fail"),f("zfail"),f("zpass")]});case "polygonOffset.offset":return g(function(a){n.commandType(a,"object",h,b.commandStr);var c=a.factor|0;a=a.units|0;n.commandType(c,"number",h+".factor",b.commandStr);
n.commandType(a,"number",h+".units",b.commandStr);return[c,a]},function(b,c,d){n.optional(function(){b.assert(c,d+"&&typeof "+d+'==="object"',"invalid "+a)});var f=c.def(d,".factor|0"),e=c.def(d,".units|0");return[f,e]});case "cull.face":return g(function(a){var c=0;"front"===a?c=1028:"back"===a&&(c=1029);n.command(!!c,h,b.commandStr);return c},function(a,b,c){n.optional(function(){a.assert(b,c+'==="front"||'+c+'==="back"',"invalid cull.face")});return b.def(c,'==="front"?',1028,":",1029)});case "lineWidth":return g(function(a){n.command("number"===
typeof a&&a>=d.lineWidthDims[0]&&a<=d.lineWidthDims[1],"invalid line width, must positive number between "+d.lineWidthDims[0]+" and "+d.lineWidthDims[1],b.commandStr);return a},function(a,b,c){n.optional(function(){a.assert(b,"typeof "+c+'==="number"&&'+c+">="+d.lineWidthDims[0]+"&&"+c+"<="+d.lineWidthDims[1],"invalid line width")});return c});case "frontFace":return g(function(a){n.commandParameter(a,db,h,b.commandStr);return db[a]},function(a,b,c){n.optional(function(){a.assert(b,c+'==="cw"||'+
c+'==="ccw"',"invalid frontFace, must be one of cw,ccw")});return b.def(c+'==="cw"?2304:2305')});case "colorMask":return g(function(a){n.command(Q(a)&&4===a.length,"color.mask must be length 4 array",b.commandStr);return a.map(function(a){return!!a})},function(a,b,c){n.optional(function(){a.assert(b,a.shared.isArrayLike+"("+c+")&&"+c+".length===4","invalid color.mask")});return U(4,function(a){return"!!"+c+"["+a+"]"})});case "sample.coverage":return g(function(a){n.command("object"===typeof a&&a,
h,b.commandStr);var c="value"in a?a.value:1;a=!!a.invert;n.command("number"===typeof c&&0<=c&&1>=c,"sample.coverage.value must be a number between 0 and 1",b.commandStr);return[c,a]},function(a,b,c){n.optional(function(){a.assert(b,c+"&&typeof "+c+'==="object"',"invalid sample.coverage")});var d=b.def('"value" in ',c,"?+",c,".value:1"),f=b.def("!!",c,".invert");return[d,f]})}});return e}function D(a,b){var c=a["static"],d=a.dynamic,f={};Object.keys(c).forEach(function(a){var d=c[a],e;if("number"===
typeof d||"boolean"===typeof d)e=T(function(){return d});else if("function"===typeof d){var g=d._reglType;"texture2d"===g||"textureCube"===g?e=T(function(a){return a.link(d)}):"framebuffer"===g||"framebufferCube"===g?(n.command(0<d.color.length,'missing color attachment for framebuffer sent to uniform "'+a+'"',b.commandStr),e=T(function(a){return a.link(d.color[0])})):n.commandRaise('invalid data for uniform "'+a+'"',b.commandStr)}else Q(d)?e=T(function(b){return b.global.def("[",U(d.length,function(c){n.command("number"===
typeof d[c]||"boolean"===typeof d[c],"invalid uniform "+a,b.commandStr);return d[c]}),"]")}):n.commandRaise('invalid or missing data for uniform "'+a+'"',b.commandStr);e.value=d;f[a]=e});Object.keys(d).forEach(function(a){var b=d[a];f[a]=ha(b,function(a,c){return a.invoke(c,b)})});return f}function G(a,c){var d=a["static"],e=a.dynamic,g={};Object.keys(d).forEach(function(a){var e=d[a],h=b.id(a),k=new Y;if(Wa(e))k.state=1,k.buffer=f.getBuffer(f.create(e,34962,!1,!0)),k.type=0;else{var l=f.getBuffer(e);
if(l)k.state=1,k.buffer=l,k.type=0;else if(n.command("object"===typeof e&&e,"invalid data for attribute "+a,c.commandStr),e.constant){var t=e.constant;k.buffer="null";k.state=2;"number"===typeof t?k.x=t:(n.command(Q(t)&&0<t.length&&4>=t.length,"invalid constant for attribute "+a,c.commandStr),Ha.forEach(function(a,b){b<t.length&&(k[a]=t[b])}))}else{l=Wa(e.buffer)?f.getBuffer(f.create(e.buffer,34962,!1,!0)):f.getBuffer(e.buffer);n.command(!!l,'missing buffer for attribute "'+a+'"',c.commandStr);var q=
e.offset|0;n.command(0<=q,'invalid offset for attribute "'+a+'"',c.commandStr);var I=e.stride|0;n.command(0<=I&&256>I,'invalid stride for attribute "'+a+'", must be integer betweeen [0, 255]',c.commandStr);var p=e.size|0;n.command(!("size"in e)||0<p&&4>=p,'invalid size for attribute "'+a+'", must be 1,2,3,4',c.commandStr);var C=!!e.normalized,r=0;"type"in e&&(n.commandParameter(e.type,Ja,"invalid type for attribute "+a,c.commandStr),r=Ja[e.type]);var w=e.divisor|0;"divisor"in e&&(n.command(0===w||
Da,'cannot specify divisor for attribute "'+a+'", instancing not supported',c.commandStr),n.command(0<=w,'invalid divisor for attribute "'+a+'"',c.commandStr));n.optional(function(){var b=c.commandStr,d="buffer offset divisor normalized type size stride".split(" ");Object.keys(e).forEach(function(c){n.command(0<=d.indexOf(c),'unknown parameter "'+c+'" for attribute pointer "'+a+'" (valid parameters are '+d+")",b)})});k.buffer=l;k.state=1;k.size=p;k.normalized=C;k.type=r||l.dtype;k.offset=q;k.stride=
I;k.divisor=w}}g[a]=T(function(a,b){var c=a.attribCache;if(h in c)return c[h];var d={isStream:!1};Object.keys(k).forEach(function(a){d[a]=k[a]});k.buffer&&(d.buffer=a.link(k.buffer),d.type=d.type||d.buffer+".dtype");return c[h]=d})});Object.keys(e).forEach(function(a){var b=e[a];g[a]=ha(b,function(c,d){function f(a){d(l[a],"=",e,".",a,"|0;")}var e=c.invoke(d,b),g=c.shared,h=g.isBufferArgs,k=g.buffer;n.optional(function(){c.assert(d,e+"&&(typeof "+e+'==="object"||typeof '+e+'==="function")&&('+h+"("+
e+")||"+k+".getBuffer("+e+")||"+k+".getBuffer("+e+".buffer)||"+h+"("+e+'.buffer)||("constant" in '+e+"&&(typeof "+e+'.constant==="number"||'+g.isArrayLike+"("+e+".constant))))",'invalid dynamic attribute "'+a+'"')});var l={isStream:d.def(!1)},t=new Y;t.state=1;Object.keys(t).forEach(function(a){l[a]=d.def(""+t[a])});var q=l.buffer,I=l.type;d("if(",h,"(",e,")){",l.isStream,"=true;",q,"=",k,".createStream(",34962,",",e,");",I,"=",q,".dtype;","}else{",q,"=",k,".getBuffer(",e,");","if(",q,"){",I,"=",
q,".dtype;",'}else if("constant" in ',e,"){",l.state,"=",2,";","if(typeof "+e+'.constant === "number"){',l[Ha[0]],"=",e,".constant;",Ha.slice(1).map(function(a){return l[a]}).join("="),"=0;","}else{",Ha.map(function(a,b){return l[a]+"="+e+".constant.length>="+b+"?"+e+".constant["+b+"]:0;"}).join(""),"}}else{","if(",h,"(",e,".buffer)){",q,"=",k,".createStream(",34962,",",e,".buffer);","}else{",q,"=",k,".getBuffer(",e,".buffer);","}",I,'="type" in ',e,"?",g.glTypes,"[",e,".type]:",q,".dtype;",l.normalized,
"=!!",e,".normalized;");f("size");f("offset");f("stride");f("divisor");d("}}");d.exit("if(",l.isStream,"){",k,".destroyStream(",q,");","}");return l})});return g}function J(a){var b=a["static"],c=a.dynamic,d={};Object.keys(b).forEach(function(a){var c=b[a];d[a]=T(function(a,b){return"number"===typeof c||"boolean"===typeof c?""+c:a.link(c)})});Object.keys(c).forEach(function(a){var b=c[a];d[a]=ha(b,function(a,c){return a.invoke(c,b)})});return d}function N(a,b,c,d,e){function f(a){var b=l[a];b&&(q[a]=
b)}var g=a["static"],h=a.dynamic;n.optional(function(){function a(c){Object.keys(c).forEach(function(a){n.command(0<=b.indexOf(a),'unknown parameter "'+a+'"',e.commandStr)})}var b="framebuffer vert frag elements primitive offset count instances profile".split(" ").concat(La);a(g);a(h)});var k=z(a,e),l=A(a,k,e),t=E(a,e),q=F(a,e),p=H(a,e);f("viewport");f(u("scissor.box"));var C=0<Object.keys(q).length,k={framebuffer:k,draw:t,shader:p,state:q,dirty:C};k.profile=y(a,e);k.uniforms=D(c,e);k.attributes=
G(b,e);k.context=J(d,e);return k}function P(a,b,c){var d=a.shared.context,e=a.scope();Object.keys(c).forEach(function(f){b.save(d,"."+f);e(d,".",f,"=",c[f].append(a,b),";")});b(e)}function K(a,b,c,d){var e=a.shared,f=e.gl,g=e.framebuffer,h;pa&&(h=b.def(e.extensions,".webgl_draw_buffers"));var k=a.constants,e=k.drawBuffer,k=k.backBuffer;a=c?c.append(a,b):b.def(g,".next");d||b("if(",a,"!==",g,".cur){");b("if(",a,"){",f,".bindFramebuffer(",36160,",",a,".framebuffer);");pa&&b(h,".drawBuffersWEBGL(",e,
"[",a,".colorAttachments.length]);");b("}else{",f,".bindFramebuffer(",36160,",null);");pa&&b(h,".drawBuffersWEBGL(",k,");");b("}",g,".cur=",a,";");d||b("}")}function W(a,b,c){var d=a.shared,e=d.gl,f=a.current,g=a.next,h=d.current,k=d.next,l=a.cond(h,".dirty");La.forEach(function(b){b=u(b);if(!(b in c.state)){var d,n;if(b in g){d=g[b];n=f[b];var t=U(sa[b].length,function(a){return l.def(d,"[",a,"]")});l(a.cond(t.map(function(a,b){return a+"!=="+n+"["+b+"]"}).join("||")).then(e,".",ua[b],"(",t,");",
t.map(function(a,b){return n+"["+b+"]="+a}).join(";"),";"))}else d=l.def(k,".",b),t=a.cond(d,"!==",h,".",b),l(t),b in ta?t(a.cond(d).then(e,".enable(",ta[b],");")["else"](e,".disable(",ta[b],");"),h,".",b,"=",d,";"):t(e,".",ua[b],"(",d,");",h,".",b,"=",d,";")}});0===Object.keys(c.state).length&&l(h,".dirty=false;");b(l)}function aa(a,b,c,d){var e=a.shared,f=a.current,g=e.current,h=e.gl;tb(Object.keys(c)).forEach(function(e){var k=c[e];if(!d||d(k)){var l=k.append(a,b);if(ta[e]){var n=ta[e];va(k)?l?
b(h,".enable(",n,");"):b(h,".disable(",n,");"):b(a.cond(l).then(h,".enable(",n,");")["else"](h,".disable(",n,");"));b(g,".",e,"=",l,";")}else if(Q(l)){var t=f[e];b(h,".",ua[e],"(",l,");",l.map(function(a,b){return t+"["+b+"]="+a}).join(";"),";")}else b(h,".",ua[e],"(",l,");",g,".",e,"=",l,";")}})}function S(a,b){Da&&(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays"))}function M(a,b,c,d,e){function f(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function g(a){p=
b.def();a(p,"=",f(),";");"string"===typeof e?a(n,".count+=",e,";"):a(n,".count++;");C&&(d?(r=b.def(),a(r,"=",q,".getNumPendingQueries();")):a(q,".beginQuery(",n,");"))}function h(a){a(n,".cpuTime+=",f(),"-",p,";");C&&(d?a(q,".pushScopeStats(",r,",",q,".getNumPendingQueries(),",n,");"):a(q,".endQuery();"))}function k(a){var c=b.def(t,".profile");b(t,".profile=",a,";");b.exit(t,".profile=",c,";")}var l=a.shared,n=a.stats,t=l.current,q=l.timer;c=c.profile;var p,r;if(c){if(va(c)){c.enable?(g(b),h(b.exit),
k("true")):k("false");return}c=c.append(a,b);k(c)}else c=b.def(t,".profile");l=a.block();g(l);b("if(",c,"){",l,"}");a=a.block();h(a);b.exit("if(",c,"){",a,"}")}function R(a,b,c,d,e){function f(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function g(c,d,e){function f(){b("if(!",t,".buffer){",l,".enableVertexAttribArray(",n,");}");var c=e.type,g;g=e.size?b.def(e.size,"||",d):d;b("if(",t,".type!==",
c,"||",t,".size!==",g,"||",r.map(function(a){return t+"."+a+"!=="+e[a]}).join("||"),"){",l,".bindBuffer(",34962,",",q,".buffer);",l,".vertexAttribPointer(",[n,g,c,e.normalized,e.stride,e.offset],");",t,".type=",c,";",t,".size=",g,";",r.map(function(a){return t+"."+a+"="+e[a]+";"}).join(""),"}");Da&&(c=e.divisor,b("if(",t,".divisor!==",c,"){",a.instancing,".vertexAttribDivisorANGLE(",[n,c],");",t,".divisor=",c,";}"))}function k(){b("if(",t,".buffer){",l,".disableVertexAttribArray(",n,");","}if(",Ha.map(function(a,
b){return t+"."+a+"!=="+p[b]}).join("||"),"){",l,".vertexAttrib4f(",n,",",p,");",Ha.map(function(a,b){return t+"."+a+"="+p[b]+";"}).join(""),"}")}var l=h.gl,n=b.def(c,".location"),t=b.def(h.attributes,"[",n,"]");c=e.state;var q=e.buffer,p=[e.x,e.y,e.z,e.w],r=["buffer","normalized","offset","stride"];1===c?f():2===c?k():(b("if(",c,"===",1,"){"),f(),b("}else{"),k(),b("}"))}var h=a.shared;d.forEach(function(d){var h=d.name,k=c.attributes[h],l;if(k){if(!e(k))return;l=k.append(a,b)}else{if(!e(wb))return;
var t=a.scopeAttrib(h);n.optional(function(){a.assert(b,t+".state","missing attribute "+h)});l={};Object.keys(new Y).forEach(function(a){l[a]=b.def(t,".",a)})}g(a.link(d),f(d.info.type),l)})}function O(a,c,d,e,f){for(var g=a.shared,h=g.gl,k,l=0;l<e.length;++l){var t=e[l],q=t.name,p=t.info.type,r=d.uniforms[q],t=a.link(t)+".location",C;if(r){if(!f(r))continue;if(va(r)){var w=r.value;n.command(null!==w&&"undefined"!==typeof w,'missing uniform "'+q+'"',a.commandStr);if(35678===p||35680===p)n.command("function"===
typeof w&&(35678===p&&("texture2d"===w._reglType||"framebuffer"===w._reglType)||35680===p&&("textureCube"===w._reglType||"framebufferCube"===w._reglType)),"invalid texture for uniform "+q,a.commandStr),r=a.link(w._texture||w.color[0]._texture),c(h,".uniform1i(",t,",",r+".bind());"),c.exit(r,".unbind();");else if(35674===p||35675===p||35676===p){n.optional(function(){n.command(Q(w),"invalid matrix for uniform "+q,a.commandStr);n.command(35674===p&&4===w.length||35675===p&&9===w.length||35676===p&&
16===w.length,"invalid length for matrix uniform "+q,a.commandStr)});var r=a.global.def("new Float32Array(["+Array.prototype.slice.call(w)+"])"),u=2;35675===p?u=3:35676===p&&(u=4);c(h,".uniformMatrix",u,"fv(",t,",false,",r,");")}else{switch(p){case 5126:n.commandType(w,"number","uniform "+q,a.commandStr);k="1f";break;case 35664:n.command(Q(w)&&2===w.length,"uniform "+q,a.commandStr);k="2f";break;case 35665:n.command(Q(w)&&3===w.length,"uniform "+q,a.commandStr);k="3f";break;case 35666:n.command(Q(w)&&
4===w.length,"uniform "+q,a.commandStr);k="4f";break;case 35670:n.commandType(w,"boolean","uniform "+q,a.commandStr);k="1i";break;case 5124:n.commandType(w,"number","uniform "+q,a.commandStr);k="1i";break;case 35671:n.command(Q(w)&&2===w.length,"uniform "+q,a.commandStr);k="2i";break;case 35667:n.command(Q(w)&&2===w.length,"uniform "+q,a.commandStr);k="2i";break;case 35672:n.command(Q(w)&&3===w.length,"uniform "+q,a.commandStr);k="3i";break;case 35668:n.command(Q(w)&&3===w.length,"uniform "+q,a.commandStr);
k="3i";break;case 35673:n.command(Q(w)&&4===w.length,"uniform "+q,a.commandStr);k="4i";break;case 35669:n.command(Q(w)&&4===w.length,"uniform "+q,a.commandStr),k="4i"}c(h,".uniform",k,"(",t,",",Q(w)?Array.prototype.slice.call(w):w,");")}continue}else C=r.append(a,c)}else{if(!f(wb))continue;C=c.def(g.uniforms,"[",b.id(q),"]")}35678===p?c("if(",C,"&&",C,'._reglType==="framebuffer"){',C,"=",C,".color[0];","}"):35680===p&&c("if(",C,"&&",C,'._reglType==="framebufferCube"){',C,"=",C,".color[0];","}");n.optional(function(){function b(d,
e){a.assert(c,d,'bad data or missing for uniform "'+q+'".  '+e)}function d(a){b("typeof "+C+'==="'+a+'"',"invalid type, expected "+a)}function e(c,d){b(g.isArrayLike+"("+C+")&&"+C+".length==="+c,"invalid vector, should have length "+c,a.commandStr)}function f(c){b("typeof "+C+'==="function"&&'+C+'._reglType==="texture'+(3553===c?"2d":"Cube")+'"',"invalid texture type",a.commandStr)}switch(p){case 5124:d("number");break;case 35667:e(2,"number");break;case 35668:e(3,"number");break;case 35669:e(4,"number");
break;case 5126:d("number");break;case 35664:e(2,"number");break;case 35665:e(3,"number");break;case 35666:e(4,"number");break;case 35670:d("boolean");break;case 35671:e(2,"boolean");break;case 35672:e(3,"boolean");break;case 35673:e(4,"boolean");break;case 35674:e(4,"number");break;case 35675:e(9,"number");break;case 35676:e(16,"number");break;case 35678:f(3553);break;case 35680:f(34067)}});r=1;switch(p){case 35678:case 35680:r=c.def(C,"._texture");c(h,".uniform1i(",t,",",r,".bind());");c.exit(r,
".unbind();");continue;case 5124:case 35670:k="1i";break;case 35667:case 35671:k="2i";r=2;break;case 35668:case 35672:k="3i";r=3;break;case 35669:case 35673:k="4i";r=4;break;case 5126:k="1f";break;case 35664:k="2f";r=2;break;case 35665:k="3f";r=3;break;case 35666:k="4f";r=4;break;case 35674:k="Matrix2fv";break;case 35675:k="Matrix3fv";break;case 35676:k="Matrix4fv"}c(h,".uniform",k,"(",t,",");if("M"===k.charAt(0)){var t=Math.pow(p-35674+2,2),v=a.global.def("new Float32Array(",t,")");c("false,(Array.isArray(",
C,")||",C," instanceof Float32Array)?",C,":(",U(t,function(a){return v+"["+a+"]="+C+"["+a+"]"}),",",v,")")}else 1<r?c(U(r,function(a){return C+"["+a+"]"})):c(C);c(");")}}function V(a,b,c,d){function e(f){var g=t[f];return g?g.contextDep&&d.contextDynamic||g.propDep?g.append(a,c):g.append(a,b):b.def(l,".",f)}function f(){function a(){c(u,".drawElementsInstancedANGLE(",[p,C,v,r+"<<(("+v+"-5121)>>1)",w],");")}function b(){c(u,".drawArraysInstancedANGLE(",[p,r,C,w],");")}q?x?a():(c("if(",q,"){"),a(),
c("}else{"),b(),c("}")):b()}function g(){function a(){c(k+".drawElements("+[p,C,v,r+"<<(("+v+"-5121)>>1)"]+");")}function b(){c(k+".drawArrays("+[p,r,C]+");")}q?x?a():(c("if(",q,"){"),a(),c("}else{"),b(),c("}")):b()}var h=a.shared,k=h.gl,l=h.draw,t=d.draw,q=function(){var e=t.elements,f=b;if(e){if(e.contextDep&&d.contextDynamic||e.propDep)f=c;e=e.append(a,f)}else e=f.def(l,".","elements");e&&f("if("+e+")"+k+".bindBuffer(34963,"+e+".buffer.buffer);");return e}(),p=e("primitive"),r=e("offset"),C=function(){var e=
t.count,f,g=b;if(e){if(e.contextDep&&d.contextDynamic||e.propDep)g=c;f=e.append(a,g);n.optional(function(){e.MISSING&&a.assert(b,"false","missing vertex count");e.DYNAMIC&&a.assert(g,f+">=0","missing vertex count")})}else f=g.def(l,".","count"),n.optional(function(){a.assert(g,f+">=0","missing vertex count")});return f}();if("number"===typeof C){if(0===C)return}else c("if(",C,"){"),c.exit("}");var w,u;Da&&(w=e("instances"),u=a.instancing);var v=q+".type",x=t.elements&&va(t.elements);Da&&("number"!==
typeof w||0<=w)?"string"===typeof w?(c("if(",w,">0){"),f(),c("}else if(",w,"<0){"),g(),c("}")):f():g()}function X(a,b,c,d,e){var f=B();e=f.proc("body",e);n.optional(function(){f.commandStr=b.commandStr;f.command=f.link(b.commandStr)});Da&&(f.instancing=e.def(f.shared.extensions,".angle_instanced_arrays"));a(f,e,c,d);return f.compile().body}function ca(a,b,c,d){S(a,b);R(a,b,c,d.attributes,function(){return!0});O(a,b,c,d.uniforms,function(){return!0});V(a,b,b,c)}function ba(a,b){var c=a.proc("draw",
1);S(a,c);P(a,c,b.context);K(a,c,b.framebuffer);W(a,c,b);aa(a,c,b.state);M(a,c,b,!1,!0);var d=b.shader.progVar.append(a,c);c(a.shared.gl,".useProgram(",d,".program);");if(b.shader.program)ca(a,c,b,b.shader.program);else{var e=a.global.def("{}"),f=c.def(d,".id"),g=c.def(e,"[",f,"]");c(a.cond(g).then(g,".call(this,a0);")["else"](g,"=",e,"[",f,"]=",a.link(function(c){return X(ca,a,b,c,1)}),"(",d,");",g,".call(this,a0);"))}0<Object.keys(b.state).length&&c(a.shared.current,".dirty=true;")}function Na(a,
b,c,d){function e(){return!0}a.batchId="a1";S(a,b);R(a,b,c,d.attributes,e);O(a,b,c,d.uniforms,e);V(a,b,b,c)}function ya(a,b,c,d){function e(a){return a.contextDep&&g||a.propDep}function f(a){return!e(a)}S(a,b);var g=c.contextDep,h=b.def(),k=b.def();a.shared.props=k;a.batchId=h;var l=a.scope(),t=a.scope();b(l.entry,"for(",h,"=0;",h,"<","a1",";++",h,"){",k,"=","a0","[",h,"];",t,"}",l.exit);c.needsContext&&P(a,t,c.context);c.needsFramebuffer&&K(a,t,c.framebuffer);aa(a,t,c.state,e);c.profile&&e(c.profile)&&
M(a,t,c,!1,!0);d?(R(a,l,c,d.attributes,f),R(a,t,c,d.attributes,e),O(a,l,c,d.uniforms,f),O(a,t,c,d.uniforms,e),V(a,l,t,c)):(b=a.global.def("{}"),d=c.shader.progVar.append(a,t),k=t.def(d,".id"),l=t.def(b,"[",k,"]"),t(a.shared.gl,".useProgram(",d,".program);","if(!",l,"){",l,"=",b,"[",k,"]=",a.link(function(b){return X(Na,a,c,b,2)}),"(",d,");}",l,".call(this,a0[",h,"],",h,");"))}function za(a,b){function c(a){return a.contextDep&&e||a.propDep}var d=a.proc("batch",2);a.batchId="0";S(a,d);var e=!1,f=!0;
Object.keys(b.context).forEach(function(a){e=e||b.context[a].propDep});e||(P(a,d,b.context),f=!1);var g=b.framebuffer,h=!1;g?(g.propDep?e=h=!0:g.contextDep&&e&&(h=!0),h||K(a,d,g)):K(a,d,null);b.state.viewport&&b.state.viewport.propDep&&(e=!0);W(a,d,b);aa(a,d,b.state,function(a){return!c(a)});b.profile&&c(b.profile)||M(a,d,b,!1,"a1");b.contextDep=e;b.needsContext=f;b.needsFramebuffer=h;f=b.shader.progVar;if(f.contextDep&&e||f.propDep)ya(a,d,b,null);else if(f=f.append(a,d),d(a.shared.gl,".useProgram(",
f,".program);"),b.shader.program)ya(a,d,b,b.shader.program);else{var g=a.global.def("{}"),h=d.def(f,".id"),k=d.def(g,"[",h,"]");d(a.cond(k).then(k,".call(this,a0,a1);")["else"](k,"=",g,"[",h,"]=",a.link(function(c){return X(ya,a,b,c,2)}),"(",f,");",k,".call(this,a0,a1);"))}0<Object.keys(b.state).length&&d(a.shared.current,".dirty=true;")}function ab(a,c){function d(b){var g=c.shader[b];g&&e.set(f.shader,"."+b,g.append(a,e))}var e=a.proc("scope",3);a.batchId="a2";var f=a.shared,g=f.current;P(a,e,c.context);
c.framebuffer&&c.framebuffer.append(a,e);tb(Object.keys(c.state)).forEach(function(b){var d=c.state[b].append(a,e);Q(d)?d.forEach(function(c,d){e.set(a.next[b],"["+d+"]",c)}):e.set(f.next,"."+b,d)});M(a,e,c,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(b){var d=c.draw[b];d&&e.set(f.draw,"."+b,""+d.append(a,e))});Object.keys(c.uniforms).forEach(function(d){e.set(f.uniforms,"["+b.id(d)+"]",c.uniforms[d].append(a,e))});Object.keys(c.attributes).forEach(function(b){var d=
c.attributes[b].append(a,e),f=a.scopeAttrib(b);Object.keys(new Y).forEach(function(a){e.set(f,"."+a,d[a])})});d("vert");d("frag");0<Object.keys(c.state).length&&(e(g,".dirty=true;"),e.exit(g,".dirty=true;"));e("a1(",a.shared.context,",a0,",a.batchId,");")}function fa(a){if("object"===typeof a&&!Q(a)){for(var b=Object.keys(a),c=0;c<b.length;++c)if(ma.isDynamic(a[b[c]]))return!0;return!1}}function ea(a,b,c){function d(a,b){g.forEach(function(c){var d=e[c];ma.isDynamic(d)&&(d=a.invoke(b,d),b(t,".",c,
"=",d,";"))})}var e=b["static"][c];if(e&&fa(e)){var f=a.global,g=Object.keys(e),h=!1,k=!1,l=!1,t=a.global.def("{}");g.forEach(function(b){var c=e[b];if(ma.isDynamic(c))"function"===typeof c&&(c=e[b]=ma.unbox(c)),b=ha(c,null),h=h||b.thisDep,l=l||b.propDep,k=k||b.contextDep;else{f(t,".",b,"=");switch(typeof c){case "number":f(c);break;case "string":f('"',c,'"');break;case "object":Array.isArray(c)&&f("[",c.join(),"]");break;default:f(a.link(c))}f(";")}});b.dynamic[c]=new ma.DynamicVariable(4,{thisDep:h,
contextDep:k,propDep:l,ref:t,append:d});delete b["static"][c]}}var Y=l.Record,Z={add:32774,subtract:32778,"reverse subtract":32779};c.ext_blend_minmax&&(Z.min=32775,Z.max=32776);var Da=c.angle_instanced_arrays,pa=c.webgl_draw_buffers,sa={dirty:!0,profile:w.profile},Ka={},La=[],ta={},ua={};v("dither",3024);v("blend.enable",3042);x("blend.color","blendColor",[0,0,0,0]);x("blend.equation","blendEquationSeparate",[32774,32774]);x("blend.func","blendFuncSeparate",[1,0,1,0]);v("depth.enable",2929,!0);x("depth.func",
"depthFunc",513);x("depth.range","depthRange",[0,1]);x("depth.mask","depthMask",!0);x("colorMask","colorMask",[!0,!0,!0,!0]);v("cull.enable",2884);x("cull.face","cullFace",1029);x("frontFace","frontFace",2305);x("lineWidth","lineWidth",1);v("polygonOffset.enable",32823);x("polygonOffset.offset","polygonOffset",[0,0]);v("sample.alpha",32926);v("sample.enable",32928);x("sample.coverage","sampleCoverage",[1,!1]);v("stencil.enable",2960);x("stencil.mask","stencilMask",-1);x("stencil.func","stencilFunc",
[519,0,-1]);x("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);x("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);v("scissor.enable",3089);x("scissor.box","scissor",[0,0,a.drawingBufferWidth,a.drawingBufferHeight]);x("viewport","viewport",[0,0,a.drawingBufferWidth,a.drawingBufferHeight]);var $a={gl:a,context:r,strings:b,next:Ka,current:sa,draw:p,elements:e,buffer:f,shader:q,attributes:l.state,uniforms:k,framebuffer:h,extensions:c,timer:C,isBufferArgs:Wa},ja={primTypes:Aa,compareFuncs:Ga,
blendFuncs:qa,blendEquations:Z,stencilOps:wa,glTypes:Ja,orientationType:db};n.optional(function(){$a.isArrayLike=Q});pa&&(ja.backBuffer=[1029],ja.drawBuffer=U(d.maxDrawbuffers,function(a){return 0===a?[0]:U(a,function(a){return 36064+a})}));var oa=0;return{next:Ka,current:sa,procs:function(){var b=B(),c=b.proc("poll"),e=b.proc("refresh"),f=b.block();c(f);e(f);var g=b.shared,h=g.gl,k=g.next,l=g.current;f(l,".dirty=false;");K(b,c);K(b,e,null,!0);var n=a.getExtension("angle_instanced_arrays"),q;n&&(q=
b.link(n));for(var p=0;p<d.maxAttributes;++p){var r=e.def(g.attributes,"[",p,"]"),C=b.cond(r,".buffer");C.then(h,".enableVertexAttribArray(",p,");",h,".bindBuffer(",34962,",",r,".buffer.buffer);",h,".vertexAttribPointer(",p,",",r,".size,",r,".type,",r,".normalized,",r,".stride,",r,".offset);")["else"](h,".disableVertexAttribArray(",p,");",h,".vertexAttrib4f(",p,",",r,".x,",r,".y,",r,".z,",r,".w);",r,".buffer=null;");e(C);n&&e(q,".vertexAttribDivisorANGLE(",p,",",r,".divisor);")}Object.keys(ta).forEach(function(a){var d=
ta[a],g=f.def(k,".",a),t=b.block();t("if(",g,"){",h,".enable(",d,")}else{",h,".disable(",d,")}",l,".",a,"=",g,";");e(t);c("if(",g,"!==",l,".",a,"){",t,"}")});Object.keys(ua).forEach(function(a){var d=ua[a],g=sa[a],t,n,q=b.block();q(h,".",d,"(");Q(g)?(d=g.length,t=b.global.def(k,".",a),n=b.global.def(l,".",a),q(U(d,function(a){return t+"["+a+"]"}),");",U(d,function(a){return n+"["+a+"]="+t+"["+a+"];"}).join("")),c("if(",U(d,function(a){return t+"["+a+"]!=="+n+"["+a+"]"}).join("||"),"){",q,"}")):(t=
f.def(k,".",a),n=f.def(l,".",a),q(t,");",l,".",a,"=",t,";"),c("if(",t,"!==",n,"){",q,"}"));e(q)});return b.compile()}(),compile:function(a,b,c,d,e){var f=B();f.stats=f.link(e);Object.keys(b["static"]).forEach(function(a){ea(f,b,a)});Rb.forEach(function(b){ea(f,a,b)});c=N(a,b,c,d,f);ba(f,c);ab(f,c);za(f,c);return f.compile()}}}function xb(a,b){for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}var Ia={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,
"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},X=function(a){return Object.prototype.toString.call(a)in Ia},S=function(a,b){for(var c=Object.keys(b),d=0;d<c.length;++d)a[c[d]]=b[c[d]];return a},yb="gl canvas container attributes pixelRatio extensions optionalExtensions profile onDone".split(" "),ba={};ba[5120]=ba[5121]=1;ba[5122]=ba[5123]=ba[36193]=ba[33635]=ba[32819]=
ba[32820]=2;ba[5124]=ba[5125]=ba[5126]=ba[34042]=4;var n=S(d,{optional:function(a){a()},raise:b,commandRaise:A,command:function(a,b,c){a||A(b,c||v())},parameter:function(a,d,f){a in d||b("unknown parameter ("+a+")"+e(f)+". possible values: "+Object.keys(d).join())},commandParameter:function(a,b,c,d){a in b||A("unknown parameter ("+a+")"+e(c)+". possible values: "+Object.keys(b).join(),d||v())},constructor:function(a){Object.keys(a).forEach(function(a){0>yb.indexOf(a)&&b('invalid regl constructor argument "'+
a+'". must be one of '+yb)})},type:function(a,d,f){typeof a!==d&&b("invalid parameter type"+e(f)+". expected "+d+", got "+typeof a)},commandType:z,isTypedArray:function(a,d){X(a)||b("invalid parameter type"+e(d)+". must be a typed array")},nni:function(a,d){0<=a&&(a|0)===a||b("invalid parameter type, ("+a+")"+e(d)+". must be a nonnegative integer")},oneOf:f,shaderError:function(a,b,c,e,f){if(!a.getShaderParameter(b,a.COMPILE_STATUS)){b=a.getShaderInfoLog(b);a=e===a.FRAGMENT_SHADER?"fragment":"vertex";
z(c,"string",a+" shader source must be a string",f);var g=r(c,f);c=u(b);y(g,c);Object.keys(g).forEach(function(a){function b(a,c){d.push(a);e.push(c||"")}var c=g[a];if(c.hasErrors){var d=[""],e=[""];b("file number "+a+": "+c.name+"\n","color:red;text-decoration:underline;font-weight:bold");c.lines.forEach(function(a){if(0<a.errors.length){b(k(a.number,4)+"|  ","background-color:yellow; font-weight:bold");b(a.line+"\n","color:red; background-color:yellow; font-weight:bold");var c=0;a.errors.forEach(function(d){d=
d.message;var e=/^\s*\'(.*)\'\s*\:\s*(.*)$/.exec(d);if(e){var f=e[1];d=e[2];switch(f){case "assign":f="="}c=Math.max(a.line.indexOf(f,c),0)}else c=0;b(k("| ",6));b(k("^^^",c+3)+"\n","font-weight:bold");b(k("| ",6));b(d+"\n","font-weight:bold")});b(k("| ",6)+"\n")}else b(k(a.number,4)+"|  "),b(a.line+"\n","color:red")});"undefined"!==typeof document?(e[0]=d.join("%c"),console.log.apply(console,e)):console.log(d.join(""))}});d.raise("Error compiling "+a+" shader, "+g[0].name)}},linkError:function(a,
b,c,e,f){a.getProgramParameter(b,a.LINK_STATUS)||(a=a.getProgramInfoLog(b),c=r(c,f),e='Error linking program with vertex shader, "'+r(e,f)[0].name+'", and fragment shader "'+c[0].name+'"',"undefined"!==typeof document?console.log("%c"+e+"\n%c"+a,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(e+"\n"+a),d.raise(e))},callSite:g,saveCommandRef:p,saveDrawInfo:function(a,b,c,d){function e(a){return a?d.id(a):0}function f(a,b){Object.keys(b).forEach(function(b){a[d.id(b)]=
!0})}p(a);a._fragId=e(a["static"].frag);a._vertId=e(a["static"].vert);var g=a._uniformSet={};f(g,b["static"]);f(g,b.dynamic);b=a._attributeSet={};f(b,c["static"]);f(b,c.dynamic);a._hasCount="count"in a["static"]||"count"in a.dynamic||"elements"in a["static"]||"elements"in a.dynamic},framebufferFormat:function(a,b,c){a.texture?f(a.texture._texture.internalformat,b,"unsupported texture format for attachment"):f(a.renderbuffer._renderbuffer.format,c,"unsupported renderbuffer format for attachment")},
guessCommand:v,texture2D:function(a,b,c){var e=b.width,f=b.height,g=b.channels;d(0<e&&e<=c.maxTextureSize&&0<f&&f<=c.maxTextureSize,"invalid texture shape");33071===a.wrapS&&33071===a.wrapT||d(!(e&e-1)&&!!e&&!(f&f-1)&&!!f,"incompatible wrap mode for texture, both width and height must be power of 2");1===b.mipmask?1!==e&&1!==f&&d(9984!==a.minFilter&&9986!==a.minFilter&&9985!==a.minFilter&&9987!==a.minFilter,"min filter requires mipmap"):(d(!(e&e-1)&&!!e&&!(f&f-1)&&!!f,"texture must be a square power of 2 to support mipmapping"),
d(b.mipmask===(e<<1)-1,"missing or incomplete mipmap data"));5126===b.type&&(0>c.extensions.indexOf("oes_texture_float_linear")&&d(9728===a.minFilter&&9728===a.magFilter,"filter not supported, must enable oes_texture_float_linear"),d(!a.genMipmaps,"mipmap generation not supported with float textures"));var k=b.images;for(c=0;16>c;++c)if(k[c]){var l=e>>c,n=f>>c;d(b.mipmask&1<<c,"missing mipmap data");var q=k[c];d(q.width===l&&q.height===n,"invalid shape for mip images");d(q.format===b.format&&q.internalformat===
b.internalformat&&q.type===b.type,"incompatible type for mip image");!q.compressed&&q.data&&(l=Math.ceil(B(q.type,g)*l/q.unpackAlignment)*q.unpackAlignment,d(q.data.byteLength===l*n,"invalid data for image, buffer size is inconsistent with image format"))}else a.genMipmaps||d(0===(b.mipmask&1<<c),"extra mipmap data");b.compressed&&d(!a.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(a,b,c,e){var f=a.width,g=a.height,k=a.channels;d(0<f&&f<=e.maxTextureSize&&
0<g&&g<=e.maxTextureSize,"invalid texture shape");d(f===g,"cube map must be square");d(33071===b.wrapS&&33071===b.wrapT,"wrap mode not supported by cube map");for(e=0;e<c.length;++e){var l=c[e];d(l.width===f&&l.height===g,"inconsistent cube map face shape");b.genMipmaps&&(d(!l.compressed,"can not generate mipmap for compressed textures"),d(1===l.mipmask,"can not specify mipmaps and generate mipmaps"));for(var n=l.images,q=0;16>q;++q){var p=n[q];if(p){var r=f>>q,C=g>>q;d(l.mipmask&1<<q,"missing mipmap data");
d(p.width===r&&p.height===C,"invalid shape for mip images");d(p.format===a.format&&p.internalformat===a.internalformat&&p.type===a.type,"incompatible type for mip image");p.compressed||p.data&&d(p.data.byteLength===r*C*Math.max(B(p.type,k),p.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format")}}}}}),Cb=0,ma={DynamicVariable:F,define:function(a,b){return new F(a,w(b+""))},isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof F},unbox:function(a,
b){return"function"===typeof a?new F(0,a):a},accessor:w},eb={next:"function"===typeof requestAnimationFrame?function(a){return requestAnimationFrame(a)}:function(a){return setTimeout(a,16)},cancel:"function"===typeof cancelAnimationFrame?function(a){return cancelAnimationFrame(a)}:clearTimeout},zb="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},Sb=function(a,b){var c=1;b.ext_texture_filter_anisotropic&&(c=a.getParameter(34047));var d=
1,e=1;b.webgl_draw_buffers&&(d=a.getParameter(34852),e=a.getParameter(36063));return{colorBits:[a.getParameter(3410),a.getParameter(3411),a.getParameter(3412),a.getParameter(3413)],depthBits:a.getParameter(3414),stencilBits:a.getParameter(3415),subpixelBits:a.getParameter(3408),extensions:Object.keys(b).filter(function(a){return!!b[a]}),maxAnisotropic:c,maxDrawbuffers:d,maxColorAttachments:e,pointSizeDims:a.getParameter(33901),lineWidthDims:a.getParameter(33902),maxViewportDims:a.getParameter(3386),
maxCombinedTextureUnits:a.getParameter(35661),maxCubeMapSize:a.getParameter(34076),maxRenderbufferSize:a.getParameter(34024),maxTextureUnits:a.getParameter(34930),maxTextureSize:a.getParameter(3379),maxAttributes:a.getParameter(34921),maxVertexUniforms:a.getParameter(36347),maxVertexTextureUnits:a.getParameter(35660),maxVaryingVectors:a.getParameter(36348),maxFragmentUniforms:a.getParameter(36349),glsl:a.getParameter(35724),renderer:a.getParameter(7937),vendor:a.getParameter(7936),version:a.getParameter(7938)}},
Y=function(a){return Object.keys(a).map(function(b){return a[b]})},kb=U(8,function(){return[]}),V={alloc:O,free:ja,allocType:function(a,b){var c=null;switch(a){case 5120:c=new Int8Array(O(b),0,b);break;case 5121:c=new Uint8Array(O(b),0,b);break;case 5122:c=new Int16Array(O(2*b),0,b);break;case 5123:c=new Uint16Array(O(2*b),0,b);break;case 5124:c=new Int32Array(O(4*b),0,b);break;case 5125:c=new Uint32Array(O(4*b),0,b);break;case 5126:c=new Float32Array(O(4*b),0,b);break;default:return null}return c.length!==
b?c.subarray(0,b):c},freeType:function(a){ja(a.buffer)}},Ta={shape:function(a){for(var b=[];a.length;a=a[0])b.push(a.length);return b},flatten:function(a,b,c,d){var e=1;if(b.length)for(var f=0;f<b.length;++f)e*=b[f];else e=0;c=d||V.allocType(c,e);switch(b.length){case 0:break;case 1:d=b[0];for(b=0;b<d;++b)c[b]=a[b];break;case 2:d=b[0];b=b[1];for(f=e=0;f<d;++f)for(var g=a[f],h=0;h<b;++h)c[e++]=g[h];break;case 3:ca(a,b[0],b[1],b[2],c,0);break;default:fb(a,b,0,c,0)}return c}},Ja={int8:5120,int16:5122,
int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126},Qa={dynamic:35048,stream:35040,"static":35044},Xa=Ta.flatten,lb=Ta.shape,oa=[];oa[5120]=1;oa[5122]=2;oa[5124]=4;oa[5121]=1;oa[5123]=2;oa[5125]=4;oa[5126]=4;var Aa={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},mb=new Float32Array(1),Db=new Uint32Array(mb.buffer),Gb=[9984,9986,9985,9987],Sa=[0,6409,6410,6407,6408],fa={};fa[6409]=fa[6406]=fa[6402]=1;fa[34041]=
fa[6410]=2;fa[6407]=fa[35904]=3;fa[6408]=fa[35906]=4;var Eb=Object.keys(Ia).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),Ca=[];Ca[5121]=1;Ca[5126]=4;Ca[36193]=2;Ca[5123]=2;Ca[5125]=4;var M=[];M[32854]=2;M[32855]=2;M[36194]=2;M[34041]=4;M[33776]=.5;M[33777]=.5;M[33778]=1;M[33779]=1;M[35986]=.5;M[35987]=1;M[34798]=1;M[35840]=.5;M[35841]=.25;M[35842]=.5;M[35843]=.25;M[36196]=.5;var ea=[];ea[32854]=2;ea[32855]=2;ea[36194]=
2;ea[33189]=2;ea[36168]=1;ea[34041]=4;ea[35907]=4;ea[34836]=16;ea[34842]=8;ea[34843]=6;var Tb=function(a,b,c,d,e){function f(a){this.id=l++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0;e.profile&&(this.stats={size:0})}function g(b){var c=b.renderbuffer;n(c,"must not double destroy renderbuffer");a.bindRenderbuffer(36161,null);a.deleteRenderbuffer(c);b.renderbuffer=null;b.refCount=0;delete q[b.id];d.renderbufferCount--}var h={rgba4:32854,rgb565:36194,"rgb5 a1":32855,
depth:33189,stencil:36168,"depth stencil":34041};b.ext_srgb&&(h.srgba=35907);b.ext_color_buffer_half_float&&(h.rgba16f=34842,h.rgb16f=34843);b.webgl_color_buffer_float&&(h.rgba32f=34836);var k=[];Object.keys(h).forEach(function(a){k[h[a]]=a});var l=0,q={};f.prototype.decRef=function(){0>=--this.refCount&&g(this)};e.profile&&(d.getTotalRenderbufferSize=function(){var a=0;Object.keys(q).forEach(function(b){a+=q[b].stats.size});return a});return{create:function(b,g){function l(b,d){var f=0,g=0,q=32854;
"object"===typeof b&&b?("shape"in b?(g=b.shape,n(Array.isArray(g)&&2<=g.length,"invalid renderbuffer shape"),f=g[0]|0,g=g[1]|0):("radius"in b&&(f=g=b.radius|0),"width"in b&&(f=b.width|0),"height"in b&&(g=b.height|0)),"format"in b&&(n.parameter(b.format,h,"invalid renderbuffer format"),q=h[b.format])):"number"===typeof b?(f=b|0,g="number"===typeof d?d|0:f):b?n.raise("invalid arguments to renderbuffer constructor"):f=g=1;n(0<f&&0<g&&f<=c.maxRenderbufferSize&&g<=c.maxRenderbufferSize,"invalid renderbuffer size");
if(f!==p.width||g!==p.height||q!==p.format)return l.width=p.width=f,l.height=p.height=g,p.format=q,a.bindRenderbuffer(36161,p.renderbuffer),a.renderbufferStorage(36161,q,f,g),e.profile&&(p.stats.size=ea[p.format]*p.width*p.height),l.format=k[p.format],l}var p=new f(a.createRenderbuffer());q[p.id]=p;d.renderbufferCount++;l(b,g);l.resize=function(b,d){var f=b|0,g=d|0||f;if(f===p.width&&g===p.height)return l;n(0<f&&0<g&&f<=c.maxRenderbufferSize&&g<=c.maxRenderbufferSize,"invalid renderbuffer size");
l.width=p.width=f;l.height=p.height=g;a.bindRenderbuffer(36161,p.renderbuffer);a.renderbufferStorage(36161,p.format,f,g);e.profile&&(p.stats.size=ea[p.format]*p.width*p.height);return l};l._reglType="renderbuffer";l._renderbuffer=p;e.profile&&(l.stats=p.stats);l.destroy=function(){p.decRef()};return l},clear:function(){Y(q).forEach(g)},restore:function(){Y(q).forEach(function(b){b.renderbuffer=a.createRenderbuffer();a.bindRenderbuffer(36161,b.renderbuffer);a.renderbufferStorage(36161,b.format,b.width,
b.height)});a.bindRenderbuffer(36161,null)}}},Kb=[6408],rb=[];rb[6408]=4;var Va=[];Va[5121]=1;Va[5126]=4;Va[36193]=2;var Lb=[32854,32855,36194,35907,34842,34843,34836],Jb={36053:"complete",36054:"incomplete attachment",36057:"incomplete dimensions",36055:"incomplete, missing attachment",36061:"unsupported"},Ha=["x","y","z","w"],Rb="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),qa={0:0,1:1,zero:0,one:1,"src color":768,
"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ub="constant color, constant alpha;one minus constant color, constant alpha;constant color, one minus constant alpha;one minus constant color, one minus constant alpha;constant alpha, constant color;constant alpha, one minus constant color;one minus constant alpha, constant color;one minus constant alpha, one minus constant color".split(";"),
Ga={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},wa={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},vb={frag:35632,vert:35633},db={cw:2304,ccw:2305},wb=new ia(!1,!1,!1,function(){}),Ub=function(a,b){function c(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function d(a,b,e){var f=
h.pop()||new c;f.startQueryIndex=a;f.endQueryIndex=b;f.sum=0;f.stats=e;k.push(f)}var e=b.ext_disjoint_timer_query;if(!e)return null;var f=[],g=[],h=[],k=[],l=[],q=[];return{beginQuery:function(a){var b=f.pop()||e.createQueryEXT();e.beginQueryEXT(35007,b);g.push(b);d(g.length-1,g.length,a)},endQuery:function(){e.endQueryEXT(35007)},pushScopeStats:d,update:function(){var a,b;a=g.length;if(0!==a){q.length=Math.max(q.length,a+1);l.length=Math.max(l.length,a+1);l[0]=0;var c=q[0]=0;for(b=a=0;b<g.length;++b){var d=
g[b];e.getQueryObjectEXT(d,34919)?(c+=e.getQueryObjectEXT(d,34918),f.push(d)):g[a++]=d;l[b+1]=c;q[b+1]=a}g.length=a;for(b=a=0;b<k.length;++b){var c=k[b],n=c.startQueryIndex,d=c.endQueryIndex;c.sum+=l[d]-l[n];n=q[n];d=q[d];d===n?(c.stats.gpuTime+=c.sum/1E6,h.push(c)):(c.startQueryIndex=n,c.endQueryIndex=d,k[a++]=c)}k.length=a}},getNumPendingQueries:function(){return g.length},clear:function(){f.push.apply(f,g);for(var a=0;a<f.length;a++)e.deleteQueryEXT(f[a]);g.length=0;f.length=0},restore:function(){g.length=
0;f.length=0}}};return function(a){function b(){if(0===R.length)A&&A.update(),ca=null;else{ca=eb.next(b);q();for(var a=R.length-1;0<=a;--a){var c=R[a];c&&c(D,null,0)}w.flush();A&&A.update()}}function c(){!ca&&0<R.length&&(ca=eb.next(b))}function d(){ca&&(eb.cancel(b),ca=null)}function e(a){a.preventDefault();v=!0;d();V.forEach(function(a){a()})}function f(a){w.getError();v=!1;x.restore();P.restore();K.restore();U.restore();aa.restore();M.restore();A&&A.restore();O.procs.refresh();c();X.forEach(function(a){a()})}
function g(a){function b(a){var c={},d={};Object.keys(a).forEach(function(b){var e=a[b];ma.isDynamic(e)?d[b]=ma.unbox(e,b):c[b]=e});return{dynamic:d,"static":c}}function c(a){for(;p.length<a;)p.push(null);return p}n(!!a,"invalid args to regl({...})");n.type(a,"object","invalid args to regl({...})");var d=b(a.context||{}),e=b(a.uniforms||{}),f=b(a.attributes||{}),h=b(function(a){function b(a){if(a in c){var d=c[a];delete c[a];Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=S({},a);delete c.uniforms;
delete c.attributes;delete c.context;"stencil"in c&&c.stencil.op&&(c.stencil.opBack=c.stencil.opFront=c.stencil.op,delete c.stencil.op);b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(a));a={gpuTime:0,cpuTime:0,count:0};var d=O.compile(h,f,e,d,a),k=d.draw,l=d.batch,q=d.scope,p=[];return S(function(a,b){var d;v&&n.raise("context lost");if("function"===typeof a)return q.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(d=0;d<a;++d)q.call(this,
null,b,d);else if(Array.isArray(a))for(d=0;d<a.length;++d)q.call(this,a[d],b,d);else return q.call(this,a,b,0);else if("number"===typeof a){if(0<a)return l.call(this,c(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return l.call(this,a,a.length)}else return k.call(this,a)},{stats:a})}function h(a,b){var c=0;O.procs.poll();var d=b.color;d&&(w.clearColor(+d[0]||0,+d[1]||0,+d[2]||0,+d[3]||0),c|=16384);"depth"in b&&(w.clearDepth(+b.depth),c|=256);"stencil"in b&&(w.clearStencil(b.stencil|0),c|=1024);
n(!!c,"called regl.clear with no buffer specified");w.clear(c)}function k(a){n.type(a,"function","regl.frame() callback must be a function");R.push(a);c();return{cancel:function(){function b(){var a=xb(R,b);R[a]=R[R.length-1];--R.length;0>=R.length&&d()}var c=xb(R,a);n(0<=c,"cannot cancel a frame twice");R[c]=b}}}function l(){var a=T.viewport,b=T.scissor_box;a[0]=a[1]=b[0]=b[1]=0;D.viewportWidth=D.framebufferWidth=D.drawingBufferWidth=a[2]=b[2]=w.drawingBufferWidth;D.viewportHeight=D.framebufferHeight=
D.drawingBufferHeight=a[3]=b[3]=w.drawingBufferHeight}function q(){D.tick+=1;D.time=r();l();O.procs.poll()}function p(){l();O.procs.refresh();A&&A.update()}function r(){return(zb()-H)/1E3}a=J(a);if(!a)return null;var w=a.gl,u=w.getContextAttributes(),v=w.isContextLost(),x=W(w,a);if(!x)return null;var B=C(),y={bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},z=x.extensions,A=Ub(w,z),H=zb(),E=w.drawingBufferWidth,F=w.drawingBufferHeight,
D={tick:0,time:0,viewportWidth:E,viewportHeight:F,framebufferWidth:E,framebufferHeight:F,drawingBufferWidth:E,drawingBufferHeight:F,pixelRatio:a.pixelRatio},G=Sb(w,z),K=Ab(w,y,a),N=Bb(w,z,K,y),E=Mb(w,z,G,K,B),P=Nb(w,B,y,a),U=Fb(w,z,G,function(){O.procs.poll()},D,y,a),aa=Tb(w,z,G,y,a),M=Ib(w,z,G,U,aa,y),O=Qb(w,B,z,G,K,N,U,M,{},E,P,{elements:null,primitive:4,count:-1,offset:0,instances:-1},D,A,a),B=Ob(w,M,O.procs.poll,D,u,z),T=O.next,Q=w.canvas,R=[],V=[],X=[],Y=[a.onDestroy],ca=null;Q&&(Q.addEventListener("webglcontextlost",
e,!1),Q.addEventListener("webglcontextrestored",f,!1));var ba=M.setFBO=g({framebuffer:ma.define.call(null,1,"framebuffer")});p();u=S(g,{clear:function(a){n("object"===typeof a&&a,"regl.clear() takes an object as input");if("framebuffer"in a)if(a.framebuffer&&"framebufferCube"===a.framebuffer_reglType)for(var b=0;6>b;++b)ba(S({framebuffer:a.framebuffer.faces[b]},a),h);else ba(a,h);else h(null,a)},prop:ma.define.bind(null,1),context:ma.define.bind(null,2),"this":ma.define.bind(null,3),draw:g({}),buffer:function(a){return K.create(a,
34962,!1,!1)},elements:function(a){return N.create(a,!1)},texture:U.create2D,cube:U.createCube,renderbuffer:aa.create,framebuffer:M.create,framebufferCube:M.createCube,attributes:u,frame:k,on:function(a,b){n.type(b,"function","listener callback must be a function");var c;switch(a){case "frame":return k(b);case "lost":c=V;break;case "restore":c=X;break;case "destroy":c=Y;break;default:n.raise("invalid event, must be one of frame,lost,restore,destroy")}c.push(b);return{cancel:function(){for(var a=0;a<
c.length;++a)if(c[a]===b){c[a]=c[c.length-1];c.pop();break}}}},limits:G,hasExtension:function(a){return 0<=G.extensions.indexOf(a.toLowerCase())},read:B,destroy:function(){R.length=0;d();Q&&(Q.removeEventListener("webglcontextlost",e),Q.removeEventListener("webglcontextrestored",f));P.clear();M.clear();aa.clear();U.clear();N.clear();K.clear();A&&A.clear();Y.forEach(function(a){a()})},_gl:w,_refresh:p,poll:function(){q();A&&A.update()},now:r,stats:y});a.onDone(null,u);return u}})},{}],46:[function(b,
d,f){function a(a){throw Error("resl: "+a);}function c(b,c,d){Object.keys(b).forEach(function(b){0>c.indexOf(b)&&a('invalid parameter "'+b+'" in '+d)})}function h(a,b){this.state=0;this.ready=!1;this.progress=0;this.name=a;this.cancel=b}var e=["manifest","onDone","onProgress","onError"],E=["type","src","stream","credentials","parser"],k=["onData","onDone"];d.exports=function(b){function d(c,e){if(c in b){var f=b[c];"function"!==typeof f&&a('invalid callback "'+c+'"');return f}return null}function f(a){function b(){if(!(2>
l.readyState||1===p.state||-1===p.state)){if(200!==l.status)return g('error loading resource "'+a.name+'"');if(2<l.readyState&&0===p.state){var d;d="binary"===a.type?l.response:l.responseText;if(k.data)try{q=k.data(d)}catch(e){return g(e)}else q=d}if(3<l.readyState&&0===p.state){if(k.done)try{q=k.done()}catch(e){return g(e)}p.state=1}z[c]=q;p.progress=.75*p.progress+.25;p.ready=a.stream&&!!q||1===p.state;r()}}var c=a.name,d=a.stream,e="binary"===a.type,k=a.parser,l=new XMLHttpRequest,q=null,p=new h(c,
function(){1!==p.state&&-1!==p.state&&(l.onreadystatechange=null,l.abort(),p.state=-1)});l.onreadystatechange=d?b:function(){4===l.readyState&&b()};e&&(l.responseType="arraybuffer");a.credentials&&(l.withCredentials=!0);l.open("GET",a.src,!0);l.send();return p}function v(a,b){function c(){if(0===p.state)if(q.data)try{u=q.data(b)}catch(a){return g(a)}else u=b}function d(a){c();z[l]=u;p.progress=a.lengthComputable?Math.max(p.progress,a.loaded/a.total):.75*p.progress+.25;r(l)}function e(){c();if(0===
p.state){if(q.done)try{u=q.done()}catch(a){return g(a)}p.state=1}p.progress=1;p.ready=!0;z[l]=u;k();r("finish "+l)}function f(){g('error loading asset "'+l+'"')}function k(){a.stream&&b.removeEventListener("progress",d);"image"===a.type?b.addEventListener("load",e):b.addEventListener("canplay",e);b.removeEventListener("error",f)}var l=a.name,q=a.parser,p=new h(l,function(){1!==p.state&&-1!==p.state&&(p.state=-1,k(),b.src="")}),u=b;a.stream&&b.addEventListener("progress",d);if("image"===a.type)b.addEventListener("load",
e);else{var v=!1,x=!1;b.addEventListener("loadedmetadata",function(){x=!0;v&&e()});b.addEventListener("canplay",function(){v=!0;x&&e()})}b.addEventListener("error",f);b.crossOrigin=a.credentials?"use-credentials":"anonymous";b.src=a.src;return p}function g(a){-1!==B&&1!==B&&(B=-1,D.forEach(function(a){a.cancel()}),A?"string"===typeof a?A(Error("resl: "+a)):A(a):console.error("resl error:",a))}function r(a){if(-1!==B&&1!==B){var b=0,c=0;D.forEach(function(a){a.ready&&(c+=1);b+=a.progress});c===D.length?
(B=1,y(z)):p&&p(b/D.length,a)}}"object"===typeof b&&b||a("invalid or missing configuration");c(b,e,"config");var u=b.manifest;"object"===typeof u&&u||a("missing manifest");var y=d("onDone");y||a("missing onDone() callback");var p=d("onProgress"),A=d("onError"),z={},B=0,F={text:f,binary:function(a){return f(a)},image:function(a){return v(a,document.createElement("img"))},video:function(a){return v(a,document.createElement("video"))},audio:function(a){return v(a,document.createElement("audio"))}},D=
Object.keys(u).map(function(b){function d(b,c){if(b in e.parser){var f=e.parser[b];"function"!==typeof f&&a("invalid parser callback "+b+' for asset "'+b+'"');return f}return c}var e=u[b];"string"===typeof e?e={src:e}:"object"===typeof e&&e||a('invalid asset definition "'+b+'"');c(e,E,'asset "'+b+'"');var f={};"parser"in e&&("function"===typeof e.parser?f={data:e.parser}:"object"===typeof e.parser&&e.parser?(c(f,k,'parser for asset "'+b+'"'),"onData"in f||a('missing onData callback for parser in asset "'+
b+'"'),f={data:d("onData"),done:d("onDone")}):a('invalid parser for asset "'+b+'"'));return{name:b,type:function(c,d,f){c in e&&(f=e[c]);0>d.indexOf(f)&&a("invalid "+c+' "'+f+'" for asset "'+b+'", possible values: '+d);return f}("type",Object.keys(F),"text"),stream:!!e.stream,credentials:!!e.credentials,src:function(c,d,f){c in e?f=e[c]:d&&a("missing "+c+' for asset "'+b+'"');"string"!==typeof f&&a("invalid "+c+' for asset "'+b+'", must be a string');return f}("src",!0,""),parser:f}}).map(function(a){return F[a.type](a)});
0===D.length&&setTimeout(function(){r("done")},1)}},{}],47:[function(b,d,f){function a(a,b){var d=a.length,e=["'use strict';"],f="surfaceNets"+a.join("_")+"d"+b;e.push("var contour=genContour({","order:[",a.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },");"generic"===b&&e.push("getters:[0],");for(var g=[],r=[],u=0;u<d;++u)g.push("d"+u),r.push("d"+u);for(u=0;u<1<<d;++u)g.push("v"+u),r.push("v"+u);for(u=0;u<1<<d;++u)g.push("p"+u),r.push("p"+u);g.push("a",
"b","c");r.push("a","c");e.push("vertex:function vertexFunc(",g.join(),"){");g=[];for(u=0;u<1<<d;++u)g.push("(p"+u+"<<"+u+")");e.push("var m=(",g.join("+"),")|0;if(m===0||m===",(1<<(1<<d))-1,"){return}");var g=[],y=[];128>=1<<(1<<d)?(e.push("switch(m){"),y=e):e.push("switch(m>>>7){");for(u=0;u<1<<(1<<d);++u){128<1<<(1<<d)&&0===u%128&&(0<g.length&&y.push("}}"),y="vExtra"+g.length,e.push("case ",u>>>7,":",y,"(m&0x7f,",r.join(),");break;"),y=["function ",y,"(m,",r.join(),"){switch(m){"],g.push(y));y.push("case ",
u&127,":");for(var p=Array(d),A=Array(d),z=Array(d),B=Array(d),E=0,D=0;D<d;++D)p[D]=[],A[D]=[],z[D]=0,B[D]=0;for(D=0;D<1<<d;++D)for(var w=0;w<d;++w){var C=D^1<<w;if(!(C>D)&&!(u&1<<C)!==!(u&1<<D)){var H=1;u&1<<C?A[w].push("v"+C+"-v"+D):(A[w].push("v"+D+"-v"+C),H=-H);0>H?(p[w].push("-v"+D+"-v"+C),z[w]+=2):(p[w].push("v"+D+"+v"+C),z[w]-=2);E+=1;for(H=0;H<d;++H)H!==w&&(C&1<<H?B[H]+=1:--B[H])}}D=[];for(w=0;w<d;++w)0===p[w].length?D.push("d"+w+"-0.5"):(C="",0>z[w]?C=z[w]+"*c":0<z[w]&&(C="+"+z[w]+"*c"),
D.push("d"+w+"-"+(.5+B[w]/E*.5)+"-"+p[w].length/E*.5+"*("+p[w].join("+")+C+")/("+A[w].join("+")+")"));y.push("a.push([",D.join(),"]);","break;")}e.push("}},");0<g.length&&y.push("}}");r=[];for(u=0;u<1<<d-1;++u)r.push("v"+u);r.push("c0","c1","p0","p1","a","b","c");e.push("cell:function cellFunc(",r.join(),"){");d=h(d-1);e.push("if(p0){b.push(",d.map(function(a){return"["+a.map(function(a){return"v"+a})+"]"}).join(),")}else{b.push(",d.map(function(a){a=a.slice();a.reverse();return"["+a.map(function(a){return"v"+
a})+"]"}).join(),")}}});function ",f,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",f,";");for(u=0;u<g.length;++u)e.push(g[u].join(""));return(new Function("genContour",e.join("")))(c)}d.exports=function(b,c){if(0>=b.dimension)return{positions:[],cells:[]};if(1===b.dimension){for(var d=e(b,c),f=d.length,h=Array(f),g=Array(f),r=0;r<f;++r)h[r]=[d[r]],g[r]=[r];return{positions:h,cells:g}}d=b.order.join()+"-"+b.dtype;f=E[d];c=+c||
0;f||(f=E[d]=a(b.order,b.dtype));return f(b,c)};var c=b("ndarray-extract-contour"),h=b("triangulate-hypercube"),e=b("zero-crossings"),E={}},{"ndarray-extract-contour":40,"triangulate-hypercube":49,"zero-crossings":53}],48:[function(b,d,f){function a(a,b){var d=h(getComputedStyle(a).getPropertyValue(b));return d[0]*c(d[1],a)}function c(b,c){c=c||document.body;b=(b||"px").trim().toLowerCase();if(c===window||c===document)c=document.body;switch(b){case "%":return c.clientHeight/100;case "ch":case "ex":var d=
b,f=c,h=document.createElement("div");h.style["font-size"]="128"+d;f.appendChild(h);d=a(h,"font-size")/128;f.removeChild(h);return d;case "em":return a(c,"font-size");case "rem":return a(document.body,"font-size");case "vw":return window.innerWidth/100;case "vh":return window.innerHeight/100;case "vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case "vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case "in":return e;case "cm":return e/2.54;case "mm":return e/25.4;case "pt":return e/
72;case "pc":return e/6}return 1}var h=b("parse-unit");d.exports=c;var e=96},{"parse-unit":42}],49:[function(b,d,f){d.exports=function(b){if(0>b)return[];if(0===b)return[[0]];for(var d=Math.round(h(b+1))|0,f=[],l=0;l<d;++l){for(var q=a.unrank(b,l),x=[0],v=0,g=0;g<q.length;++g)v+=1<<q[g],x.push(v);1>c(q)&&(x[0]=v,x[b]=0);f.push(x)}return f};var a=b("permutation-rank"),c=b("permutation-parity"),h=b("gamma")},{gamma:9,"permutation-parity":43,"permutation-rank":44}],50:[function(b,d,f){(function(a,c){function d(a){if(a){var b=
A.log2(a.length||a.byteLength);D[b].push(a)}}function e(a){a=A.nextPow2(a);var b=A.log2(a),b=D[b];return 0<b.length?b.pop():new ArrayBuffer(a)}function E(a){return new Uint8Array(e(a),0,a)}function k(a){return new Uint16Array(e(2*a),0,a)}function l(a){return new Uint32Array(e(4*a),0,a)}function q(a){return new Int8Array(e(a),0,a)}function x(a){return new Int16Array(e(2*a),0,a)}function v(a){return new Int32Array(e(4*a),0,a)}function g(a){return new Float32Array(e(4*a),0,a)}function r(a){return new Float64Array(e(8*
a),0,a)}function u(a){return B?new Uint8ClampedArray(e(a),0,a):E(a)}function y(a){return new DataView(e(a),0,a)}function p(a){a=A.nextPow2(a);var b=A.log2(a),b=w[b];return 0<b.length?b.pop():new c(a)}var A=b("bit-twiddle"),z=b("dup");a.__TYPEDARRAY_POOL||(a.__TYPEDARRAY_POOL={UINT8:z([32,0]),UINT16:z([32,0]),UINT32:z([32,0]),INT8:z([32,0]),INT16:z([32,0]),INT32:z([32,0]),FLOAT:z([32,0]),DOUBLE:z([32,0]),DATA:z([32,0]),UINT8C:z([32,0]),BUFFER:z([32,0])});var B="undefined"!==typeof Uint8ClampedArray,
F=a.__TYPEDARRAY_POOL;F.UINT8C||(F.UINT8C=z([32,0]));F.BUFFER||(F.BUFFER=z([32,0]));var D=F.DATA,w=F.BUFFER;f.free=function(a){if(c.isBuffer(a))w[A.log2(a.length)].push(a);else if("[object ArrayBuffer]"!==Object.prototype.toString.call(a)&&(a=a.buffer),a){var b=A.log2(a.length||a.byteLength)|0;D[b].push(a)}};f.freeUint8=f.freeUint16=f.freeUint32=f.freeInt8=f.freeInt16=f.freeInt32=f.freeFloat32=f.freeFloat=f.freeFloat64=f.freeDouble=f.freeUint8Clamped=f.freeDataView=function(a){d(a.buffer)};f.freeArrayBuffer=
d;f.freeBuffer=function(a){w[A.log2(a.length)].push(a)};f.malloc=function(a,b){if(void 0===b||"arraybuffer"===b)return e(a);switch(b){case "uint8":return E(a);case "uint16":return k(a);case "uint32":return l(a);case "int8":return q(a);case "int16":return x(a);case "int32":return v(a);case "float":case "float32":return g(a);case "double":case "float64":return r(a);case "uint8_clamped":return u(a);case "buffer":return p(a);case "data":case "dataview":return y(a);default:return null}};f.mallocArrayBuffer=
e;f.mallocUint8=E;f.mallocUint16=k;f.mallocUint32=l;f.mallocInt8=q;f.mallocInt16=x;f.mallocInt32=v;f.mallocFloat32=f.mallocFloat=g;f.mallocFloat64=f.mallocDouble=r;f.mallocUint8Clamped=u;f.mallocDataView=y;f.mallocBuffer=p;f.clearCache=function(){for(var a=0;32>a;++a)F.UINT8[a].length=0,F.UINT16[a].length=0,F.UINT32[a].length=0,F.INT8[a].length=0,F.INT16[a].length=0,F.INT32[a].length=0,F.FLOAT[a].length=0,F.DOUBLE[a].length=0,F.UINT8C[a].length=0,D[a].length=0,w[a].length=0}}).call(this,"undefined"!==
typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{},b("buffer").Buffer)},{"bit-twiddle":3,buffer:4,dup:8}],51:[function(b,d,f){d.exports=function(a,b,d){if(0===a.length)return a;if(b){d||a.sort(b);d=1;for(var e=a.length,f=a[0],k=a[0],l=1;l<e;++l)k=f,f=a[l],b(f,k)&&(l===d?d++:a[d++]=f);a.length=d;return a}d||a.sort();b=1;d=a.length;e=a[0];f=a[0];for(k=1;k<d;++k)f=e,e=a[k],e!==f&&(k===b?b++:a[b++]=e);a.length=b;return a}},{}],52:[function(b,d,f){d.exports=b("cwise-compiler")({args:["array",
{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\n        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_\n        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_\n        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {\n          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))\n        }\n      }",args:[{name:"_inline_1_arg0_",
lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg3_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":5}],53:[function(b,d,f){d.exports=function(b,d){var e=[];d=+d||0;a(b.hi(b.shape[0]-1),e,d);return e};var a=b("./lib/zc-core")},{"./lib/zc-core":52}],54:[function(b,
d,f){var a=b("regl")(),c=b("surface-nets"),h=b("ndarray"),e=b("angle-normals"),E=b("gl-mat3"),k=b("./util/camera")(a,{distance:1.5,maxDistance:3,minDistance:.5,center:[1,1,1],theta:1}),l=a.buffer({length:49152,type:"float",usage:"dynamic"}),q=a.buffer({length:49152,type:"float",usage:"dynamic"}),x=a.elements({length:221184,count:36864,type:"uint16",usage:"dynamic",primitive:"triangles"}),v=a({vert:"\n    precision mediump float;\n    attribute vec2 position;\n    void main() {\n      gl_Position = vec4(position, 0., 1.);\n    }",
frag:"\n    precision mediump float;\n    uniform vec3 color;\n    uniform float noise, width, height;\n\n    #define VIG_REDUCTION_POWER 1.\n    #define VIG_BOOST 1.\n\n    float random(vec3 scale,float seed) {\n      return fract(sin(dot(gl_FragCoord.xyz+seed,scale))*43758.5453+seed);\n    }\n\n    void main () {\n      vec2 resolution = vec2(width, height);\n      vec2 center = resolution * 0.5;\n      float vignette = distance( center, gl_FragCoord.xy ) / resolution.x;\n      vignette = VIG_BOOST - vignette * VIG_REDUCTION_POWER;\n\n      float n = noise * (.5 - random(vec3(1.), length(gl_FragCoord)));\n\n      float v = .5 * length(vec2(gl_FragCoord.y / resolution.y, (1. - abs(.5 - gl_FragCoord.x / resolution.x))));\n      vec3 base = color;\n      base += vec3(pow(v, 2.));\n\n      gl_FragColor = vec4(base * vec3(vignette) + vec3(n), 1.);\n    }",
uniforms:{color:[36/255,70/255,106/255],width:a.context("viewportWidth"),height:a.context("viewportHeight"),noise:.05},attributes:{position:[-4,-4,4,-4,0,4]},count:3}),g=a({vert:"\n    precision mediump float;\n    uniform mat4 projection, view;\n    uniform mat3 normalMatrix;\n\n    attribute vec3 position, normal;\n\n    varying vec3 vNormal, vONormal, vU;\n    varying vec4 vPosition, vOPosition;\n\n    void main () {\n      vNormal = normalMatrix * normal;\n      vONormal = normal;\n      vPosition = vec4(position, 1.0);\n      vOPosition = view * vPosition;\n      vU = normalize(vec3(vOPosition));\n      gl_Position = projection * vOPosition;\n    }",
frag:"\n    precision mediump float;\n    uniform sampler2D textureMap, normalMap;\n    uniform float normalScale, texScale;\n    uniform vec3 color, eye;\n\n    varying vec3 vNormal, vONormal, vU;\n    varying vec4 vPosition, vOPosition;\n\n    float random(vec3 scale, float seed) {\n      return fract(sin(dot(gl_FragCoord.xyz + seed,scale)) * 43758.5453 + seed);\n    }\n\n    vec3 spherical_environment_map(vec3 ray, vec3 normal) {\n      vec3 r = reflect(normalize(ray), normalize(normal));\n      float m = 2.0 * sqrt(r.x * r.x + r.y * r.y + (r.z + 1.0) * (r.z + 1.0));\n      vec2 calculatedNormal = vec2(r.x / m + 0.5, r.y / m + 0.5);\n      return texture2D(textureMap, calculatedNormal).rgb;\n    }\n\n    mat3 tangent_space_basis(vec3 blend_weights) {\n      vec3 tanX = vec3(vNormal.x, -vNormal.z, vNormal.y);\n      vec3 tanY = vec3(vNormal.z, vNormal.y, -vNormal.x);\n      vec3 tanZ = vec3(-vNormal.y, vNormal.x, vNormal.z);\n      vec3 blended_tangent = tanX * blend_weights.xxx +\n                             tanY * blend_weights.yyy +\n                             tanZ * blend_weights.zzz;\n\n      return mat3(\n        normalize(blended_tangent),\n        normalize(cross(vNormal, blended_tangent)),\n        normalize(vNormal)\n      );\n    }\n\n    vec3 blended_bump(vec3 blend_weights) {\n      vec2 coord1 = vPosition.yz * texScale;\n      vec2 coord2 = vPosition.zx * texScale;\n      vec2 coord3 = vPosition.xy * texScale;\n\n      vec3 bump1 = texture2D(normalMap, coord1).rgb;\n      vec3 bump2 = texture2D(normalMap, coord2).rgb;\n      vec3 bump3 = texture2D(normalMap, coord3).rgb;\n\n      return bump1 * blend_weights.xxx +\n             bump2 * blend_weights.yyy +\n             bump3 * blend_weights.zzz;\n    }\n\n    void main() {\n      // Using triplanar texturing, as in http://http.developer.nvidia.com/GPUGems3/gpugems3_ch01.html\n      vec3 blend_weights = abs(normalize(vONormal.xyz));\n      blend_weights = (blend_weights - 0.2) * 7.;\n      blend_weights = max(blend_weights, 0.);\n      blend_weights /= (blend_weights.x + blend_weights.y + blend_weights.z);\n\n      mat3 tsb = tangent_space_basis(blend_weights);\n      vec3 bump = blended_bump(blend_weights);\n\n      vec3 normalTex = bump * 2.0 - 1.0;\n      normalTex.xy *= normalScale;\n      normalTex.y *= -1.;\n      normalTex = normalize(normalTex);\n      vec3 finalNormal = tsb * normalTex;\n      vec3 base = spherical_environment_map(vU, finalNormal);\n\n      float rim = 1.75 * max(0., abs(dot(normalize(vNormal), normalize(-vOPosition.xyz))));\n      base += 10. * base * color * clamp(1. - rim, 0., .15);\n\n      base = vec3(1.) - (vec3(1.) - base) * (vec3(1.) - base);\n\n      float dither = .05 * random(vec3(1.), length(gl_FragCoord));\n      base += vec3(dither);\n\n      gl_FragColor = vec4(base.rgb, 1.);\n    }",
attributes:{position:{buffer:l},normal:{buffer:q}},uniforms:{color:[36/255,70/255,106/255],sphereColor:[36/255,70/255,106/255],normalScale:1,texScale:10,normalMatrix:function(a){var b=E.create();E.normalFromMat4(b,a.view);return b},textureMap:a.prop("textureMap"),normalMap:a.prop("normalMap")},elements:x}),r=1.2/((Math.sqrt(20)-1)/4+1),u=[.5,.5,.5],y=[1.5,1.5,1.5],p=[0,1,2].map(function(a){return(y[a]-u[a])/50}),A=50*Math.sqrt(r/12),z=function(a){a*=.5;for(var b=new Float32Array(125E3),d=0;20>d;d++)for(var e=
[.27*Math.sin(m+1.26*a*(1.03+.5*Math.cos(.21*m)))+.5,.27*Math.cos(m+1.12*a*.21*Math.sin(.72+.83*m))+.5,.27*Math.cos(m+.132*a*Math.sin(.92+.53*m))+.5],f=e[0],g=e[1],e=e[2],k=[f,g,e].map(function(a){a*=50;return[Math.max(Math.floor(a-A),1),Math.min(Math.floor(a+A),49)]}),l=k[0],q=k[1],k=k[2],v=k[0];v<k[1];v++)for(var x=2500*v,y=q[0];y<q[1];y++)for(var z=50*y,E=l[0];E<l[1];E++){var O=E/50-f,ja=y/50-g,ca=v/50-e,O=r/(1E-6+O*O+ja*ja+ca*ca)-12;0<O&&(b[x+z+E]+=O)}a=c(h(b,[50,50,50]),80);b=Array(a.positions.length);
for(d=0;d<a.positions.length;d++){f=a.positions[d];g=Array(3);for(e=0;3>e;e++)g[e]=u[e]+f[e]*p[e];b[d]=g}return{positions:b,cells:a.cells}};b("resl")({manifest:{sphereTexture:{type:"image",src:"assets/spheretexture.jpg",parser:function(b){return a.texture({data:b,mag:"linear",min:"linear"})}},normalTexture:{type:"image",src:"assets/normaltexture.jpg",parser:function(b){return a.texture({data:b,wrapT:"repeat",wrapS:"repeat",min:"linear mipmap linear",mag:"linear"})}}},onDone:function(b){var c=b.sphereTexture,
d=b.normalTexture;a.frame(function(b){b=z(b.time);l({data:b.positions});x({data:b.cells});q({data:e(b.cells,b.positions)});k(function(){v({depth:{enable:!1,mask:!1}});a.clear({depth:1});g({textureMap:c,normalMap:d})})})}})},{"./util/camera":55,"angle-normals":1,"gl-mat3":20,ndarray:41,regl:45,resl:46,"surface-nets":47}],55:[function(b,d,f){var a=b("mouse-change"),c=b("mouse-wheel"),h=b("gl-mat4/identity"),e=b("gl-mat4/perspective"),E=b("gl-mat4/lookAt");d.exports=function(b,d){function f(a){a*=.9;
return.1>a?0:a}function x(a){var b=v.center,c=v.eye,d=v.up;v.theta+=p;v.phi=Math.min(Math.max(v.phi+A,-Math.PI/2),Math.PI/2);v.distance=Math.min(Math.max(v.distance+z,u),y);p=f(p);A=f(A);z=f(z);for(var e=v.theta,h=v.phi,k=Math.exp(v.distance),l=k*Math.sin(e)*Math.cos(h),e=k*Math.cos(e)*Math.cos(h),h=k*Math.sin(h),k=0;3>k;++k)c[k]=b[k]+l*r[k]+e*g[k]+h*d[k];E(v.view,c,b,d);D(a)}var v={view:h(new Float32Array(16)),projection:h(new Float32Array(16)),center:new Float32Array(d.center||3),theta:d.theta||
0,phi:d.phi||0,distance:Math.log(d.distance||10),eye:new Float32Array(3),up:new Float32Array(d.up||[0,1,0])},g=new Float32Array([1,0,0]),r=new Float32Array([0,0,1]),u=Math.log("minDistance"in d?d.minDistance:.1),y=Math.log("maxDistance"in d?d.maxDistance:1E3),p=0,A=0,z=0,B=0,F=0;a(function(a,b,c){if(a&1){a=(c-F)/window.innerHeight;var d=Math.max(v.distance,.5);p+=(b-B)/window.innerWidth*d;A+=d*a}B=b;F=c});c(function(a,b){z+=b/window.innerHeight});var D=b({context:Object.assign({},v,{projection:function(a){return e(v.projection,
Math.PI/4,a.viewportWidth/a.viewportHeight,.01,1E3)}}),uniforms:Object.keys(v).reduce(function(a,c){a[c]=b.context(c);return a},{})});Object.keys(v).forEach(function(a){x[a]=v[a]});return x}},{"gl-mat4/identity":29,"gl-mat4/lookAt":30,"gl-mat4/perspective":31,"mouse-change":37,"mouse-wheel":39}]},{},[54]);
